"use strict";

function _react() {
  const data = _interopRequireDefault(require("react"));

  _react = function _react() {
    return data;
  };

  return data;
}

function _path() {
  const data = require("path");

  _path = function _path() {
    return data;
  };

  return data;
}

function _yargsParser() {
  const data = _interopRequireDefault(require("yargs-parser"));

  _yargsParser = function _yargsParser() {
    return data;
  };

  return data;
}

function _signale() {
  const data = _interopRequireDefault(require("signale"));

  _signale = function _signale() {
    return data;
  };

  return data;
}

function _semver() {
  const data = _interopRequireDefault(require("semver"));

  _semver = function _semver() {
    return data;
  };

  return data;
}

var _buildDevOpts = _interopRequireDefault(require("./buildDevOpts"));

function _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }

const script = process.argv[2];
const args = (0, _yargsParser().default)(process.argv.slice(3)); // Node version check

const nodeVersion = process.versions.node;

if (_semver().default.satisfies(nodeVersion, '<6.5')) {
  _signale().default.error(`Node version must >= 6.5, but got ${nodeVersion}`);

  process.exit(1);
} // Notify update when process exits


const updater = require('update-notifier');

const pkg = require('../package.json');

updater({
  pkg
}).notify({
  defer: true
});
process.env.UMI_DIR = (0, _path().dirname)(require.resolve('../package'));
process.env.UMI_VERSION = pkg.version;
const aliasMap = {
  '-v': 'version',
  '--version': 'version',
  '-h': 'help',
  '--help': 'help'
};

switch (script) {
  case 'build':
  case 'dev':
  case 'test':
  case 'inspect':
  case 'ui':
    // eslint-disable-next-line import/no-dynamic-require
    require(`./scripts/${script}`);

    break;

  default:
    {
      const Service = require('umi-build-dev/lib/Service').default;

      new Service((0, _buildDevOpts.default)(args)).run(aliasMap[script] || script, args);
      break;
    }
}