"use strict";

function _react() {
  const data = _interopRequireDefault(require("react"));

  _react = function _react() {
    return data;
  };

  return data;
}

function _yargsParser() {
  const data = _interopRequireDefault(require("yargs-parser"));

  _yargsParser = function _yargsParser() {
    return data;
  };

  return data;
}

var _buildDevOpts = _interopRequireDefault(require("../buildDevOpts"));

function _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }

// Service 的引入不能用 import，因为有些要依赖 development 这个 NODE_ENV
const Service = require('umi-build-dev/lib/Service').default;

let closed = false; // kill(2) Ctrl-C

process.once('SIGINT', () => onSignal('SIGINT')); // kill(3) Ctrl-\

process.once('SIGQUIT', () => onSignal('SIGQUIT')); // kill(15) default

process.once('SIGTERM', () => onSignal('SIGTERM'));

function onSignal() {
  if (closed) return;
  closed = true; // 退出时触发插件中的onExit事件

  serviceInstance.applyPlugins('onExit');
  process.exit(0);
}

const args = (0, _yargsParser().default)(process.argv.slice(2));
const opts = (0, _buildDevOpts.default)(args);
process.env.NODE_ENV = 'development';
const serviceInstance = new Service(opts);
serviceInstance.run('dev', args);