{"code":"(window[\"webpackJsonp\"]=window[\"webpackJsonp\"]||[]).push([[3],{\"9+CI\":function(e,t,a){\"use strict\";a.r(t);a(\"y8nQ\");var r,n,s,i=a(\"Vl3Y\"),l=(a(\"IzEo\"),a(\"bx4M\")),o=(a(\"g9YV\"),a(\"wCAj\")),m=(a(\"14J3\"),a(\"BMrR\")),c=(a(\"+L6B\"),a(\"2/Rp\")),h=(a(\"pC0b\"),a(\"GzdX\")),p=(a(\"jCWc\"),a(\"kPKH\")),u=(a(\"miYZ\"),a(\"tsqr\")),d=(a(\"2qtc\"),a(\"kLXV\")),y=(a(\"OaEy\"),a(\"2fM7\")),g=(a(\"fu2T\"),a(\"gK9i\")),v=a(\"q1tI\"),S=a.n(v),w=a(\"SohS\"),f=a.n(w),E=a(\"MT78\"),b=a.n(E),C=a(\"MuoO\"),x=(a(\"W8A/\"),a(\"Xu5n\")),z=a(\"oscj\"),k=a(\"LvFn\"),L=a(\"yBBP\"),O=a(\"SAzV\"),U=a(\"sJCy\"),A=a(\"JW8z\"),M=a(\"wyD7\"),V=(g[\"a\"].Panel,y[\"a\"].Option),D=(y[\"a\"].OptGroup,[\"20\",\"40\",\"60\",\"80\",\"100\"]),G=(r=Object(C[\"connect\"])(e=>{var t=e.FUWU;return{FUWU:t}}),r((s=class extends v[\"Component\"]{constructor(e){super(e),this.initTable=(()=>{var e=this.props.location.query.name,t=this.props.dispatch;return this.setState({serviceName:e}),new Promise((a,r)=>{t({type:\"FUWU/getLayer\",payload:{name:e}}).then(e=>{var t=e.success,r=e.data,n=[],s=[],i=[],l=[],o=[],m=[],c=\"\";t&&(r.map((e,t)=>{c=e.n.url,m.push({key:t,name:e.m.name,description:e.m.description}),i.indexOf(\"n:\"+e.n.name)<0&&(n.push({name:\"n:\"+e.n.name,des:\"sss\",symbolSize:100,itemStyle:{normal:{color:\"#B23AEE\"}}}),i.push(\"n:\"+e.n.name)),l.indexOf(\"m:\"+e.m.name)<0&&(n.push({name:\"m:\"+e.m.name,des:\"sss\",symbolSize:80,itemStyle:{normal:{color:\"gray\"}}}),l.push(\"m:\"+e.m.name)),o.indexOf(\"n:\"+e.n.name+\"->m:\"+e.m.name)<0&&(s.push({source:\"n:\"+e.n.name,target:\"m:\"+e.m.name,name:\"HAS\",des:\"\\u670d\\u52a1->\\u56fe\\u5c42\"}),o.push(\"n:\"+e.n.name+\"->m:\"+e.m.name))}),this.setState({url:c,tableData:m,dataArr:n,linkArr:s}),a())})})}),this.createGraph=(e=>{var t=this.getOption();e.setOption(t)}),this.getOption=(()=>{var e=this.state,t=e.dataArr,a=e.linkArr;return{title:{text:\"\\u67e5\\u8be2\\u7ed3\\u679c\"},tooltip:{formatter:function(e){return e.data.des}},series:[{type:\"graph\",layout:\"force\",symbolSize:80,roam:!0,edgeSymbol:[\"circle\",\"arrow\"],edgeSymbolSize:[4,10],edgeLabel:{normal:{textStyle:{fontSize:20}}},force:{repulsion:2500,edgeLength:[10,50]},draggable:!0,itemStyle:{normal:{color:\"#4b565b\"}},lineStyle:{normal:{width:2,color:\"#4b565b\"}},edgeLabel:{normal:{show:!0,formatter:function(e){return e.data.name}}},label:{normal:{show:!0,textStyle:{}}},data:t,links:a}]}}),this.initMap=(e=>{console.log(e),e=\"http://118.31.43.251:6080/arcgis/rest/services/land20002/MapServer\";var t=this.state,a=(t.wuhanGeojson,t.arcgisLayer,t.imagesLayer,t.digitalLayer);return a.set(\"id\",\"arcgisLayer\"),a.setVisible(!0),new Promise(t=>{var r=new M[\"a\"],n=new L[\"a\"]({source:new U[\"a\"]({ratio:1,params:{},url:e,projection:\"EPSG:3857\"})}),s=new x[\"a\"]({view:new z[\"a\"]({center:Object(A[\"d\"])([114,30.5]),zoom:16}),layers:[a,n],target:\"map\"});s.addControl(r),this.setState({map:s}),t()})}),this.handleChange=(e=>{this.setState({rateValue:e})}),this.handleUserChange=(e=>{this.setState({currentUser:e})}),this.rateService=(()=>{var e=this.state,t=e.currentUser,a=e.rateValue,r=e.serviceName,n=this.props.dispatch;d[\"a\"].confirm({content:\"\\u5f53\\u524d\\u7528\\u6237\\u662f\\uff1a\"+t+\",\\u7ed9\\u51fa\\u8bc4\\u5206\\u662f\\uff1a\"+20*a+\"\\u5206\\u3002\\u8bf7\\u786e\\u8ba4\\uff01\",onOk:()=>{n({type:\"FUWU/goLike\",payload:{u_name:t,s_name:r,r_value:20*a}}).then(e=>{var t=e.success;e.data;t?u[\"a\"].info(\"\\u8bc4\\u5206\\u6210\\u529f\\uff01\"):u[\"a\"].info(\"\\u8bc4\\u5206\\u5931\\u8d25\\uff01\")})}})}),this.state={tableData:[],dataArr:[],linkArr:[],url:\"\",myChart:null,map:null,rateValue:3,serviceName:\"\",currentUser:\"\\u5f20\\u4e09\",digitalLayer:new O[\"a\"]({source:new k[\"a\"]({url:\"https://wprd0{1-4}.is.autonavi.com/appmaptile?lang=zh_cn&size=1&style=7&x={x}&y={y}&z={z}\"})}),arcgisLayer:new O[\"a\"]({source:new k[\"a\"]({url:\"http://cache1.arcgisonline.cn/arcgis/rest/services/ChinaOnlineStreetPurplishBlue/MapServer/tile/{z}/{y}/{x}\"})})}}componentWillUnmount(){}componentDidMount(){this.initTable().then(()=>{return this.initMap(this.state.url)}).then(()=>{var e=b.a.init(this.chartsDiv);e&&this.createGraph(e),this.setState({myChart:e})})}render(){var e=this.state,t=(e.myChart,e.rateValue),a=(this.props.form.getFieldDecorator,[{title:\"\\u56fe\\u5c42\",dataIndex:\"name\",key:\"name\"},{title:\"\\u8bf4\\u660e\",dataIndex:\"description\",key:\"description\"}]);return S.a.createElement(\"div\",{className:f.a.root},S.a.createElement(l[\"a\"],null,S.a.createElement(m[\"a\"],null,S.a.createElement(p[\"a\"],{span:4,offset:12,style:{cursor:\"point\"}},\"\\u5207\\u6362\\u7528\\u6237\\uff1a\",S.a.createElement(y[\"a\"],{defaultValue:\"\\u5f20\\u4e09\",style:{width:120},onChange:this.handleUserChange},S.a.createElement(V,{value:\"\\u5f20\\u4e09\"},\"\\u5f20\\u4e09\"),S.a.createElement(V,{value:\"\\u674e\\u56db\"},\"\\u674e\\u56db\"),S.a.createElement(V,{value:\"\\u738b\\u4e94\"},\"\\u738b\\u4e94\"),S.a.createElement(V,{value:\"\\u8d75\\u516d\"},\"\\u8d75\\u516d\"),S.a.createElement(V,{value:\"\\u6bdb\\u4e03\"},\"\\u6bdb\\u4e03\"))),S.a.createElement(p[\"a\"],{span:4,offset:0},S.a.createElement(h[\"a\"],{tooltips:D,onChange:this.handleChange,value:t}),t?S.a.createElement(\"span\",{className:\"ant-rate-text\"},D[t-1],\"\\u5206\"):\"\"),S.a.createElement(p[\"a\"],{span:4,offset:0,style:{cursor:\"point\"}},S.a.createElement(c[\"a\"],{type:\"primary\",onClick:this.rateService},\"\\u7ed9\\u5f53\\u524d\\u670d\\u52a1\\u8bc4\\u5206\"))),S.a.createElement(o[\"a\"],{columns:a,dataSource:this.state.tableData})),S.a.createElement(l[\"a\"],{style:{marginTop:10}},S.a.createElement(\"div\",{id:\"map\",style:{width:\"100%\",height:500},ref:e=>{this.mapDiv=e}},\" \")),S.a.createElement(l[\"a\"],{style:{marginTop:10}},S.a.createElement(\"div\",{style:{width:\"100%\"}},S.a.createElement(\"div\",{id:\"main\",style:{width:\"100%\",height:\"500px\"},ref:e=>{this.chartsDiv=e}}))))}},n=s))||n);t[\"default\"]=G=i[\"a\"].create({name:\"register\"})(G)},SohS:function(e,t,a){e.exports={root:\"root___1GGQC\"}}}]);","extractedComments":[]}