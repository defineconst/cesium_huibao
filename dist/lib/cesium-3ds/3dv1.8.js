!function(t,e){"object"==typeof exports&&"object"==typeof module?module.exports=e(require("Cesium"),require("jQuery"),require("mapv")):"function"==typeof define&&define.amd?define(["Cesium","jQuery","mapv"],e):"object"==typeof exports?exports.mars3d=e(require("Cesium"),require("jQuery"),require("mapv")):t.mars3d=e(t.Cesium,t.jQuery,t.mapv)}("undefined"!=typeof self?self:this,function(__WEBPACK_EXTERNAL_MODULE_0__,__WEBPACK_EXTERNAL_MODULE_5__,__WEBPACK_EXTERNAL_MODULE_87__){return function(t){function e(n){if(i[n])return i[n].exports;var r=i[n]={i:n,l:!1,exports:{}};return t[n].call(r.exports,r,r.exports,e),r.l=!0,r.exports}var i={};return e.m=t,e.c=i,e.d=function(t,i,n){e.o(t,i)||Object.defineProperty(t,i,{configurable:!1,enumerable:!0,get:n})},e.n=function(t){var i=t&&t.__esModule?function(){return t.default}:function(){return t};return e.d(i,"a",i),i},e.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},e.p="",e(e.s=37)}([function(t,e){t.exports=__WEBPACK_EXTERNAL_MODULE_0__},function(t,e,i){"use strict";function n(t,e){return Number(t.toFixed(e||0))}function r(t){var e=y.default.Cartographic.fromCartesian(t),i={};return i.y=n(y.default.Math.toDegrees(e.latitude),6),i.x=n(y.default.Math.toDegrees(e.longitude),6),i.z=n(e.height,2),i}function a(t,e){null==e&&(e=0);var i=e;if(null==t||0==t.length)return i;for(var r=0;r<t.length;r++){var a=y.default.Cartographic.fromCartesian(t[r]);a.height>i&&(i=a.height)}return n(i,2)}function o(t,e){if(e=Number(e)||0,t instanceof Array){for(var i=[],n=0,r=t.length;n<r;n++){var a=y.default.Cartographic.fromCartesian(t[n]),o=y.default.Cartesian3.fromRadians(a.longitude,a.latitude,a.height+e);i.push(o)}return i}var a=y.default.Cartographic.fromCartesian(t);return y.default.Cartesian3.fromRadians(a.longitude,a.latitude,a.height+e)}function s(t,e){if(e=Number(e)||0,t instanceof Array){for(var i=[],n=0,r=t.length;n<r;n++){var a=y.default.Cartographic.fromCartesian(t[n]),o=y.default.Cartesian3.fromRadians(a.longitude,a.latitude,e);i.push(o)}return i}var a=y.default.Cartographic.fromCartesian(t);return y.default.Cartesian3.fromRadians(a.longitude,a.latitude,e)}function l(t,e){var i=y.default.Cartographic.fromCartesian(t),n=viewer.scene.globe.getHeight(i)||0,r=viewer.scene.sampleHeight(i)||0,a=r>n?r:n;if(null!=a&&a>0){return y.default.Cartesian3.fromRadians(i.longitude,i.latitude,a)}return t}function u(t,e){if(y.default.defined(t.id)){var i=t.id;if(i._noMousePosition)return!1;if(e&&i==e)return!1}if(y.default.defined(t.primitive)){var n=t.primitive;if(n._noMousePosition)return!1;if(e&&n==e)return!1}return!0}function c(t,e,i){var n,r=t.pick(e);if(t.pickPositionSupported&&y.default.defined(r)&&u(r,i)){var n=t.pickPosition(e);if(y.default.defined(n)){var a=y.default.Cartographic.fromCartesian(n),o=a.height;if(o>=0)return n;if(!y.default.defined(r.id)&&o>=-500)return n}}if(t.mode===y.default.SceneMode.SCENE3D){var s=t.camera.getPickRay(e);n=t.globe.pick(s,t)}else n=t.camera.pickEllipsoid(e,t.globe.ellipsoid);return n}function d(t,e){var i=t.scene,n=h(i),a=n;if(!a){var o=i.globe,s=i.camera.positionCartographic.clone(),l=o.getHeight(s);s.height=l||0,a=y.default.Ellipsoid.WGS84.cartographicToCartesian(s)}var u=r(a);e&&(u=t.mars.point2wgs(u));var c=y.default.Cartesian3.distance(a,t.scene.camera.positionWC);return u.cameraZ=c,u}function h(t){var e=t.canvas,i=new y.default.Cartesian2(e.clientWidth/2,e.clientHeight/2),n=t.camera.getPickRay(i);return t.globe.pick(n,t)||t.camera.pickEllipsoid(i)}function f(t,e){var i={xmin:70,xmax:140,ymin:0,ymax:55},n=t.scene,r=n.globe.ellipsoid,a=n.canvas,o=t.camera.pickEllipsoid(new y.default.Cartesian2(0,0),r);if(o){var s=r.cartesianToCartographic(o);i.xmin=y.default.Math.toDegrees(s.longitude),i.ymax=y.default.Math.toDegrees(s.latitude)}else{for(var l,u=a.width/2,c=a.height/2,d=0;d<=c;d+=10){var h=d<=u?d:u;if(l=t.camera.pickEllipsoid(new y.default.Cartesian2(h,d),r))break}if(l){var s=r.cartesianToCartographic(l);i.xmin=y.default.Math.toDegrees(s.longitude),i.ymax=y.default.Math.toDegrees(s.latitude)}}var f=t.camera.pickEllipsoid(new y.default.Cartesian2(a.width,a.height),r);if(f){var p=r.cartesianToCartographic(f);i.xmax=y.default.Math.toDegrees(p.longitude),i.ymin=y.default.Math.toDegrees(p.latitude)}else{for(var g,u=a.width/2,c=a.height/2,d=a.height;d>=c;d-=10){var h=d>=u?d:u;if(g=t.camera.pickEllipsoid(new y.default.Cartesian2(h,d),r))break}if(g){var p=r.cartesianToCartographic(g);i.xmax=y.default.Math.toDegrees(p.longitude),i.ymin=y.default.Math.toDegrees(p.latitude)}}if(e){var m=t.mars.point2wgs({x:i.xmin,y:i.ymin});i.xmin=m.x,i.ymin=m.y;var v=t.mars.point2wgs({x:i.xmax,y:i.ymax});i.xmax=v.x,i.ymax=v.y}if(i.xmax<i.xmin){var _=i.xmax;i.xmax=i.xmin,i.xmin=_}if(i.ymax<i.ymin){var _=i.ymax;i.ymax=i.ymin,i.ymin=_}return i}function p(t,e){var i=t.camera,r=i.positionCartographic,a={};return a.y=n(y.default.Math.toDegrees(r.latitude),6),a.x=n(y.default.Math.toDegrees(r.longitude),6),a.z=n(r.height,2),a.heading=n(y.default.Math.toDegrees(i.heading||-90),1),a.pitch=n(y.default.Math.toDegrees(i.pitch||0),1),a.roll=n(y.default.Math.toDegrees(i.roll||0),1),e&&(a=t.mars.point2wgs(a)),a}function g(t){var e=_.cartesians2lonlats(t);e.push(e[0]);var i=turf.centerOfMass(turf.polygon([e]));return y.default.Cartographic.fromDegrees(i.geometry.coordinates[0],i.geometry.coordinates[1])}Object.defineProperty(e,"__esModule",{value:!0}),e.aroundPoint=e.windingPoint=void 0,e.formatNum=n,e.formatPositon=r,e.getMaxHeight=a,e.addPositionsHeight=o,e.setPositionsHeight=s,e.updateHeightForClampToGround=l,e.getCurrentMousePosition=c,e.getCenter=d,e.getExtent=f,e.getCameraView=p,e.centerOfMass=g;var m=i(0),y=function(t){return t&&t.__esModule?t:{default:t}}(m),v=i(2),_=function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e.default=t,e}(v);e.windingPoint={isStart:!1,viewer:null,start:function(t,e){e||(e=d(t)),this.viewer=t,this.position=y.default.Cartesian3.fromDegrees(e.x,e.y,e.z),this.distance=e.distance||y.default.Cartesian3.distance(this.position,t.camera.positionWC),this.angle=360/(e.time||60),this.time=t.clock.currentTime.clone(),this.heading=t.camera.heading,this.pitch=t.camera.pitch,this.viewer.clock.onTick.addEventListener(this.clock_onTickHandler,this),this.isStart=!0},clock_onTickHandler:function(t){var e=y.default.JulianDate.secondsDifference(this.viewer.clock.currentTime,this.time),i=y.default.Math.toRadians(e*this.angle)+this.heading;this.viewer.scene.camera.setView({destination:this.position,orientation:{heading:i,pitch:this.pitch}}),this.viewer.scene.camera.moveBackward(this.distance)},stop:function(){this.isStart&&(this.viewer&&this.viewer.clock.onTick.removeEventListener(this.clock_onTickHandler,this),this.isStart=!1)}},e.aroundPoint={isStart:!1,viewer:null,start:function(t,e){e||(e=d(t)),this.viewer=t,this.position=y.default.Cartesian3.fromDegrees(e.x,e.y,e.z),this.angle=360/(e.time||60),this.time=t.clock.currentTime.clone(),this.heading=t.camera.heading,this.pitch=t.camera.pitch,this.viewer.clock.onTick.addEventListener(this.clock_onTickHandler,this),this.isStart=!0},clock_onTickHandler:function(t){var e=y.default.JulianDate.secondsDifference(this.viewer.clock.currentTime,this.time),i=y.default.Math.toRadians(e*this.angle)+this.heading;viewer.scene.camera.setView({orientation:{heading:i,pitch:this.pitch}})},stop:function(){this.isStart&&(this.viewer&&this.viewer.clock.onTick.removeEventListener(this.clock_onTickHandler,this),this.isStart=!1)}}},function(t,e,i){"use strict";function n(t){var e,i,n,r;for(i=1,n=arguments.length;i<n;i++){r=arguments[i];for(e in r)t[e]=r[e]}return t}function r(t,e){var i=Array.prototype.slice;if(t.bind)return t.bind.apply(t,i.call(arguments,1));var n=i.call(arguments,2);return function(){return t.apply(e,n.length?n.concat(i.call(arguments)):arguments)}}function a(t){return t._leaflet_id=t._leaflet_id||(e.lastId=k+=1),t._leaflet_id}function o(t,e,i){var n,r,a,o;return o=function(){n=!1,r&&(a.apply(i,r),r=!1)},a=function(){n?r=arguments:(t.apply(i,arguments),setTimeout(o,e),n=!0)}}function s(t,e,i){var n=e[1],r=e[0],a=n-r;return t===n&&i?t:((t-r)%a+a)%a+r}function l(){return!1}function u(t,e){return Number(t.toFixed(e||0))}function c(t){return t.trim?t.trim():t.replace(/^\s+|\s+$/g,"")}function d(t){return c(t).split(/\s+/)}function h(t,e){t.hasOwnProperty("options")||(t.options=t.options?D(t.options):{});for(var i in e)t.options[i]=e[i];return t.options}function f(t,e,i){var n=[];for(var r in t)n.push(encodeURIComponent(i?r.toUpperCase():r)+"="+encodeURIComponent(t[r]));return(e&&-1!==e.indexOf("?")?"&":"?")+n.join("&")}function p(t,e){return t.replace(A,function(t,i){var n=e[i];if(void 0===n)throw new Error("No value provided for variable "+t);return"function"==typeof n&&(n=n(e)),n})}function g(t,e){for(var i=0;i<t.length;i++)if(t[i]===e)return i;return-1}function m(t){return window["webkit"+t]||window["moz"+t]||window["ms"+t]}function y(t){var e=+new Date,i=Math.max(0,16-(e-N));return N=e+i,window.setTimeout(t,i)}function v(t,e,i){if(!i||F!==y)return F.call(window,r(t,e));t.call(e)}function _(t){t&&I.call(window,t)}function w(t){if(!t.properties||!t.properties.type)return t;var e=t.properties.edittype||t.properties.type,i=j[e];if(!i)return t;var n=T.clone(t);if(t.properties.style){var r={};for(var a in t.properties.style){var o=t.properties.style[a];if(null!=o){var s=i.style[a];s!==o&&(r[a]=o)}}n.properties.style=r}if(t.properties.attr){var l={};for(var a in t.properties.attr){var o=t.properties.attr[a];if(null!=o){var s=i.attr[a];s!==o&&(l[a]=o)}}n.properties.attr=l}return n}function b(t){var e=j[t.edittype||t.type];if(e){t.style=t.style||{};for(var i in e.style){var n=t.style[i];null==n&&(t.style[i]=e.style[i])}t.attr=t.attr||{};for(var i in e.attr){var n=t.attr[i];null==n&&(t.attr[i]=e.attr[i])}}return t}function C(t){for(var e=[],i=0,n=t.length;i<n;i++){var r=x(t[i]);e.push(r)}return e}function x(t){var e=S.default.Cartographic.fromCartesian(t);return null==e?{}:[u(S.default.Math.toDegrees(e.longitude),6),u(S.default.Math.toDegrees(e.latitude),6),u(e.height,2)]}function P(t,e){var i="Feature"===t.type?t.geometry:t,n=i?i.coordinates:null;if(!n&&!i)return null;switch(i.type){case"Point":return M(n,e);case"MultiPoint":case"LineString":return E(n,e);case"MultiLineString":case"Polygon":return E(n[0],e);case"MultiPolygon":return E(n[0][0],e);default:throw new Error("Invalid GeoJSON object.")}}function M(t,e){return S.default.Cartesian3.fromDegrees(t[0],t[1],t[2]||e||0)}function E(t,e){for(var i=[],n=0,r=t.length;n<r;n++){var a=t[n];R(a[0])?i.push(E(a,e)):i.push(M(a,e))}return i}Object.defineProperty(e,"__esModule",{value:!0}),e.cancelFn=e.requestFn=e.emptyImageUrl=e.isArray=e.lastId=e.create=e.freeze=void 0,e.extend=n,e.bind=r,e.stamp=a,e.throttle=o,e.wrapNum=s,e.falseFn=l,e.formatNum=u,e.trim=c,e.splitWords=d,e.setOptions=h,e.getParamString=f,e.template=p,e.indexOf=g,e.requestAnimFrame=v,e.cancelAnimFrame=_,e.removeGeoJsonDefVal=w,e.addGeoJsonDefVal=b,e.cartesians2lonlats=C,e.cartesian2lonlat=x,e.getPositionByGeoJSON=P,e.lonlat2cartesian=M,e.lonlats2cartesians=E;var L=i(0),S=function(t){return t&&t.__esModule?t:{default:t}}(L),O=i(4),T=function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e.default=t,e}(O);e.freeze=Object.freeze;Object.freeze=function(t){return t};var D=e.create=Object.create||function(){function t(){}return function(e){return t.prototype=e,new t}}(),k=e.lastId=0,A=/\{ *([\w_-]+) *\}/g,R=e.isArray=Array.isArray||function(t){return"[object Array]"===Object.prototype.toString.call(t)},N=(e.emptyImageUrl="data:image/gif;base64,R0lGODlhAQABAAD/ACwAAAAAAQABAAACADs=",0),F=e.requestFn=window.requestAnimationFrame||m("RequestAnimationFrame")||y,I=e.cancelFn=window.cancelAnimationFrame||m("CancelAnimationFrame")||m("CancelRequestAnimationFrame")||function(t){window.clearTimeout(t)},j={label:{edittype:"label",name:"文字",style:{text:"文字",color:"#ffffff",opacity:1,font_family:"楷体",font_size:30,border:!0,border_color:"#000000",border_width:3,background:!1,background_color:"#000000",background_opacity:.5,font_weight:"normal",font_style:"normal",scaleByDistance:!1,scaleByDistance_far:1e6,scaleByDistance_farValue:.1,scaleByDistance_near:1e3,scaleByDistance_nearValue:1,distanceDisplayCondition:!1,distanceDisplayCondition_far:1e4,distanceDisplayCondition_near:0},attr:{id:"",name:"",remark:""}},point:{edittype:"point",name:"点标记",style:{pixelSize:10,color:"#3388ff",opacity:1,outline:!0,outlineColor:"#ffffff",outlineOpacity:.6,outlineWidth:2,scaleByDistance:!1,scaleByDistance_far:1e6,scaleByDistance_farValue:.1,scaleByDistance_near:1e3,scaleByDistance_nearValue:1,distanceDisplayCondition:!1,distanceDisplayCondition_far:1e4,distanceDisplayCondition_near:0},attr:{id:"",name:"",remark:""}},imagepoint:{edittype:"imagepoint",name:"图标点标记",style:{image:"",opacity:1,scale:1,rotation:0,scaleByDistance:!1,scaleByDistance_far:1e6,scaleByDistance_farValue:.1,scaleByDistance_near:1e3,scaleByDistance_nearValue:1,distanceDisplayCondition:!1,distanceDisplayCondition_far:1e4,distanceDisplayCondition_near:0},attr:{id:"",name:"",remark:""}},model:{edittype:"model",name:"模型",style:{modelUrl:"",scale:1,heading:0,pitch:0,roll:0,fill:!1,color:"#3388ff",opacity:1,silhouette:!1,silhouetteColor:"#ffffff",silhouetteSize:2,silhouetteAlpha:.8},attr:{id:"",name:"",remark:""}},polyline:{edittype:"polyline",name:"线",position:{minCount:2},style:{lineType:"solid",color:"#3388ff",width:4,clampToGround:!1,outline:!1,outlineColor:"#ffffff",outlineWidth:2,opacity:1,zIndex:0},attr:{id:"",name:"",remark:""}},polylineVolume:{edittype:"polylineVolume",name:"管道线",position:{height:!0,minCount:2},style:{color:"#00FF00",radius:10,shape:"pipeline",outline:!1,outlineColor:"#ffffff",opacity:1},attr:{id:"",name:"",remark:""}},polygon:{edittype:"polygon",name:"面",position:{height:!0,minCount:3},style:{fill:!0,color:"#3388ff",opacity:.6,outline:!0,outlineWidth:1,outlineColor:"#ffffff",outlineOpacity:.6,clampToGround:!1,zIndex:0},attr:{id:"",name:"",remark:""}},polygon_clampToGround:{edittype:"polygon_clampToGround",name:"贴地面",position:{height:!1,minCount:3},style:{color:"#ffff00",opacity:.6,clampToGround:!0,zIndex:0},attr:{id:"",name:"",remark:""}},extrudedPolygon:{edittype:"extrudedPolygon",name:"拉伸面",position:{height:!0,minCount:3},style:{fill:!0,color:"#00FF00",opacity:.6,outline:!0,outlineWidth:1,outlineColor:"#ffffff",outlineOpacity:.6,extrudedHeight:100,perPositionHeight:!0,zIndex:0},attr:{id:"",name:"",remark:""}},rectangle:{edittype:"rectangle",name:"矩形",position:{height:!1,minCount:2,maxCount:2},style:{height:0,fill:!0,color:"#3388ff",opacity:.6,outline:!0,outlineWidth:1,outlineColor:"#ffffff",outlineOpacity:.6,rotation:0,clampToGround:!1,zIndex:0},attr:{id:"",name:"",remark:""}},rectangle_clampToGround:{edittype:"rectangle_clampToGround",name:"贴地矩形",position:{height:!1,minCount:2,maxCount:2},style:{color:"#ffff00",opacity:.6,rotation:0,clampToGround:!0,zIndex:0},attr:{id:"",name:"",remark:""}},rectangleImg:{edittype:"rectangleImg",name:"贴地图片",position:{height:!1,minCount:2,maxCount:2},style:{image:"",opacity:1,rotation:0,clampToGround:!0,zIndex:0},attr:{id:"",name:"",remark:""}},extrudedRectangle:{edittype:"extrudedRectangle",name:"拉伸矩形",position:{height:!1,minCount:2,maxCount:2},style:{extrudedHeight:40,height:0,fill:!0,color:"#00FF00",opacity:.6,outline:!0,outlineWidth:1,outlineColor:"#ffffff",outlineOpacity:.6,rotation:0,zIndex:0},attr:{id:"",name:"",remark:""}},ellipse:{edittype:"ellipse",name:"椭圆",position:{height:!1},style:{semiMinorAxis:200,semiMajorAxis:200,height:0,fill:!0,color:"#3388ff",opacity:.6,outline:!0,outlineWidth:1,outlineColor:"#ffffff",outlineOpacity:.6,rotation:0,clampToGround:!1,zIndex:0},attr:{id:"",name:"",remark:""}},ellipse_clampToGround:{edittype:"ellipse_clampToGround",name:"椭圆",position:{height:!1},style:{semiMinorAxis:200,semiMajorAxis:200,color:"#ffff00",opacity:.6,rotation:0,clampToGround:!0,zIndex:0},attr:{id:"",name:"",remark:""}},extrudedEllipse:{edittype:"extrudedEllipse",name:"圆柱体",position:{height:!1},style:{semiMinorAxis:200,semiMajorAxis:200,extrudedHeight:200,height:0,fill:!0,color:"#00FF00",opacity:.6,outline:!0,outlineWidth:1,outlineColor:"#ffffff",outlineOpacity:.6,rotation:0,zIndex:0},attr:{id:"",name:"",remark:""}},ellipsoid:{edittype:"ellipsoid",name:"球体",style:{extentRadii:200,widthRadii:200,heightRadii:200,fill:!0,color:"#00FF00",opacity:.6,outline:!0,outlineWidth:1,outlineColor:"#ffffff",outlineOpacity:.6},attr:{id:"",name:"",remark:""}},wall:{edittype:"wall",name:"墙体",position:{height:!0,minCount:2},style:{extrudedHeight:40,fill:!0,color:"#00FF00",opacity:.6,outline:!0,outlineWidth:1,outlineColor:"#ffffff",outlineOpacity:.6},attr:{id:"",name:"",remark:""}}}},function(t,e,i){"use strict";function n(t){var e=document.createElement("DIV");e.className="draw-tooltip right";var i=document.createElement("DIV");i.className="draw-tooltip-arrow",e.appendChild(i);var n=document.createElement("DIV");n.className="draw-tooltip-inner",e.appendChild(n),this._div=e,this._title=n,t.appendChild(e),(0,a.default)(".draw-tooltip").mouseover(function(){(0,a.default)(this).hide()})}Object.defineProperty(e,"__esModule",{value:!0}),e.message=void 0,e.Tooltip=n;var r=i(5),a=function(t){return t&&t.__esModule?t:{default:t}}(r);e.message={draw:{point:{start:"单击 完成绘制"},polyline:{start:"单击 开始绘制",cont:"单击增加点，右击删除点",end:"单击增加点，右击删除点<br/>双击完成绘制",end2:"单击完成绘制"}},edit:{start:"单击后 激活编辑",end:"释放后 完成修改"},dragger:{def:"拖动 修改位置",addMidPoint:"拖动 增加点",moveHeight:"拖动 修改高度",editRadius:"拖动 修改半径",editHeading:"拖动 修改方向",editScale:"拖动 修改缩放比例"},del:{def:"<br/>右击 删除该点",min:"无法删除，点数量不能少于"}};n.prototype.setVisible=function(t){this._div.style.display=t?"block":"none"},n.prototype.showAt=function(t,e){t&&e?(this.setVisible(!0),this._title.innerHTML=e,this._div.style.top=t.y-this._div.clientHeight/2+"px",this._div.style.left=t.x+30+"px"):this.setVisible(!1)}},function(t,e,i){"use strict";function n(t){return"number"==typeof t&&t.constructor==Number}function r(t){return"string"==typeof t&&t.constructor==String}function a(t,e){window.haoutil&&window.haoutil.alert?window.haoutil.alert(t):window.layer?layer.alert(t,{title:e||"提示",skin:"layui-layer-lan layer-mars-dialog",closeBtn:0,anim:0}):a(t)}function o(t){window.haoutil&&window.haoutil.msg?window.haoutil.msg(t):window.toastr?toastr.info(t):window.layer?layer.msg(t):a(t)}function s(){var t=location.search,e=new Object;if(-1!=t.indexOf("?"))for(var i=t.substr(1),n=i.split("&"),r=0;r<n.length;r++)e[n[r].split("=")[0]]=decodeURI(n[r].split("=")[1]);return e}function l(t){var e=new RegExp("(^|&)"+t+"=([^&]*)(&|$)","i"),i=window.location.search.substr(1).match(e);return null!=i?decodeURI(i[2]):null}function u(t){if(null==t||"object"!=(void 0===t?"undefined":C(t)))return t;if(t instanceof Date){var e=new Date;return e.setTime(t.getTime()),e}if(t instanceof Array){for(var e=[],i=0,n=t.length;i<n;++i)e[i]=u(t[i]);return e}if("object"===(void 0===t?"undefined":C(t))){var e={};for(var r in t)"_layer"!=r&&"_layers"!=r&&"_parent"!=r&&t.hasOwnProperty(r)&&(e[r]=u(t[r]));return e}return t}function c(t,e){if(null==t)return t;for(var i in e){var n=e[i];null!=n&&"Null"!=n&&"Unknown"!=n||(n=""),t=t.replace(new RegExp("{"+i+"}","gm"),n)}return t}function d(){var t=navigator.userAgent.toLowerCase(),e="ipad"==t.match(/ipad/i),i="iphone"==t.match(/iphone/i),n="midp"==t.match(/midp/i),r="rv:1.2.3.4"==t.match(/rv:1.2.3.4/i),a="ucweb"==t.match(/ucweb/i),o="android"==t.match(/android/i),s="windows ce"==t.match(/windows ce/i),l="windows mobile"==t.match(/windows mobile/i);return!(e||i||n||r||a||o||s||l)}function h(){var t=window.navigator.userAgent.toLowerCase();if(t.indexOf("msie")>=0){var e=Number(t.match(/msie ([\d]+)/)[1]);return{type:"IE",version:e}}if(t.indexOf("firefox")>=0){var e=Number(t.match(/firefox\/([\d]+)/)[1]);return{type:"Firefox",version:e}}if(t.indexOf("chrome")>=0){var e=Number(t.match(/chrome\/([\d]+)/)[1]);return{type:"Chrome",version:e}}if(t.indexOf("opera")>=0){var e=Number(t.match(/opera.([\d]+)/)[1]);return{type:"Opera",version:e}}if(t.indexOf("Safari")>=0){var e=Number(t.match(/version\/([\d]+)/)[1]);return{type:"Safari",version:e}}return{type:t,version:-1}}function f(){var t=h();if("IE"==t.type&&t.version<11)return!1;try{var e,i=document.createElement("canvas");if("undefined"!=typeof WebGL2RenderingContext&&(e=i.getContext("webgl2")||i.getContext("experimental-webgl2")||void 0),null==e&&(e=i.getContext("webgl")||i.getContext("experimental-webgl")||void 0),null==e)return!1}catch(t){return!1}return!0}function p(t){var e=t.viewer,i=t.positions;if(null==i||0==i.length)return void(t.calback&&t.calback(i));for(var n=P.default.PolylinePipeline.generateArc({positions:i,granularity:t.granularity||1e-5}),r=[],a=e.scene.globe.ellipsoid,o=0;o<n.length;o+=3){var s=P.default.Cartesian3.unpack(n,o);r.push(a.cartesianToCartographic(s))}var l=P.default.Cartographic.fromCartesian(i[0]).height;P.default.when(P.default.sampleTerrainMostDetailed(e.terrainProvider,r),function(n){for(var r=!1,o=t.offset||2,s=0;s<n.length;++s)null==n[s].height?(r=!0,n[s].height=l):n[s].height=o+n[s].height*e.scene._terrainExaggeration;var u=a.cartographicArrayToCartesianArray(n);t.calback?t.calback(u,r):i.setValue&&i.setValue(u)})}function g(t){if(!t.proxy||!t.url)return t;if(t.url instanceof P.default.Resource)return t;var e={};for(var i in t)e[i]=t[i];return e.url=new P.default.Resource({url:e.url,proxy:new P.default.DefaultProxy(e.proxy)}),e}function m(){return M}function y(t){t.hasOwnProperty("requestWaterMask")||(t.requestWaterMask=!0),t.hasOwnProperty("requestVertexNormals")||(t.requestVertexNormals=!0);return"ion"==t.type||"ion"==t.url||""==t.url||null==t.url?new P.default.CesiumTerrainProvider({url:P.default.IonResource.fromAssetId(1)}):"ellipsoid"==t.type||"ellipsoid"==t.url?M:"gee"==t.type?new P.default.GoogleEarthEnterpriseTerrainProvider({metadata:new P.default.GoogleEarthEnterpriseMetadata(g(t))}):new P.default.CesiumTerrainProvider(g(t))}function v(t,e){t=e.mars.point2map(t);var i=P.default.Cartesian3.fromDegrees(t.x,t.y,t.z||0),n=P.default.Math.toRadians(t.heading||0),r=P.default.Math.toRadians(t.pitch||0),a=P.default.Math.toRadians(t.roll||0),o=new P.default.HeadingPitchRoll(n,r,a),s=t.converter||P.default.Transforms.eastNorthUpToFixedFrame,l=P.default.Transforms.headingPitchRollQuaternion(i,o,e.scene.globe.ellipsoid,s);return e.entities.add({name:t.name||"",position:i,orientation:l,model:t,tooltip:t.tooltip,popup:t.popup})}function _(t){t=Math.abs(t);var e=Math.floor(t);return e+"° "+Math.floor(60*(t-e))+"'  "+Math.round(3600*(t-e)%60)+'"'}function w(t){var e=(new Date).getTime(),i=Number(window.localStorage.getItem("tokenTime1987")||e),n=new Date(t.start).getTime(),r=new Date(t.end).getTime();return t.hostname&&-1===window.location.hostname.indexOf(t.hostname)||e<=n||e>=r||i<=n||i>=r?(window.layer?layer.open({type:1,title:unescape("%u8BB8%u53EF%u5230%u671F%u63D0%u793A"),skin:"layer-mars-dialog",shade:[1,"#000"],closeBtn:0,resize:!1,area:["400px","150px"],content:'<div style="margin: 20px;">'+t.msg+"</div>"}):a(t.msg),!1):(window.localStorage.setItem("tokenTime1987",e),setTimeout(function(){w(t)},6e5+6e5*Math.random()),!0)}function b(t,e,i,n){var r=[],a=P.default.Cartographic.fromCartesian(t),o=P.default.Cartographic.fromCartesian(e),s=180*a.longitude/Math.PI,l=180*a.latitude/Math.PI,u=180*o.longitude/Math.PI,c=180*o.latitude/Math.PI,d=Math.sqrt((s-u)*(s-u)+(l-c)*(l-c)),h=d*i,f=P.default.Cartesian3.clone(t),p=P.default.Cartesian3.clone(e),g=P.default.Cartesian3.distance(f,P.default.Cartesian3.ZERO),m=P.default.Cartesian3.distance(p,P.default.Cartesian3.ZERO);if(P.default.Cartesian3.normalize(f,f),P.default.Cartesian3.normalize(p,p),0==P.default.Cartesian3.distance(f,p))return r;var y=P.default.Cartesian3.angleBetween(f,p);r.push(t);for(var v=1;v<n-1;v++){var _=1*v/(n-1),w=1-_,b=Math.sin(w*y)/Math.sin(y),C=Math.sin(_*y)/Math.sin(y),x=P.default.Cartesian3.multiplyByScalar(f,b,new P.default.Cartesian3),M=P.default.Cartesian3.multiplyByScalar(p,C,new P.default.Cartesian3),E=P.default.Cartesian3.add(x,M,new P.default.Cartesian3),L=_*Math.PI,S=g*w+m*_+Math.sin(L)*h;E=P.default.Cartesian3.multiplyByScalar(E,S,E),r.push(E)}return r.push(e),r}Object.defineProperty(e,"__esModule",{value:!0}),e.getProxyUrl=e.checkToken=e.getLinkedPointList=e.formatDegree=e.createModel=e.getTerrainProvider=e.getEllipsoidTerrain=e.terrainPolyline=e.webglreport=e.getExplorerInfo=e.template=e.clone=e.isPCBroswer=e.msg=e.alert=e.isString=e.isNumber=e.getRequestByName=e.getRequest=void 0;var C="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},x=i(0),P=function(t){return t&&t.__esModule?t:{default:t}}(x),M=new P.default.EllipsoidTerrainProvider({ellipsoid:P.default.Ellipsoid.WGS84});e.getRequest=s,e.getRequestByName=l,e.isNumber=n,e.isString=r,e.alert=a,e.msg=o,e.isPCBroswer=d,e.clone=u,e.template=c,e.getExplorerInfo=h,e.webglreport=f,e.terrainPolyline=p,e.getEllipsoidTerrain=m,e.getTerrainProvider=y,e.createModel=v,e.formatDegree=_,e.getLinkedPointList=b,e.checkToken=w,e.getProxyUrl=g},function(t,e){t.exports=__WEBPACK_EXTERNAL_MODULE_5__},function(t,e,i){"use strict";function n(t,e){switch(t){case u.AddMidPoint:e.color=c.AddMidPoint,e.outlineColor=new o.default.Color.fromCssColorString("#ffffff").withAlpha(.4);break;case u.MoveHeight:e.color=c.MoveHeight;break;case u.EditAttr:e.color=c.EditAttr;break;case u.Control:default:e.color=c.Control}return e}function r(t,e){var i;if(e.dragger)i=e.dragger;else{var r={scale:1,pixelSize:l,outlineColor:new o.default.Color.fromCssColorString("#ffffff").withAlpha(.5),outlineWidth:2,scaleByDistance:new o.default.NearFarScalar(1e3,1,1e6,.5),disableDepthTestDistance:Number.POSITIVE_INFINITY};r=n(e.type,r),i=t.entities.add({position:o.default.defaultValue(e.position,o.default.Cartesian3.ZERO),point:r,draw_tooltip:e.tooltip||s.message.dragger.def})}return i._isDragger=!0,i._pointType=e.type||u.Control,i.onDragStart=o.default.defaultValue(e.onDragStart,null),i.onDrag=o.default.defaultValue(e.onDrag,null),i.onDragEnd=o.default.defaultValue(e.onDragEnd,null),i}Object.defineProperty(e,"__esModule",{value:!0}),e.PointColor=e.PointType=e.PixelSize=void 0,e.createDragger=r;var a=i(0),o=function(t){return t&&t.__esModule?t:{default:t}}(a),s=i(3),l=e.PixelSize=12,u=e.PointType={Control:1,AddMidPoint:2,MoveHeight:3,EditAttr:4,EditRotation:5},c=e.PointColor={Control:new o.default.Color.fromCssColorString("#1c197d"),MoveHeight:new o.default.Color.fromCssColorString("#9500eb"),EditAttr:new o.default.Color.fromCssColorString("#f73163"),AddMidPoint:new o.default.Color.fromCssColorString("#04c2c9").withAlpha(.3)}},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.BaseLayer=void 0;var n=i(10),r=i(4),a=n.Class.extend({config:{},viewer:null,initialize:function(t,e){this.viewer=e,this.config=t,this.name=t.name,this.config.hasOwnProperty("alpha")?this._opacity=Number(this.config.alpha):this.config.hasOwnProperty("opacity")&&(this._opacity=Number(this.config.opacity)),this.config.hasOwnProperty("hasOpacity")&&(this.hasOpacity=this.config.hasOpacity),this.create(),t.visible?this.setVisible(!0):this._visible=!1,t.visible&&t.flyTo&&this.centerAt(0)},create:function(){},showError:function(t,e){e||(e="未知错误"),this.viewer&&this.viewer.cesiumWidget.showErrorPanel(t,void 0,e),console.log("layer错误:"+t+e)},_visible:null,getVisible:function(){return this._visible},setVisible:function(t){null!=this._visible&&this._visible==t||(this._visible=t,t?(this.config.msg&&(0,r.msg)(this.config.msg),this.add()):this.remove())},add:function(){this._visible=!0,this.config.onAdd&&this.config.onAdd()},remove:function(){this._visible=!1,this.config.onRemove&&this.config.onRemove()},centerAt:function(t){this.config.extent||this.config.center?this.viewer.mars.centerAt(this.config.extent||this.config.center,{duration:t,isWgs84:!0}):this.config.onCenterAt&&this.config.onCenterAt(t)},hasOpacity:!1,_opacity:1,setOpacity:function(t){this.config.onSetOpacity&&this.config.onSetOpacity(t)},hasZIndex:!1,setZIndex:function(t){this.config.onSetZIndex&&this.config.onSetZIndex(t)},destroy:function(){this.setVisible(!1)}});e.BaseLayer=a},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});e.DrawStart="draw-start",e.DrawAddPoint="draw-add-point",e.DrawRemovePoint="draw-remove-lastpoint",e.DrawMouseMove="draw-mouse-move",e.DrawCreated="draw-created",e.EditStart="edit-start",e.EditMovePoint="edit-move-point",e.EditRemovePoint="edit-remove-point",e.EditStop="edit-stop"},function(t,e,i){"use strict";function n(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e.default=t,e}Object.defineProperty(e,"__esModule",{value:!0}),e.DrawPolyline=void 0;var r=i(0),a=function(t){return t&&t.__esModule?t:{default:t}}(r),o=i(26),s=i(1),l=i(8),u=n(l),c=i(3),d=i(11),h=n(d),f=i(14);e.DrawPolyline=o.DrawBase.extend({type:"polyline",_minPointNum:2,_maxPointNum:9999,createFeature:function(t){this._positions_draw=[],t.config?(this._minPointNum=t.config.minPointNum||2,this._maxPointNum=t.config.maxPointNum||9999):(this._minPointNum=2,this._maxPointNum=9999);var e=this,i={polyline:h.style2Entity(t.style),attribute:t};return i.polyline.positions=new a.default.CallbackProperty(function(t){return e.getDrawPosition()},!1),this.entity=this.dataSource.entities.add(i),this.entity._positions_draw=this._positions_draw,this.entity},style2Entity:function(t,e){return h.style2Entity(t,e.polyline)},bindEvent:function(){var t=this,e=!1;this.getHandler().setInputAction(function(i){var n=(0,s.getCurrentMousePosition)(t.viewer.scene,i.position,t.entity);n&&(e&&t._positions_draw.pop(),e=!1,t.entity.attribute&&t.entity.attribute.config&&t.entity.attribute.config.addHeight&&(n=(0,s.addPositionsHeight)(n,t.entity.attribute.config.addHeight)),t._positions_draw.push(n),t.updateAttrForDrawing(),t.fire(u.DrawAddPoint,{drawtype:t.type,entity:t.entity,position:n,positions:t._positions_draw}),t._positions_draw.length>=t._maxPointNum&&t.disable())},a.default.ScreenSpaceEventType.LEFT_CLICK),this.getHandler().setInputAction(function(i){t._positions_draw.pop();var n=(0,s.getCurrentMousePosition)(t.viewer.scene,i.position,t.entity);n&&(e&&t._positions_draw.pop(),e=!0,t.fire(u.DrawRemovePoint,{drawtype:t.type,entity:t.entity,position:n,positions:t._positions_draw}),t._positions_draw.push(n),t.updateAttrForDrawing())},a.default.ScreenSpaceEventType.RIGHT_CLICK),this.getHandler().setInputAction(function(i){t._positions_draw.length<=1?t.tooltip.showAt(i.endPosition,c.message.draw.polyline.start):t._positions_draw.length<t._minPointNum?t.tooltip.showAt(i.endPosition,c.message.draw.polyline.cont):t._positions_draw.length>=t._maxPointNum?t.tooltip.showAt(i.endPosition,c.message.draw.polyline.end2):t.tooltip.showAt(i.endPosition,c.message.draw.polyline.end);var n=(0,s.getCurrentMousePosition)(t.viewer.scene,i.endPosition,t.entity);n&&(e&&t._positions_draw.pop(),e=!0,t._positions_draw.push(n),t.updateAttrForDrawing(),t.fire(u.DrawMouseMove,{drawtype:t.type,entity:t.entity,position:n,positions:t._positions_draw}))},a.default.ScreenSpaceEventType.MOUSE_MOVE),this.getHandler().setInputAction(function(e){t._positions_draw.pop(),t._positions_draw.length<t._minPointNum||(t.updateAttrForDrawing(),t.disable())},a.default.ScreenSpaceEventType.LEFT_DOUBLE_CLICK)},getEditClass:function(t){var e=new f.EditPolyline(t,this.viewer,this.dataSource);return e._minPointNum=this._minPointNum,e._maxPointNum=this._maxPointNum,this._bindEdit(e)},getAttrClass:function(){return h},finish:function(){var t=this.entity;t.editing=this.getEditClass(t),t._positions_draw=this.getDrawPosition(),t.polyline.positions=new a.default.CallbackProperty(function(e){return t._positions_draw},!1)}})},function(t,e,i){"use strict";function n(){}Object.defineProperty(e,"__esModule",{value:!0}),e.Class=n;var r=i(2),a=function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e.default=t,e}(r);n.extend=function(t){var e=function(){this.initialize&&this.initialize.apply(this,arguments),this.callInitHooks()},i=e.__super__=this.prototype,n=a.create(i);n.constructor=e,e.prototype=n;for(var r in this)this.hasOwnProperty(r)&&"prototype"!==r&&"__super__"!==r&&(e[r]=this[r]);return t.statics&&(a.extend(e,t.statics),delete t.statics),t.includes&&(a.extend.apply(null,[n].concat(t.includes)),delete t.includes),n.options&&(t.options=a.extend(a.create(n.options),t.options)),a.extend(n,t),n._initHooks=[],n.callInitHooks=function(){if(!this._initHooksCalled){i.callInitHooks&&i.callInitHooks.call(this),this._initHooksCalled=!0;for(var t=0,e=n._initHooks.length;t<e;t++)n._initHooks[t].call(this)}},e},n.include=function(t){return a.extend(this.prototype,t),this},n.mergeOptions=function(t){return a.extend(this.prototype.options,t),this},n.addInitHook=function(t){var e=Array.prototype.slice.call(arguments,1),i="function"==typeof t?t:function(){this[t].apply(this,e)};return this.prototype._initHooks=this.prototype._initHooks||[],this.prototype._initHooks.push(i),this}},function(t,e,i){"use strict";function n(t,e){t=t||{},null==e&&(e={});for(var i in t){var n=t[i];switch(i){default:e[i]=n;break;case"lineType":case"color":case"opacity":case"outline":case"outlineWidth":case"outlineColor":case"outlineOpacity":}}if(t.color||t.lineType){var r=new u.default.Color.fromCssColorString(t.color||"#FFFF00").withAlpha(Number(t.opacity||1));switch(t.lineType){default:case"solid":t.outline?e.material=new u.default.PolylineOutlineMaterialProperty({color:r,outlineWidth:Number(t.outlineWidth||1),outlineColor:new u.default.Color.fromCssColorString(t.outlineColor||"#FFFF00").withAlpha(Number(t.outlineOpacity||t.opacity||1))}):e.material=r;break;case"dash":t.outline?e.material=new u.default.PolylineDashMaterialProperty({dashLength:t.dashLength||t.outlineWidth||16,color:r,gapColor:new u.default.Color.fromCssColorString(t.outlineColor||"#FFFF00").withAlpha(Number(t.outlineOpacity||t.opacity||1))}):e.material=new u.default.PolylineDashMaterialProperty({dashLength:t.dashLength||16,color:r});break;case"glow":e.material=new u.default.PolylineGlowMaterialProperty({glowPower:t.glowPower||.1,color:r});break;case"arrow":e.material=new u.default.PolylineArrowMaterialProperty(r)}}return e}function r(t){return t._positions_draw&&t._positions_draw.length>0?t._positions_draw:t.polyline.positions.getValue()}function a(t){var e=r(t);return d.cartesians2lonlats(e)}function o(t){var e=a(t);return{type:"Feature",properties:t.attribute||{},geometry:{type:"LineString",coordinates:e}}}function s(t){if(!window.turf)return t;var e=t.map(function(t){return d.cartesian2lonlat(t)}),i=e[e.length-1][2],n=turf.lineString(e),r=turf.bezierSpline(n);return d.lonlats2cartesians(r.geometry.coordinates,i)}Object.defineProperty(e,"__esModule",{value:!0}),e.style2Entity=n,e.getPositions=r,e.getCoordinates=a,e.toGeoJSON=o,e.line2curve=s;var l=i(0),u=function(t){return t&&t.__esModule?t:{default:t}}(l),c=i(2),d=function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e.default=t,e}(c)},function(t,e,i){"use strict";var n,r,a,o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t};!function(i,s){"object"===o(e)&&void 0!==t?s(e):(r=[e],n=s,void 0!==(a="function"==typeof n?n.apply(e,r):n)&&(t.exports=a))}(0,function(t){function e(t){var e,i,n,r;for(i=1,n=arguments.length;i<n;i++){r=arguments[i];for(e in r)t[e]=r[e]}return t}function i(t,e){var i=Array.prototype.slice;if(t.bind)return t.bind.apply(t,i.call(arguments,1));var n=i.call(arguments,2);return function(){return t.apply(e,n.length?n.concat(i.call(arguments)):arguments)}}function n(t){return t._leaflet_id=t._leaflet_id||++$t,t._leaflet_id}function r(t,e,i){var n,r,a,o;return o=function(){n=!1,r&&(a.apply(i,r),r=!1)},a=function(){n?r=arguments:(t.apply(i,arguments),setTimeout(o,e),n=!0)}}function a(t,e,i){var n=e[1],r=e[0],a=n-r;return t===n&&i?t:((t-r)%a+a)%a+r}function s(){return!1}function l(t,e){var i=Math.pow(10,void 0===e?6:e);return Math.round(t*i)/i}function u(t){return t.trim?t.trim():t.replace(/^\s+|\s+$/g,"")}function c(t){return u(t).split(/\s+/)}function d(t,e){t.hasOwnProperty("options")||(t.options=t.options?Kt(t.options):{});for(var i in e)t.options[i]=e[i];return t.options}function h(t,e,i){var n=[];for(var r in t)n.push(encodeURIComponent(i?r.toUpperCase():r)+"="+encodeURIComponent(t[r]));return(e&&-1!==e.indexOf("?")?"&":"?")+n.join("&")}function f(t,e){return t.replace(te,function(t,i){var n=e[i];if(void 0===n)throw new Error("No value provided for variable "+t);return"function"==typeof n&&(n=n(e)),n})}function p(t,e){for(var i=0;i<t.length;i++)if(t[i]===e)return i;return-1}function g(t){return window["webkit"+t]||window["moz"+t]||window["ms"+t]}function m(t){var e=+new Date,i=Math.max(0,16-(e-ie));return ie=e+i,window.setTimeout(t,i)}function y(t,e,n){if(!n||ne!==m)return ne.call(window,i(t,e));t.call(e)}function v(t){t&&re.call(window,t)}function _(){}function w(t){if("undefined"!=typeof L&&L&&L.Mixin){t=ee(t)?t:[t];for(var e=0;e<t.length;e++)t[e]===L.Mixin.Events&&console.warn("Deprecated include of L.Mixin.Events: this property will be removed in future releases, please inherit from L.Evented instead.",(new Error).stack)}}function b(t,e,i){this.x=i?Math.round(t):t,this.y=i?Math.round(e):e}function C(t,e,i){return t instanceof b?t:ee(t)?new b(t[0],t[1]):void 0===t||null===t?t:"object"===(void 0===t?"undefined":o(t))&&"x"in t&&"y"in t?new b(t.x,t.y):new b(t,e,i)}function x(t,e){if(t)for(var i=e?[t,e]:t,n=0,r=i.length;n<r;n++)this.extend(i[n])}function P(t,e){return!t||t instanceof x?t:new x(t,e)}function M(t,e){if(t)for(var i=e?[t,e]:t,n=0,r=i.length;n<r;n++)this.extend(i[n])}function E(t,e){return t instanceof M?t:new M(t,e)}function S(t,e,i){if(isNaN(t)||isNaN(e))throw new Error("Invalid LatLng object: ("+t+", "+e+")");this.lat=+t,this.lng=+e,void 0!==i&&(this.alt=+i)}function O(t,e,i){return t instanceof S?t:ee(t)&&"object"!==o(t[0])?3===t.length?new S(t[0],t[1],t[2]):2===t.length?new S(t[0],t[1]):null:void 0===t||null===t?t:"object"===(void 0===t?"undefined":o(t))&&"lat"in t?new S(t.lat,"lng"in t?t.lng:t.lon,t.alt):void 0===e?null:new S(t,e,i)}function T(t,e,i,n){if(ee(t))return this._a=t[0],this._b=t[1],this._c=t[2],void(this._d=t[3]);this._a=t,this._b=e,this._c=i,this._d=n}function D(t,e,i,n){return new T(t,e,i,n)}function k(t){return navigator.userAgent.toLowerCase().indexOf(t)>=0}function A(t,e,i,n){return"touchstart"===e?N(t,i,n):"touchmove"===e?G(t,i,n):"touchend"===e&&B(t,i,n),this}function R(t,e,i){var n=t["_leaflet_"+e+i];return"touchstart"===e?t.removeEventListener(Xe,n,!1):"touchmove"===e?t.removeEventListener(Qe,n,!1):"touchend"===e&&(t.removeEventListener(Ke,n,!1),t.removeEventListener($e,n,!1)),this}function N(t,e,n){var r=i(function(t){if("mouse"!==t.pointerType&&t.MSPOINTER_TYPE_MOUSE&&t.pointerType!==t.MSPOINTER_TYPE_MOUSE){if(!(ti.indexOf(t.target.tagName)<0))return;bt(t)}H(t,e)});t["_leaflet_touchstart"+n]=r,t.addEventListener(Xe,r,!1),ii||(document.documentElement.addEventListener(Xe,F,!0),document.documentElement.addEventListener(Qe,I,!0),document.documentElement.addEventListener(Ke,j,!0),document.documentElement.addEventListener($e,j,!0),ii=!0)}function F(t){ei[t.pointerId]=t,ni++}function I(t){ei[t.pointerId]&&(ei[t.pointerId]=t)}function j(t){delete ei[t.pointerId],ni--}function H(t,e){t.touches=[];for(var i in ei)t.touches.push(ei[i]);t.changedTouches=[t],e(t)}function G(t,e,i){var n=function(t){(t.pointerType!==t.MSPOINTER_TYPE_MOUSE&&"mouse"!==t.pointerType||0!==t.buttons)&&H(t,e)};t["_leaflet_touchmove"+i]=n,t.addEventListener(Qe,n,!1)}function B(t,e,i){var n=function(t){H(t,e)};t["_leaflet_touchend"+i]=n,t.addEventListener(Ke,n,!1),t.addEventListener($e,n,!1)}function V(t,e,i){function n(t){var e;if(Be){if(!we||"mouse"===t.pointerType)return;e=ni}else e=t.touches.length;if(!(e>1)){var i=Date.now(),n=i-(a||i);o=t.touches?t.touches[0]:t,s=n>0&&n<=l,a=i}}function r(t){if(s&&!o.cancelBubble){if(Be){if(!we||"mouse"===t.pointerType)return;var i,n,r={};for(n in o)i=o[n],r[n]=i&&i.bind?i.bind(o):i;o=r}o.type="dblclick",e(o),a=null}}var a,o,s=!1,l=250;return t[oi+ri+i]=n,t[oi+ai+i]=r,t[oi+"dblclick"+i]=e,t.addEventListener(ri,n,!1),t.addEventListener(ai,r,!1),t.addEventListener("dblclick",e,!1),this}function z(t,e){var i=t[oi+ri+e],n=t[oi+ai+e],r=t[oi+"dblclick"+e];return t.removeEventListener(ri,i,!1),t.removeEventListener(ai,n,!1),we||t.removeEventListener("dblclick",r,!1),this}function U(t){return"string"==typeof t?document.getElementById(t):t}function W(t,e){var i=t.style[e]||t.currentStyle&&t.currentStyle[e];if((!i||"auto"===i)&&document.defaultView){var n=document.defaultView.getComputedStyle(t,null);i=n?n[e]:null}return"auto"===i?null:i}function q(t,e,i){var n=document.createElement(t);return n.className=e||"",i&&i.appendChild(n),n}function Z(t){var e=t.parentNode;e&&e.removeChild(t)}function J(t){for(;t.firstChild;)t.removeChild(t.firstChild)}function Y(t){var e=t.parentNode;e.lastChild!==t&&e.appendChild(t)}function X(t){var e=t.parentNode;e.firstChild!==t&&e.insertBefore(t,e.firstChild)}function Q(t,e){if(void 0!==t.classList)return t.classList.contains(e);var i=et(t);return i.length>0&&new RegExp("(^|\\s)"+e+"(\\s|$)").test(i)}function K(t,e){if(void 0!==t.classList)for(var i=c(e),n=0,r=i.length;n<r;n++)t.classList.add(i[n]);else if(!Q(t,e)){var a=et(t);tt(t,(a?a+" ":"")+e)}}function $(t,e){void 0!==t.classList?t.classList.remove(e):tt(t,u((" "+et(t)+" ").replace(" "+e+" "," ")))}function tt(t,e){void 0===t.className.baseVal?t.className=e:t.className.baseVal=e}function et(t){return void 0===t.className.baseVal?t.className:t.className.baseVal}function it(t,e){"opacity"in t.style?t.style.opacity=e:"filter"in t.style&&nt(t,e)}function nt(t,e){var i=!1,n="DXImageTransform.Microsoft.Alpha";try{i=t.filters.item(n)}catch(t){if(1===e)return}e=Math.round(100*e),i?(i.Enabled=100!==e,i.Opacity=e):t.style.filter+=" progid:"+n+"(opacity="+e+")"}function rt(t){for(var e=document.documentElement.style,i=0;i<t.length;i++)if(t[i]in e)return t[i];return!1}function at(t,e,i){var n=e||new b(0,0);t.style[si]=(Ae?"translate("+n.x+"px,"+n.y+"px)":"translate3d("+n.x+"px,"+n.y+"px,0)")+(i?" scale("+i+")":"")}function ot(t,e){t._leaflet_pos=e,Fe?at(t,e):(t.style.left=e.x+"px",t.style.top=e.y+"px")}function st(t){return t._leaflet_pos||new b(0,0)}function lt(){pt(window,"dragstart",bt)}function ut(){gt(window,"dragstart",bt)}function ct(t){for(;-1===t.tabIndex;)t=t.parentNode;t.style&&(dt(),di=t,hi=t.style.outline,t.style.outline="none",pt(window,"keydown",dt))}function dt(){di&&(di.style.outline=hi,di=void 0,hi=void 0,gt(window,"keydown",dt))}function ht(t){do{t=t.parentNode}while(!(t.offsetWidth&&t.offsetHeight||t===document.body));return t}function ft(t){var e=t.getBoundingClientRect();return{x:e.width/t.offsetWidth||1,y:e.height/t.offsetHeight||1,boundingClientRect:e}}function pt(t,e,i,n){if("object"===(void 0===e?"undefined":o(e)))for(var r in e)mt(t,r,e[r],i);else{e=c(e);for(var a=0,s=e.length;a<s;a++)mt(t,e[a],i,n)}return this}function gt(t,e,i,n){if("object"===(void 0===e?"undefined":o(e)))for(var r in e)yt(t,r,e[r],i);else if(e){e=c(e);for(var a=0,s=e.length;a<s;a++)yt(t,e[a],i,n)}else{for(var l in t[gi])yt(t,l,t[gi][l]);delete t[gi]}return this}function mt(t,e,i,r){var a=e+n(i)+(r?"_"+n(r):"");if(t[gi]&&t[gi][a])return this;var o=function(e){return i.call(r||t,e||window.event)},s=o;Be&&0===e.indexOf("touch")?A(t,e,o,a):!Ve||"dblclick"!==e||!V||Be&&Le?"addEventListener"in t?"mousewheel"===e?t.addEventListener("onwheel"in t?"wheel":"mousewheel",o,!1):"mouseenter"===e||"mouseleave"===e?(o=function(e){e=e||window.event,Lt(t,e)&&s(e)},t.addEventListener("mouseenter"===e?"mouseover":"mouseout",o,!1)):("click"===e&&Ce&&(o=function(t){St(t,s)}),t.addEventListener(e,o,!1)):"attachEvent"in t&&t.attachEvent("on"+e,o):V(t,o,a),t[gi]=t[gi]||{},t[gi][a]=o}function yt(t,e,i,r){var a=e+n(i)+(r?"_"+n(r):""),o=t[gi]&&t[gi][a];if(!o)return this;Be&&0===e.indexOf("touch")?R(t,e,a):!Ve||"dblclick"!==e||!z||Be&&Le?"removeEventListener"in t?"mousewheel"===e?t.removeEventListener("onwheel"in t?"wheel":"mousewheel",o,!1):t.removeEventListener("mouseenter"===e?"mouseover":"mouseleave"===e?"mouseout":e,o,!1):"detachEvent"in t&&t.detachEvent("on"+e,o):z(t,a),t[gi][a]=null}function vt(t){return t.stopPropagation?t.stopPropagation():t.originalEvent?t.originalEvent._stopped=!0:t.cancelBubble=!0,Et(t),this}function _t(t){return mt(t,"mousewheel",vt),this}function wt(t){return pt(t,"mousedown touchstart dblclick",vt),mt(t,"click",Mt),this}function bt(t){return t.preventDefault?t.preventDefault():t.returnValue=!1,this}function Ct(t){return bt(t),vt(t),this}function xt(t,e){if(!e)return new b(t.clientX,t.clientY);var i=ft(e),n=i.boundingClientRect;return new b((t.clientX-n.left)/i.x-e.clientLeft,(t.clientY-n.top)/i.y-e.clientTop)}function Pt(t){return we?t.wheelDeltaY/2:t.deltaY&&0===t.deltaMode?-t.deltaY/mi:t.deltaY&&1===t.deltaMode?20*-t.deltaY:t.deltaY&&2===t.deltaMode?60*-t.deltaY:t.deltaX||t.deltaZ?0:t.wheelDelta?(t.wheelDeltaY||t.wheelDelta)/2:t.detail&&Math.abs(t.detail)<32765?20*-t.detail:t.detail?t.detail/-32765*60:0}function Mt(t){yi[t.type]=!0}function Et(t){var e=yi[t.type];return yi[t.type]=!1,e}function Lt(t,e){var i=e.relatedTarget;if(!i)return!0;try{for(;i&&i!==t;)i=i.parentNode}catch(t){return!1}return i!==t}function St(t,e){var i=t.timeStamp||t.originalEvent&&t.originalEvent.timeStamp,n=fi&&i-fi;if(n&&n>100&&n<500||t.target._simulatedClick&&!t._simulated)return void Ct(t);fi=i,e(t)}function Ot(t,e){if(!e||!t.length)return t.slice();var i=e*e;return t=Rt(t,i),t=kt(t,i)}function Tt(t,e,i){return Math.sqrt(Ht(t,e,i,!0))}function Dt(t,e,i){return Ht(t,e,i)}function kt(t,e){var i=t.length,n=("undefined"==typeof Uint8Array?"undefined":o(Uint8Array))!==void 0+""?Uint8Array:Array,r=new n(i);r[0]=r[i-1]=1,At(t,r,e,0,i-1);var a,s=[];for(a=0;a<i;a++)r[a]&&s.push(t[a]);return s}function At(t,e,i,n,r){var a,o,s,l=0;for(o=n+1;o<=r-1;o++)(s=Ht(t[o],t[n],t[r],!0))>l&&(a=o,l=s);l>i&&(e[a]=1,At(t,e,i,n,a),At(t,e,i,a,r))}function Rt(t,e){for(var i=[t[0]],n=1,r=0,a=t.length;n<a;n++)jt(t[n],t[r])>e&&(i.push(t[n]),r=n);return r<a-1&&i.push(t[a-1]),i}function Nt(t,e,i,n,r){var a,o,s,l=n?bi:It(t,i),u=It(e,i);for(bi=u;;){if(!(l|u))return[t,e];if(l&u)return!1;a=l||u,o=Ft(t,e,a,i,r),s=It(o,i),a===l?(t=o,l=s):(e=o,u=s)}}function Ft(t,e,i,n,r){var a,o,s=e.x-t.x,l=e.y-t.y,u=n.min,c=n.max;return 8&i?(a=t.x+s*(c.y-t.y)/l,o=c.y):4&i?(a=t.x+s*(u.y-t.y)/l,o=u.y):2&i?(a=c.x,o=t.y+l*(c.x-t.x)/s):1&i&&(a=u.x,o=t.y+l*(u.x-t.x)/s),new b(a,o,r)}function It(t,e){var i=0;return t.x<e.min.x?i|=1:t.x>e.max.x&&(i|=2),t.y<e.min.y?i|=4:t.y>e.max.y&&(i|=8),i}function jt(t,e){var i=e.x-t.x,n=e.y-t.y;return i*i+n*n}function Ht(t,e,i,n){var r,a=e.x,o=e.y,s=i.x-a,l=i.y-o,u=s*s+l*l;return u>0&&(r=((t.x-a)*s+(t.y-o)*l)/u,r>1?(a=i.x,o=i.y):r>0&&(a+=s*r,o+=l*r)),s=t.x-a,l=t.y-o,n?s*s+l*l:new b(a,o)}function Gt(t){return!ee(t[0])||"object"!==o(t[0][0])&&void 0!==t[0][0]}function Bt(t){return console.warn("Deprecated use of _flat, please use L.LineUtil.isFlat instead."),Gt(t)}function Vt(t,e,i){var n,r,a,o,s,l,u,c,d,h=[1,4,2,8];for(r=0,u=t.length;r<u;r++)t[r]._code=It(t[r],e);for(o=0;o<4;o++){for(c=h[o],n=[],r=0,u=t.length,a=u-1;r<u;a=r++)s=t[r],l=t[a],s._code&c?l._code&c||(d=Ft(l,s,c,e,i),d._code=It(d,e),n.push(d)):(l._code&c&&(d=Ft(l,s,c,e,i),d._code=It(d,e),n.push(d)),n.push(s));t=n}return t}function zt(t,e){var i,n,r,a,o="Feature"===t.type?t.geometry:t,s=o?o.coordinates:null,l=[],u=e&&e.pointToLayer,c=e&&e.coordsToLatLng||Ut;if(!s&&!o)return null;switch(o.type){case"Point":return i=c(s),u?u(t,i):new Bi(i);case"MultiPoint":for(r=0,a=s.length;r<a;r++)i=c(s[r]),l.push(u?u(t,i):new Bi(i));return new Ii(l);case"LineString":case"MultiLineString":return n=Wt(s,"LineString"===o.type?0:1,c),new Wi(n,e);case"Polygon":case"MultiPolygon":return n=Wt(s,"Polygon"===o.type?1:2,c),new qi(n,e);case"GeometryCollection":for(r=0,a=o.geometries.length;r<a;r++){var d=zt({geometry:o.geometries[r],type:"Feature",properties:t.properties},e);d&&l.push(d)}return new Ii(l);default:throw new Error("Invalid GeoJSON object.")}}function Ut(t){return new S(t[1],t[0],t[2])}function Wt(t,e,i){for(var n,r=[],a=0,o=t.length;a<o;a++)n=e?Wt(t[a],e-1,i):(i||Ut)(t[a]),r.push(n);return r}function qt(t,e){return e="number"==typeof e?e:6,void 0!==t.alt?[l(t.lng,e),l(t.lat,e),l(t.alt,e)]:[l(t.lng,e),l(t.lat,e)]}function Zt(t,e,i,n){for(var r=[],a=0,o=t.length;a<o;a++)r.push(e?Zt(t[a],e-1,i,n):qt(t[a],n));return!e&&i&&r.push(r[0]),r}function Jt(t,i){return t.feature?e({},t.feature,{geometry:i}):Yt(i)}function Yt(t){return"Feature"===t.type||"FeatureCollection"===t.type?t:{type:"Feature",properties:{},geometry:t}}function Xt(t,e){return new Zi(t,e)}var Qt=Object.freeze;Object.freeze=function(t){return t};var Kt=Object.create||function(){function t(){}return function(e){return t.prototype=e,new t}}(),$t=0,te=/\{ *([\w_-]+) *\}/g,ee=Array.isArray||function(t){return"[object Array]"===Object.prototype.toString.call(t)},ie=0,ne=window.requestAnimationFrame||g("RequestAnimationFrame")||m,re=window.cancelAnimationFrame||g("CancelAnimationFrame")||g("CancelRequestAnimationFrame")||function(t){window.clearTimeout(t)},ae=(Object.freeze||Object)({freeze:Qt,extend:e,create:Kt,bind:i,lastId:$t,stamp:n,throttle:r,wrapNum:a,falseFn:s,formatNum:l,trim:u,splitWords:c,setOptions:d,getParamString:h,template:f,isArray:ee,indexOf:p,emptyImageUrl:"data:image/gif;base64,R0lGODlhAQABAAD/ACwAAAAAAQABAAACADs=",requestFn:ne,cancelFn:re,requestAnimFrame:y,cancelAnimFrame:v});_.extend=function(t){var i=function(){this.initialize&&this.initialize.apply(this,arguments),this.callInitHooks()},n=i.__super__=this.prototype,r=Kt(n);r.constructor=i,i.prototype=r;for(var a in this)this.hasOwnProperty(a)&&"prototype"!==a&&"__super__"!==a&&(i[a]=this[a]);return t.statics&&(e(i,t.statics),delete t.statics),t.includes&&(w(t.includes),e.apply(null,[r].concat(t.includes)),delete t.includes),r.options&&(t.options=e(Kt(r.options),t.options)),e(r,t),r._initHooks=[],r.callInitHooks=function(){if(!this._initHooksCalled){n.callInitHooks&&n.callInitHooks.call(this),this._initHooksCalled=!0;for(var t=0,e=r._initHooks.length;t<e;t++)r._initHooks[t].call(this)}},i},_.include=function(t){return e(this.prototype,t),this},_.mergeOptions=function(t){return e(this.prototype.options,t),this},_.addInitHook=function(t){var e=Array.prototype.slice.call(arguments,1),i="function"==typeof t?t:function(){this[t].apply(this,e)};return this.prototype._initHooks=this.prototype._initHooks||[],this.prototype._initHooks.push(i),this};var oe={on:function(t,e,i){if("object"===(void 0===t?"undefined":o(t)))for(var n in t)this._on(n,t[n],e);else{t=c(t);for(var r=0,a=t.length;r<a;r++)this._on(t[r],e,i)}return this},off:function(t,e,i){if(t)if("object"===(void 0===t?"undefined":o(t)))for(var n in t)this._off(n,t[n],e);else{t=c(t);for(var r=0,a=t.length;r<a;r++)this._off(t[r],e,i)}else delete this._events;return this},_on:function(t,e,i){this._events=this._events||{};var n=this._events[t];n||(n=[],this._events[t]=n),i===this&&(i=void 0);for(var r={fn:e,ctx:i},a=n,o=0,s=a.length;o<s;o++)if(a[o].fn===e&&a[o].ctx===i)return;a.push(r)},_off:function(t,e,i){var n,r,a;if(this._events&&(n=this._events[t])){if(!e){for(r=0,a=n.length;r<a;r++)n[r].fn=s;return void delete this._events[t]}if(i===this&&(i=void 0),n)for(r=0,a=n.length;r<a;r++){var o=n[r];if(o.ctx===i&&o.fn===e)return o.fn=s,this._firingCount&&(this._events[t]=n=n.slice()),void n.splice(r,1)}}},fire:function(t,i,n){if(!this.listens(t,n))return this;var r=e({},i,{type:t,target:this,sourceTarget:i&&i.sourceTarget||this});if(this._events){var a=this._events[t];if(a){this._firingCount=this._firingCount+1||1;for(var o=0,s=a.length;o<s;o++){var l=a[o];l.fn.call(l.ctx||this,r)}this._firingCount--}}return n&&this._propagateEvent(r),this},listens:function(t,e){var i=this._events&&this._events[t];if(i&&i.length)return!0;if(e)for(var n in this._eventParents)if(this._eventParents[n].listens(t,e))return!0;return!1},once:function(t,e,n){if("object"===(void 0===t?"undefined":o(t))){for(var r in t)this.once(r,t[r],e);return this}var a=i(function(){this.off(t,e,n).off(t,a,n)},this);return this.on(t,e,n).on(t,a,n)},addEventParent:function(t){return this._eventParents=this._eventParents||{},this._eventParents[n(t)]=t,this},removeEventParent:function(t){return this._eventParents&&delete this._eventParents[n(t)],this},_propagateEvent:function(t){for(var i in this._eventParents)this._eventParents[i].fire(t.type,e({layer:t.target,propagatedFrom:t.target},t),!0)}};oe.addEventListener=oe.on,oe.removeEventListener=oe.clearAllEventListeners=oe.off,oe.addOneTimeEventListener=oe.once,oe.fireEvent=oe.fire,oe.hasEventListeners=oe.listens;var se=_.extend(oe),le=Math.trunc||function(t){return t>0?Math.floor(t):Math.ceil(t)};b.prototype={clone:function(){return new b(this.x,this.y)},add:function(t){return this.clone()._add(C(t))},_add:function(t){return this.x+=t.x,this.y+=t.y,this},subtract:function(t){return this.clone()._subtract(C(t))},_subtract:function(t){return this.x-=t.x,this.y-=t.y,this},divideBy:function(t){return this.clone()._divideBy(t)},_divideBy:function(t){return this.x/=t,this.y/=t,this},multiplyBy:function(t){return this.clone()._multiplyBy(t)},_multiplyBy:function(t){return this.x*=t,this.y*=t,this},scaleBy:function(t){return new b(this.x*t.x,this.y*t.y)},unscaleBy:function(t){return new b(this.x/t.x,this.y/t.y)},round:function(){return this.clone()._round()},_round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this},floor:function(){return this.clone()._floor()},_floor:function(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this},ceil:function(){return this.clone()._ceil()},_ceil:function(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this},trunc:function(){return this.clone()._trunc()},_trunc:function(){return this.x=le(this.x),this.y=le(this.y),this},distanceTo:function(t){t=C(t);var e=t.x-this.x,i=t.y-this.y;return Math.sqrt(e*e+i*i)},equals:function(t){return t=C(t),t.x===this.x&&t.y===this.y},contains:function(t){return t=C(t),Math.abs(t.x)<=Math.abs(this.x)&&Math.abs(t.y)<=Math.abs(this.y)},toString:function(){return"Point("+l(this.x)+", "+l(this.y)+")"}},x.prototype={extend:function(t){return t=C(t),this.min||this.max?(this.min.x=Math.min(t.x,this.min.x),this.max.x=Math.max(t.x,this.max.x),this.min.y=Math.min(t.y,this.min.y),this.max.y=Math.max(t.y,this.max.y)):(this.min=t.clone(),this.max=t.clone()),this},getCenter:function(t){return new b((this.min.x+this.max.x)/2,(this.min.y+this.max.y)/2,t)},getBottomLeft:function(){return new b(this.min.x,this.max.y)},getTopRight:function(){return new b(this.max.x,this.min.y)},getTopLeft:function(){return this.min},getBottomRight:function(){return this.max},getSize:function(){return this.max.subtract(this.min)},contains:function(t){var e,i;return t="number"==typeof t[0]||t instanceof b?C(t):P(t),t instanceof x?(e=t.min,i=t.max):e=i=t,e.x>=this.min.x&&i.x<=this.max.x&&e.y>=this.min.y&&i.y<=this.max.y},intersects:function(t){t=P(t);var e=this.min,i=this.max,n=t.min,r=t.max,a=r.x>=e.x&&n.x<=i.x,o=r.y>=e.y&&n.y<=i.y;return a&&o},overlaps:function(t){t=P(t);var e=this.min,i=this.max,n=t.min,r=t.max,a=r.x>e.x&&n.x<i.x,o=r.y>e.y&&n.y<i.y;return a&&o},isValid:function(){return!(!this.min||!this.max)}},M.prototype={extend:function(t){var e,i,n=this._southWest,r=this._northEast;if(t instanceof S)e=t,i=t;else{if(!(t instanceof M))return t?this.extend(O(t)||E(t)):this;if(e=t._southWest,i=t._northEast,!e||!i)return this}return n||r?(n.lat=Math.min(e.lat,n.lat),n.lng=Math.min(e.lng,n.lng),r.lat=Math.max(i.lat,r.lat),r.lng=Math.max(i.lng,r.lng)):(this._southWest=new S(e.lat,e.lng),this._northEast=new S(i.lat,i.lng)),this},pad:function(t){var e=this._southWest,i=this._northEast,n=Math.abs(e.lat-i.lat)*t,r=Math.abs(e.lng-i.lng)*t;return new M(new S(e.lat-n,e.lng-r),new S(i.lat+n,i.lng+r))},getCenter:function(){return new S((this._southWest.lat+this._northEast.lat)/2,(this._southWest.lng+this._northEast.lng)/2)},getSouthWest:function(){return this._southWest},getNorthEast:function(){return this._northEast},getNorthWest:function(){return new S(this.getNorth(),this.getWest())},getSouthEast:function(){return new S(this.getSouth(),this.getEast())},getWest:function(){return this._southWest.lng},getSouth:function(){return this._southWest.lat},getEast:function(){return this._northEast.lng},getNorth:function(){return this._northEast.lat},contains:function(t){t="number"==typeof t[0]||t instanceof S||"lat"in t?O(t):E(t);var e,i,n=this._southWest,r=this._northEast;return t instanceof M?(e=t.getSouthWest(),i=t.getNorthEast()):e=i=t,e.lat>=n.lat&&i.lat<=r.lat&&e.lng>=n.lng&&i.lng<=r.lng},intersects:function(t){t=E(t);var e=this._southWest,i=this._northEast,n=t.getSouthWest(),r=t.getNorthEast(),a=r.lat>=e.lat&&n.lat<=i.lat,o=r.lng>=e.lng&&n.lng<=i.lng;return a&&o},overlaps:function(t){t=E(t);var e=this._southWest,i=this._northEast,n=t.getSouthWest(),r=t.getNorthEast(),a=r.lat>e.lat&&n.lat<i.lat,o=r.lng>e.lng&&n.lng<i.lng;return a&&o},toBBoxString:function(){return[this.getWest(),this.getSouth(),this.getEast(),this.getNorth()].join(",")},equals:function(t,e){return!!t&&(t=E(t),this._southWest.equals(t.getSouthWest(),e)&&this._northEast.equals(t.getNorthEast(),e))},isValid:function(){return!(!this._southWest||!this._northEast)}},S.prototype={equals:function(t,e){return!!t&&(t=O(t),Math.max(Math.abs(this.lat-t.lat),Math.abs(this.lng-t.lng))<=(void 0===e?1e-9:e))},toString:function(t){return"LatLng("+l(this.lat,t)+", "+l(this.lng,t)+")"},distanceTo:function(t){return ce.distance(this,O(t))},wrap:function(){return ce.wrapLatLng(this)},toBounds:function(t){var e=180*t/40075017,i=e/Math.cos(Math.PI/180*this.lat);return E([this.lat-e,this.lng-i],[this.lat+e,this.lng+i])},clone:function(){return new S(this.lat,this.lng,this.alt)}};var ue={latLngToPoint:function(t,e){var i=this.projection.project(t),n=this.scale(e);return this.transformation._transform(i,n)},pointToLatLng:function(t,e){var i=this.scale(e),n=this.transformation.untransform(t,i);return this.projection.unproject(n)},project:function(t){return this.projection.project(t)},unproject:function(t){return this.projection.unproject(t)},scale:function(t){return 256*Math.pow(2,t)},zoom:function(t){return Math.log(t/256)/Math.LN2},getProjectedBounds:function(t){if(this.infinite)return null;var e=this.projection.bounds,i=this.scale(t);return new x(this.transformation.transform(e.min,i),this.transformation.transform(e.max,i))},infinite:!1,wrapLatLng:function(t){var e=this.wrapLng?a(t.lng,this.wrapLng,!0):t.lng;return new S(this.wrapLat?a(t.lat,this.wrapLat,!0):t.lat,e,t.alt)},wrapLatLngBounds:function(t){var e=t.getCenter(),i=this.wrapLatLng(e),n=e.lat-i.lat,r=e.lng-i.lng;if(0===n&&0===r)return t;var a=t.getSouthWest(),o=t.getNorthEast();return new M(new S(a.lat-n,a.lng-r),new S(o.lat-n,o.lng-r))}},ce=e({},ue,{wrapLng:[-180,180],R:6371e3,distance:function(t,e){var i=Math.PI/180,n=t.lat*i,r=e.lat*i,a=Math.sin((e.lat-t.lat)*i/2),o=Math.sin((e.lng-t.lng)*i/2),s=a*a+Math.cos(n)*Math.cos(r)*o*o,l=2*Math.atan2(Math.sqrt(s),Math.sqrt(1-s));return this.R*l}}),de={R:6378137,MAX_LATITUDE:85.0511287798,project:function(t){var e=Math.PI/180,i=this.MAX_LATITUDE,n=Math.max(Math.min(i,t.lat),-i),r=Math.sin(n*e);return new b(this.R*t.lng*e,this.R*Math.log((1+r)/(1-r))/2)},unproject:function(t){var e=180/Math.PI;return new S((2*Math.atan(Math.exp(t.y/this.R))-Math.PI/2)*e,t.x*e/this.R)},bounds:function(){var t=6378137*Math.PI;return new x([-t,-t],[t,t])}()};T.prototype={transform:function(t,e){return this._transform(t.clone(),e)},_transform:function(t,e){return e=e||1,t.x=e*(this._a*t.x+this._b),t.y=e*(this._c*t.y+this._d),t},untransform:function(t,e){return e=e||1,new b((t.x/e-this._b)/this._a,(t.y/e-this._d)/this._c)}};var he,fe,pe,ge=e({},ce,{code:"EPSG:3857",projection:de,transformation:function(){var t=.5/(Math.PI*de.R);return D(t,.5,-t,.5)}()}),me=e({},ge,{code:"EPSG:900913"}),ye=document.documentElement.style,ve="ActiveXObject"in window,_e=ve&&!document.addEventListener,we="msLaunchUri"in navigator&&!("documentMode"in document),be=k("webkit"),Ce=k("android"),xe=k("android 2")||k("android 3"),Pe=parseInt(/WebKit\/([0-9]+)|$/.exec(navigator.userAgent)[1],10),Me=Ce&&k("Google")&&Pe<537&&!("AudioNode"in window),Ee=!!window.opera,Le=k("chrome"),Se=k("gecko")&&!be&&!Ee&&!ve,Oe=!Le&&k("safari"),Te=k("phantom"),De="OTransition"in ye,ke=0===navigator.platform.indexOf("Win"),Ae=ve&&"transition"in ye,Re="WebKitCSSMatrix"in window&&"m11"in new window.WebKitCSSMatrix&&!xe,Ne="MozPerspective"in ye,Fe=!window.L_DISABLE_3D&&(Ae||Re||Ne)&&!De&&!Te,Ie="undefined"!=typeof orientation||k("mobile"),je=Ie&&be,He=Ie&&Re,Ge=!window.PointerEvent&&window.MSPointerEvent,Be=!(!window.PointerEvent&&!Ge),Ve=!window.L_NO_TOUCH&&(Be||"ontouchstart"in window||window.DocumentTouch&&document instanceof window.DocumentTouch),ze=Ie&&Ee,Ue=Ie&&Se,We=(window.devicePixelRatio||window.screen.deviceXDPI/window.screen.logicalXDPI)>1,qe=function(){return!!document.createElement("canvas").getContext}(),Ze=!(!document.createElementNS||!function(t){return document.createElementNS("http://www.w3.org/2000/svg",t)}("svg").createSVGRect),Je=!Ze&&function(){try{var t=document.createElement("div");t.innerHTML='<v:shape adj="1"/>';var e=t.firstChild;return e.style.behavior="url(#default#VML)",e&&"object"===o(e.adj)}catch(t){return!1}}(),Ye=(Object.freeze||Object)({ie:ve,ielt9:_e,edge:we,webkit:be,android:Ce,android23:xe,androidStock:Me,opera:Ee,chrome:Le,gecko:Se,safari:Oe,phantom:Te,opera12:De,win:ke,ie3d:Ae,webkit3d:Re,gecko3d:Ne,any3d:Fe,mobile:Ie,mobileWebkit:je,mobileWebkit3d:He,msPointer:Ge,pointer:Be,touch:Ve,mobileOpera:ze,mobileGecko:Ue,retina:We,canvas:qe,svg:Ze,vml:Je}),Xe=Ge?"MSPointerDown":"pointerdown",Qe=Ge?"MSPointerMove":"pointermove",Ke=Ge?"MSPointerUp":"pointerup",$e=Ge?"MSPointerCancel":"pointercancel",ti=["INPUT","SELECT","OPTION"],ei={},ii=!1,ni=0,ri=Ge?"MSPointerDown":Be?"pointerdown":"touchstart",ai=Ge?"MSPointerUp":Be?"pointerup":"touchend",oi="_leaflet_",si=rt(["transform","webkitTransform","OTransform","MozTransform","msTransform"]),li=rt(["webkitTransition","transition","OTransition","MozTransition","msTransition"]),ui="webkitTransition"===li||"OTransition"===li?li+"End":"transitionend";if("onselectstart"in document)he=function(){pt(window,"selectstart",bt)},fe=function(){gt(window,"selectstart",bt)};else{var ci=rt(["userSelect","WebkitUserSelect","OUserSelect","MozUserSelect","msUserSelect"]);he=function(){if(ci){var t=document.documentElement.style;pe=t[ci],t[ci]="none"}},fe=function(){ci&&(document.documentElement.style[ci]=pe,pe=void 0)}}var di,hi,fi,pi=(Object.freeze||Object)({TRANSFORM:si,TRANSITION:li,TRANSITION_END:ui,get:U,getStyle:W,create:q,remove:Z,empty:J,toFront:Y,toBack:X,hasClass:Q,addClass:K,removeClass:$,setClass:tt,getClass:et,setOpacity:it,testProp:rt,setTransform:at,setPosition:ot,getPosition:st,disableTextSelection:he,enableTextSelection:fe,disableImageDrag:lt,enableImageDrag:ut,preventOutline:ct,restoreOutline:dt,getSizedParentNode:ht,getScale:ft}),gi="_leaflet_events",mi=ke&&Le?2*window.devicePixelRatio:Se?window.devicePixelRatio:1,yi={},vi=(Object.freeze||Object)({on:pt,off:gt,stopPropagation:vt,disableScrollPropagation:_t,disableClickPropagation:wt,preventDefault:bt,stop:Ct,getMousePosition:xt,getWheelDelta:Pt,fakeStop:Mt,skipped:Et,isExternalTarget:Lt,addListener:pt,removeListener:gt}),_i=se.extend({run:function(t,e,i,n){this.stop(),this._el=t,this._inProgress=!0,this._duration=i||.25,this._easeOutPower=1/Math.max(n||.5,.2),this._startPos=st(t),this._offset=e.subtract(this._startPos),this._startTime=+new Date,this.fire("start"),this._animate()},stop:function(){this._inProgress&&(this._step(!0),this._complete())},_animate:function(){this._animId=y(this._animate,this),this._step()},_step:function(t){var e=+new Date-this._startTime,i=1e3*this._duration;e<i?this._runFrame(this._easeOut(e/i),t):(this._runFrame(1),this._complete())},_runFrame:function(t,e){var i=this._startPos.add(this._offset.multiplyBy(t));e&&i._round(),ot(this._el,i),this.fire("step")},_complete:function(){v(this._animId),this._inProgress=!1,this.fire("end")},_easeOut:function(t){return 1-Math.pow(1-t,this._easeOutPower)}}),wi=_.extend({initialize:function(t){this._map=t},enable:function(){return this._enabled?this:(this._enabled=!0,this.addHooks(),this)},disable:function(){return this._enabled?(this._enabled=!1,this.removeHooks(),this):this},enabled:function(){return!!this._enabled}});wi.addTo=function(t,e){return t.addHandler(e,this),this};var bi,Ci={Events:oe},xi=Ve?"touchstart mousedown":"mousedown",Pi={mousedown:"mouseup",touchstart:"touchend",pointerdown:"touchend",MSPointerDown:"touchend"},Mi={mousedown:"mousemove",touchstart:"touchmove",pointerdown:"touchmove",MSPointerDown:"touchmove"},Ei=se.extend({options:{clickTolerance:3},initialize:function(t,e,i,n){d(this,n),this._element=t,this._dragStartTarget=e||t,this._preventOutline=i},enable:function(){this._enabled||(pt(this._dragStartTarget,xi,this._onDown,this),this._enabled=!0)},disable:function(){this._enabled&&(Ei._dragging===this&&this.finishDrag(),gt(this._dragStartTarget,xi,this._onDown,this),this._enabled=!1,this._moved=!1)},_onDown:function(t){if(!t._simulated&&this._enabled&&(this._moved=!1,!Q(this._element,"leaflet-zoom-anim")&&!(Ei._dragging||t.shiftKey||1!==t.which&&1!==t.button&&!t.touches||(Ei._dragging=this,this._preventOutline&&ct(this._element),lt(),he(),this._moving)))){this.fire("down");var e=t.touches?t.touches[0]:t,i=ht(this._element);this._startPoint=new b(e.clientX,e.clientY),this._parentScale=ft(i),pt(document,Mi[t.type],this._onMove,this),pt(document,Pi[t.type],this._onUp,this)}},_onMove:function(t){if(!t._simulated&&this._enabled){if(t.touches&&t.touches.length>1)return void(this._moved=!0);var e=t.touches&&1===t.touches.length?t.touches[0]:t,i=new b(e.clientX,e.clientY)._subtract(this._startPoint);(i.x||i.y)&&(Math.abs(i.x)+Math.abs(i.y)<this.options.clickTolerance||(i.x/=this._parentScale.x,i.y/=this._parentScale.y,bt(t),this._moved||(this.fire("dragstart"),this._moved=!0,this._startPos=st(this._element).subtract(i),K(document.body,"leaflet-dragging"),this._lastTarget=t.target||t.srcElement,window.SVGElementInstance&&this._lastTarget instanceof SVGElementInstance&&(this._lastTarget=this._lastTarget.correspondingUseElement),K(this._lastTarget,"leaflet-drag-target")),this._newPos=this._startPos.add(i),this._moving=!0,v(this._animRequest),this._lastEvent=t,this._animRequest=y(this._updatePosition,this,!0)))}},_updatePosition:function(){var t={originalEvent:this._lastEvent};this.fire("predrag",t),ot(this._element,this._newPos),this.fire("drag",t)},_onUp:function(t){!t._simulated&&this._enabled&&this.finishDrag()},finishDrag:function(){$(document.body,"leaflet-dragging"),this._lastTarget&&($(this._lastTarget,"leaflet-drag-target"),this._lastTarget=null);for(var t in Mi)gt(document,Mi[t],this._onMove,this),gt(document,Pi[t],this._onUp,this);ut(),fe(),this._moved&&this._moving&&(v(this._animRequest),this.fire("dragend",{distance:this._newPos.distanceTo(this._startPos)})),this._moving=!1,Ei._dragging=!1}}),Li=(Object.freeze||Object)({simplify:Ot,pointToSegmentDistance:Tt,closestPointOnSegment:Dt,clipSegment:Nt,_getEdgeIntersection:Ft,_getBitCode:It,_sqClosestPointOnSegment:Ht,isFlat:Gt,_flat:Bt}),Si=(Object.freeze||Object)({clipPolygon:Vt}),Oi={project:function(t){return new b(t.lng,t.lat)},unproject:function(t){return new S(t.y,t.x)},bounds:new x([-180,-90],[180,90])},Ti={R:6378137,R_MINOR:6356752.314245179,bounds:new x([-20037508.34279,-15496570.73972],[20037508.34279,18764656.23138]),project:function(t){var e=Math.PI/180,i=this.R,n=t.lat*e,r=this.R_MINOR/i,a=Math.sqrt(1-r*r),o=a*Math.sin(n),s=Math.tan(Math.PI/4-n/2)/Math.pow((1-o)/(1+o),a/2);return n=-i*Math.log(Math.max(s,1e-10)),new b(t.lng*e*i,n)},unproject:function(t){for(var e,i=180/Math.PI,n=this.R,r=this.R_MINOR/n,a=Math.sqrt(1-r*r),o=Math.exp(-t.y/n),s=Math.PI/2-2*Math.atan(o),l=0,u=.1;l<15&&Math.abs(u)>1e-7;l++)e=a*Math.sin(s),e=Math.pow((1-e)/(1+e),a/2),u=Math.PI/2-2*Math.atan(o*e)-s,s+=u;return new S(s*i,t.x*i/n)}},Di=(Object.freeze||Object)({LonLat:Oi,Mercator:Ti,SphericalMercator:de}),ki=e({},ce,{code:"EPSG:3395",projection:Ti,transformation:function(){var t=.5/(Math.PI*Ti.R);return D(t,.5,-t,.5)}()}),Ai=e({},ce,{code:"EPSG:4326",projection:Oi,transformation:D(1/180,1,-1/180,.5)}),Ri=e({},ue,{projection:Oi,transformation:D(1,0,-1,0),scale:function(t){return Math.pow(2,t)},zoom:function(t){return Math.log(t)/Math.LN2},distance:function(t,e){var i=e.lng-t.lng,n=e.lat-t.lat;return Math.sqrt(i*i+n*n)},infinite:!0});ue.Earth=ce,ue.EPSG3395=ki,ue.EPSG3857=ge,ue.EPSG900913=me,ue.EPSG4326=Ai,ue.Simple=Ri;var Ni=se.extend({options:{pane:"overlayPane",attribution:null,bubblingMouseEvents:!0},addTo:function(t){return t.addLayer(this),this},remove:function(){return this.removeFrom(this._map||this._mapToAdd)},removeFrom:function(t){return t&&t.removeLayer(this),this},getPane:function(t){return this._map.getPane(t?this.options[t]||t:this.options.pane)},addInteractiveTarget:function(t){return this._map._targets[n(t)]=this,this},removeInteractiveTarget:function(t){return delete this._map._targets[n(t)],this},getAttribution:function(){return this.options.attribution},_layerAdd:function(t){var e=t.target;if(e.hasLayer(this)){if(this._map=e,this._zoomAnimated=e._zoomAnimated,this.getEvents){var i=this.getEvents();e.on(i,this),this.once("remove",function(){e.off(i,this)},this)}this.onAdd(e),this.getAttribution&&e.attributionControl&&e.attributionControl.addAttribution(this.getAttribution()),this.fire("add"),e.fire("layeradd",{layer:this})}}}),Fi=Ni.extend({initialize:function(t,e){d(this,e),this._layers={};var i,n;if(t)for(i=0,n=t.length;i<n;i++)this.addLayer(t[i])},addLayer:function(t){var e=this.getLayerId(t);return this._layers[e]=t,this._map&&this._map.addLayer(t),this},removeLayer:function(t){var e=t in this._layers?t:this.getLayerId(t);return this._map&&this._layers[e]&&this._map.removeLayer(this._layers[e]),delete this._layers[e],this},hasLayer:function(t){return!!t&&(t in this._layers||this.getLayerId(t)in this._layers)},clearLayers:function(){return this.eachLayer(this.removeLayer,this)},invoke:function(t){var e,i,n=Array.prototype.slice.call(arguments,1);for(e in this._layers)i=this._layers[e],i[t]&&i[t].apply(i,n);return this},onAdd:function(t){this.eachLayer(t.addLayer,t)},onRemove:function(t){this.eachLayer(t.removeLayer,t)},eachLayer:function(t,e){for(var i in this._layers)t.call(e,this._layers[i]);return this},getLayer:function(t){return this._layers[t]},getLayers:function(){var t=[];return this.eachLayer(t.push,t),t},setZIndex:function(t){return this.invoke("setZIndex",t)},getLayerId:function(t){return n(t)}}),Ii=Fi.extend({addLayer:function(t){return this.hasLayer(t)?this:(t.addEventParent(this),Fi.prototype.addLayer.call(this,t),this.fire("layeradd",{layer:t}))},removeLayer:function(t){return this.hasLayer(t)?(t in this._layers&&(t=this._layers[t]),t.removeEventParent(this),Fi.prototype.removeLayer.call(this,t),this.fire("layerremove",{layer:t})):this},setStyle:function(t){return this.invoke("setStyle",t)},bringToFront:function(){return this.invoke("bringToFront")},bringToBack:function(){return this.invoke("bringToBack")},getBounds:function(){var t=new M;for(var e in this._layers){var i=this._layers[e];t.extend(i.getBounds?i.getBounds():i.getLatLng())}return t}}),ji=_.extend({options:{popupAnchor:[0,0],tooltipAnchor:[0,0]},initialize:function(t){d(this,t)},createIcon:function(t){return this._createIcon("icon",t)},createShadow:function(t){return this._createIcon("shadow",t)},_createIcon:function(t,e){var i=this._getIconUrl(t);if(!i){if("icon"===t)throw new Error("iconUrl not set in Icon options (see the docs).");return null}var n=this._createImg(i,e&&"IMG"===e.tagName?e:null);return this._setIconStyles(n,t),n},_setIconStyles:function(t,e){var i=this.options,n=i[e+"Size"];"number"==typeof n&&(n=[n,n]);var r=C(n),a=C("shadow"===e&&i.shadowAnchor||i.iconAnchor||r&&r.divideBy(2,!0));t.className="leaflet-marker-"+e+" "+(i.className||""),a&&(t.style.marginLeft=-a.x+"px",t.style.marginTop=-a.y+"px"),r&&(t.style.width=r.x+"px",t.style.height=r.y+"px")},_createImg:function(t,e){return e=e||document.createElement("img"),e.src=t,e},_getIconUrl:function(t){return We&&this.options[t+"RetinaUrl"]||this.options[t+"Url"]}}),Hi=ji.extend({options:{iconUrl:"marker-icon.png",iconRetinaUrl:"marker-icon-2x.png",shadowUrl:"marker-shadow.png",iconSize:[25,41],iconAnchor:[12,41],popupAnchor:[1,-34],tooltipAnchor:[16,-28],shadowSize:[41,41]},_getIconUrl:function(t){return Hi.imagePath||(Hi.imagePath=this._detectIconPath()),(this.options.imagePath||Hi.imagePath)+ji.prototype._getIconUrl.call(this,t)},_detectIconPath:function(){var t=q("div","leaflet-default-icon-path",document.body),e=W(t,"background-image")||W(t,"backgroundImage");return document.body.removeChild(t),e=null===e||0!==e.indexOf("url")?"":e.replace(/^url\(["']?/,"").replace(/marker-icon\.png["']?\)$/,"")}}),Gi=wi.extend({initialize:function(t){this._marker=t},addHooks:function(){var t=this._marker._icon;this._draggable||(this._draggable=new Ei(t,t,!0)),this._draggable.on({dragstart:this._onDragStart,predrag:this._onPreDrag,drag:this._onDrag,dragend:this._onDragEnd},this).enable(),K(t,"leaflet-marker-draggable")},removeHooks:function(){this._draggable.off({dragstart:this._onDragStart,predrag:this._onPreDrag,drag:this._onDrag,dragend:this._onDragEnd},this).disable(),this._marker._icon&&$(this._marker._icon,"leaflet-marker-draggable")},moved:function(){return this._draggable&&this._draggable._moved},_adjustPan:function(t){var e=this._marker,i=e._map,n=this._marker.options.autoPanSpeed,r=this._marker.options.autoPanPadding,a=st(e._icon),o=i.getPixelBounds(),s=i.getPixelOrigin(),l=P(o.min._subtract(s).add(r),o.max._subtract(s).subtract(r));if(!l.contains(a)){var u=C((Math.max(l.max.x,a.x)-l.max.x)/(o.max.x-l.max.x)-(Math.min(l.min.x,a.x)-l.min.x)/(o.min.x-l.min.x),(Math.max(l.max.y,a.y)-l.max.y)/(o.max.y-l.max.y)-(Math.min(l.min.y,a.y)-l.min.y)/(o.min.y-l.min.y)).multiplyBy(n);i.panBy(u,{animate:!1}),this._draggable._newPos._add(u),this._draggable._startPos._add(u),ot(e._icon,this._draggable._newPos),this._onDrag(t),this._panRequest=y(this._adjustPan.bind(this,t))}},_onDragStart:function(){this._oldLatLng=this._marker.getLatLng(),this._marker.closePopup().fire("movestart").fire("dragstart")},_onPreDrag:function(t){this._marker.options.autoPan&&(v(this._panRequest),this._panRequest=y(this._adjustPan.bind(this,t)))},_onDrag:function(t){var e=this._marker,i=e._shadow,n=st(e._icon),r=e._map.layerPointToLatLng(n);i&&ot(i,n),e._latlng=r,t.latlng=r,t.oldLatLng=this._oldLatLng,e.fire("move",t).fire("drag",t)},_onDragEnd:function(t){v(this._panRequest),delete this._oldLatLng,this._marker.fire("moveend").fire("dragend",t)}}),Bi=Ni.extend({options:{icon:new Hi,interactive:!0,keyboard:!0,title:"",alt:"",zIndexOffset:0,opacity:1,riseOnHover:!1,riseOffset:250,pane:"markerPane",bubblingMouseEvents:!1,draggable:!1,autoPan:!1,autoPanPadding:[50,50],autoPanSpeed:10},initialize:function(t,e){d(this,e),this._latlng=O(t)},onAdd:function(t){this._zoomAnimated=this._zoomAnimated&&t.options.markerZoomAnimation,this._zoomAnimated&&t.on("zoomanim",this._animateZoom,this),this._initIcon(),this.update()},onRemove:function(t){this.dragging&&this.dragging.enabled()&&(this.options.draggable=!0,this.dragging.removeHooks()),delete this.dragging,this._zoomAnimated&&t.off("zoomanim",this._animateZoom,this),this._removeIcon(),this._removeShadow()},getEvents:function(){return{zoom:this.update,viewreset:this.update}},getLatLng:function(){return this._latlng},setLatLng:function(t){var e=this._latlng;return this._latlng=O(t),this.update(),this.fire("move",{oldLatLng:e,latlng:this._latlng})},setZIndexOffset:function(t){return this.options.zIndexOffset=t,this.update()},setIcon:function(t){return this.options.icon=t,this._map&&(this._initIcon(),this.update()),this._popup&&this.bindPopup(this._popup,this._popup.options),this},getElement:function(){return this._icon},update:function(){if(this._icon&&this._map){var t=this._map.latLngToLayerPoint(this._latlng).round();this._setPos(t)}return this},_initIcon:function(){var t=this.options,e="leaflet-zoom-"+(this._zoomAnimated?"animated":"hide"),i=t.icon.createIcon(this._icon),n=!1;i!==this._icon&&(this._icon&&this._removeIcon(),n=!0,t.title&&(i.title=t.title),"IMG"===i.tagName&&(i.alt=t.alt||"")),K(i,e),t.keyboard&&(i.tabIndex="0"),this._icon=i,t.riseOnHover&&this.on({mouseover:this._bringToFront,mouseout:this._resetZIndex});var r=t.icon.createShadow(this._shadow),a=!1;r!==this._shadow&&(this._removeShadow(),a=!0),r&&(K(r,e),r.alt=""),this._shadow=r,t.opacity<1&&this._updateOpacity(),n&&this.getPane().appendChild(this._icon),this._initInteraction(),r&&a&&this.getPane("shadowPane").appendChild(this._shadow)},_removeIcon:function(){this.options.riseOnHover&&this.off({mouseover:this._bringToFront,mouseout:this._resetZIndex}),Z(this._icon),this.removeInteractiveTarget(this._icon),this._icon=null},_removeShadow:function(){this._shadow&&Z(this._shadow),this._shadow=null},_setPos:function(t){ot(this._icon,t),this._shadow&&ot(this._shadow,t),this._zIndex=t.y+this.options.zIndexOffset,this._resetZIndex()},_updateZIndex:function(t){this._icon.style.zIndex=this._zIndex+t},_animateZoom:function(t){var e=this._map._latLngToNewLayerPoint(this._latlng,t.zoom,t.center).round();this._setPos(e)},_initInteraction:function(){if(this.options.interactive&&(K(this._icon,"leaflet-interactive"),this.addInteractiveTarget(this._icon),Gi)){var t=this.options.draggable;this.dragging&&(t=this.dragging.enabled(),this.dragging.disable()),this.dragging=new Gi(this),t&&this.dragging.enable()}},setOpacity:function(t){return this.options.opacity=t,this._map&&this._updateOpacity(),this},_updateOpacity:function(){var t=this.options.opacity;it(this._icon,t),this._shadow&&it(this._shadow,t)},_bringToFront:function(){this._updateZIndex(this.options.riseOffset)},_resetZIndex:function(){this._updateZIndex(0)},_getPopupAnchor:function(){return this.options.icon.options.popupAnchor},_getTooltipAnchor:function(){return this.options.icon.options.tooltipAnchor}}),Vi=Ni.extend({options:{stroke:!0,color:"#3388ff",weight:3,opacity:1,lineCap:"round",lineJoin:"round",dashArray:null,dashOffset:null,fill:!1,fillColor:null,fillOpacity:.2,fillRule:"evenodd",interactive:!0,bubblingMouseEvents:!0},beforeAdd:function(t){this._renderer=t.getRenderer(this)},onAdd:function(){this._renderer._initPath(this),this._reset(),this._renderer._addPath(this)},onRemove:function(){this._renderer._removePath(this)},redraw:function(){return this._map&&this._renderer._updatePath(this),this},setStyle:function(t){return d(this,t),this._renderer&&this._renderer._updateStyle(this),this},bringToFront:function(){return this._renderer&&this._renderer._bringToFront(this),this},bringToBack:function(){return this._renderer&&this._renderer._bringToBack(this),this},getElement:function(){return this._path},_reset:function(){this._project(),this._update()},_clickTolerance:function(){return(this.options.stroke?this.options.weight/2:0)+this._renderer.options.tolerance}}),zi=Vi.extend({options:{fill:!0,radius:10},initialize:function(t,e){d(this,e),this._latlng=O(t),this._radius=this.options.radius},setLatLng:function(t){return this._latlng=O(t),this.redraw(),this.fire("move",{latlng:this._latlng})},getLatLng:function(){return this._latlng},setRadius:function(t){return this.options.radius=this._radius=t,this.redraw()},getRadius:function(){return this._radius},setStyle:function(t){var e=t&&t.radius||this._radius;return Vi.prototype.setStyle.call(this,t),this.setRadius(e),this},_project:function(){this._point=this._map.latLngToLayerPoint(this._latlng),this._updateBounds()},_updateBounds:function(){var t=this._radius,e=this._radiusY||t,i=this._clickTolerance(),n=[t+i,e+i];this._pxBounds=new x(this._point.subtract(n),this._point.add(n))},_update:function(){this._map&&this._updatePath()},_updatePath:function(){this._renderer._updateCircle(this)},_empty:function(){return this._radius&&!this._renderer._bounds.intersects(this._pxBounds)},_containsPoint:function(t){return t.distanceTo(this._point)<=this._radius+this._clickTolerance()}}),Ui=zi.extend({initialize:function(t,i,n){if("number"==typeof i&&(i=e({},n,{radius:i})),d(this,i),this._latlng=O(t),isNaN(this.options.radius))throw new Error("Circle radius cannot be NaN");this._mRadius=this.options.radius},setRadius:function(t){return this._mRadius=t,this.redraw()},getRadius:function(){return this._mRadius},getBounds:function(){var t=[this._radius,this._radiusY||this._radius];return new M(this._map.layerPointToLatLng(this._point.subtract(t)),this._map.layerPointToLatLng(this._point.add(t)))},setStyle:Vi.prototype.setStyle,_project:function(){var t=this._latlng.lng,e=this._latlng.lat,i=this._map,n=i.options.crs;if(n.distance===ce.distance){var r=Math.PI/180,a=this._mRadius/ce.R/r,o=i.project([e+a,t]),s=i.project([e-a,t]),l=o.add(s).divideBy(2),u=i.unproject(l).lat,c=Math.acos((Math.cos(a*r)-Math.sin(e*r)*Math.sin(u*r))/(Math.cos(e*r)*Math.cos(u*r)))/r;(isNaN(c)||0===c)&&(c=a/Math.cos(Math.PI/180*e)),this._point=l.subtract(i.getPixelOrigin()),this._radius=isNaN(c)?0:l.x-i.project([u,t-c]).x,this._radiusY=l.y-o.y}else{var d=n.unproject(n.project(this._latlng).subtract([this._mRadius,0]));this._point=i.latLngToLayerPoint(this._latlng),this._radius=this._point.x-i.latLngToLayerPoint(d).x}this._updateBounds()}}),Wi=Vi.extend({options:{smoothFactor:1,noClip:!1},initialize:function(t,e){d(this,e),this._setLatLngs(t)},getLatLngs:function(){return this._latlngs},setLatLngs:function(t){return this._setLatLngs(t),this.redraw()},isEmpty:function(){return!this._latlngs.length},closestLayerPoint:function(t){for(var e,i,n=1/0,r=null,a=Ht,o=0,s=this._parts.length;o<s;o++)for(var l=this._parts[o],u=1,c=l.length;u<c;u++){e=l[u-1],i=l[u];var d=a(t,e,i,!0);d<n&&(n=d,r=a(t,e,i))}return r&&(r.distance=Math.sqrt(n)),r},getCenter:function(){if(!this._map)throw new Error("Must add layer to map before using getCenter()");var t,e,i,n,r,a,o,s=this._rings[0],l=s.length;if(!l)return null;for(t=0,e=0;t<l-1;t++)e+=s[t].distanceTo(s[t+1])/2;if(0===e)return this._map.layerPointToLatLng(s[0]);for(t=0,n=0;t<l-1;t++)if(r=s[t],a=s[t+1],i=r.distanceTo(a),(n+=i)>e)return o=(n-e)/i,this._map.layerPointToLatLng([a.x-o*(a.x-r.x),a.y-o*(a.y-r.y)])},getBounds:function(){return this._bounds},addLatLng:function(t,e){return e=e||this._defaultShape(),t=O(t),e.push(t),this._bounds.extend(t),this.redraw()},_setLatLngs:function(t){this._bounds=new M,this._latlngs=this._convertLatLngs(t)},_defaultShape:function(){return Gt(this._latlngs)?this._latlngs:this._latlngs[0]},_convertLatLngs:function(t){for(var e=[],i=Gt(t),n=0,r=t.length;n<r;n++)i?(e[n]=O(t[n]),this._bounds.extend(e[n])):e[n]=this._convertLatLngs(t[n]);return e},_project:function(){var t=new x;this._rings=[],this._projectLatlngs(this._latlngs,this._rings,t);var e=this._clickTolerance(),i=new b(e,e);this._bounds.isValid()&&t.isValid()&&(t.min._subtract(i),t.max._add(i),this._pxBounds=t)},_projectLatlngs:function(t,e,i){var n,r,a=t[0]instanceof S,o=t.length;if(a){for(r=[],n=0;n<o;n++)r[n]=this._map.latLngToLayerPoint(t[n]),i.extend(r[n]);e.push(r)}else for(n=0;n<o;n++)this._projectLatlngs(t[n],e,i)},_clipPoints:function(){var t=this._renderer._bounds;if(this._parts=[],this._pxBounds&&this._pxBounds.intersects(t)){if(this.options.noClip)return void(this._parts=this._rings);var e,i,n,r,a,o,s,l=this._parts;for(e=0,n=0,r=this._rings.length;e<r;e++)for(s=this._rings[e],i=0,a=s.length;i<a-1;i++)(o=Nt(s[i],s[i+1],t,i,!0))&&(l[n]=l[n]||[],l[n].push(o[0]),o[1]===s[i+1]&&i!==a-2||(l[n].push(o[1]),n++))}},_simplifyPoints:function(){for(var t=this._parts,e=this.options.smoothFactor,i=0,n=t.length;i<n;i++)t[i]=Ot(t[i],e)},_update:function(){this._map&&(this._clipPoints(),this._simplifyPoints(),this._updatePath())},_updatePath:function(){this._renderer._updatePoly(this)},_containsPoint:function(t,e){var i,n,r,a,o,s,l=this._clickTolerance();if(!this._pxBounds||!this._pxBounds.contains(t))return!1;for(i=0,a=this._parts.length;i<a;i++)for(s=this._parts[i],n=0,o=s.length,r=o-1;n<o;r=n++)if((e||0!==n)&&Tt(t,s[r],s[n])<=l)return!0;return!1}});Wi._flat=Bt;var qi=Wi.extend({options:{fill:!0},isEmpty:function(){return!this._latlngs.length||!this._latlngs[0].length},getCenter:function(){if(!this._map)throw new Error("Must add layer to map before using getCenter()");var t,e,i,n,r,a,o,s,l,u=this._rings[0],c=u.length;if(!c)return null;for(a=o=s=0,t=0,e=c-1;t<c;e=t++)i=u[t],n=u[e],r=i.y*n.x-n.y*i.x,o+=(i.x+n.x)*r,s+=(i.y+n.y)*r,a+=3*r;return l=0===a?u[0]:[o/a,s/a],this._map.layerPointToLatLng(l)},_convertLatLngs:function(t){var e=Wi.prototype._convertLatLngs.call(this,t),i=e.length;return i>=2&&e[0]instanceof S&&e[0].equals(e[i-1])&&e.pop(),e},_setLatLngs:function(t){Wi.prototype._setLatLngs.call(this,t),Gt(this._latlngs)&&(this._latlngs=[this._latlngs])},_defaultShape:function(){return Gt(this._latlngs[0])?this._latlngs[0]:this._latlngs[0][0]},_clipPoints:function(){var t=this._renderer._bounds,e=this.options.weight,i=new b(e,e);if(t=new x(t.min.subtract(i),t.max.add(i)),this._parts=[],this._pxBounds&&this._pxBounds.intersects(t)){if(this.options.noClip)return void(this._parts=this._rings);for(var n,r=0,a=this._rings.length;r<a;r++)n=Vt(this._rings[r],t,!0),n.length&&this._parts.push(n)}},_updatePath:function(){this._renderer._updatePoly(this,!0)},_containsPoint:function(t){var e,i,n,r,a,o,s,l,u=!1;if(!this._pxBounds||!this._pxBounds.contains(t))return!1;for(r=0,s=this._parts.length;r<s;r++)for(e=this._parts[r],a=0,l=e.length,o=l-1;a<l;o=a++)i=e[a],n=e[o],i.y>t.y!=n.y>t.y&&t.x<(n.x-i.x)*(t.y-i.y)/(n.y-i.y)+i.x&&(u=!u);return u||Wi.prototype._containsPoint.call(this,t,!0)}}),Zi=Ii.extend({initialize:function(t,e){d(this,e),this._layers={},t&&this.addData(t)},addData:function(t){var e,i,n,r=ee(t)?t:t.features;if(r){for(e=0,i=r.length;e<i;e++)n=r[e],(n.geometries||n.geometry||n.features||n.coordinates)&&this.addData(n);return this}var a=this.options;if(a.filter&&!a.filter(t))return this;var o=zt(t,a);return o?(o.feature=Yt(t),o.defaultOptions=o.options,this.resetStyle(o),a.onEachFeature&&a.onEachFeature(t,o),this.addLayer(o)):this},resetStyle:function(t){return t.options=e({},t.defaultOptions),this._setLayerStyle(t,this.options.style),this},setStyle:function(t){return this.eachLayer(function(e){this._setLayerStyle(e,t)},this)},_setLayerStyle:function(t,e){"function"==typeof e&&(e=e(t.feature)),t.setStyle&&t.setStyle(e)}}),Ji={toGeoJSON:function(t){return Jt(this,{type:"Point",coordinates:qt(this.getLatLng(),t)})}};Bi.include(Ji),Ui.include(Ji),zi.include(Ji),Wi.include({toGeoJSON:function(t){var e=!Gt(this._latlngs),i=Zt(this._latlngs,e?1:0,!1,t);return Jt(this,{type:(e?"Multi":"")+"LineString",coordinates:i})}}),qi.include({toGeoJSON:function(t){var e=!Gt(this._latlngs),i=e&&!Gt(this._latlngs[0]),n=Zt(this._latlngs,i?2:e?1:0,!0,t);return e||(n=[n]),Jt(this,{type:(i?"Multi":"")+"Polygon",coordinates:n})}}),Fi.include({toMultiPoint:function(t){var e=[];return this.eachLayer(function(i){e.push(i.toGeoJSON(t).geometry.coordinates)}),Jt(this,{type:"MultiPoint",coordinates:e})},toGeoJSON:function(t){var e=this.feature&&this.feature.geometry&&this.feature.geometry.type;if("MultiPoint"===e)return this.toMultiPoint(t);var i="GeometryCollection"===e,n=[];return this.eachLayer(function(e){if(e.toGeoJSON){var r=e.toGeoJSON(t);if(i)n.push(r.geometry);else{var a=Yt(r);"FeatureCollection"===a.type?n.push.apply(n,a.features):n.push(a)}}}),i?Jt(this,{geometries:n,type:"GeometryCollection"}):{type:"FeatureCollection",features:n}}});var Yi=Xt;Object.freeze=Qt,t.version="1.3.4",t.Browser=Ye,t.Evented=se,t.Mixin=Ci,t.Util=ae,t.Class=_,t.Handler=wi,t.extend=e,t.bind=i,t.stamp=n,t.setOptions=d,t.DomEvent=vi,t.DomUtil=pi,t.PosAnimation=_i,t.Draggable=Ei,t.LineUtil=Li,t.PolyUtil=Si,t.Point=b,t.point=C,t.Bounds=x,t.bounds=P,t.Transformation=T,t.transformation=D,t.Projection=Di,t.LatLng=S,t.latLng=O,t.LatLngBounds=M,t.latLngBounds=E,t.CRS=ue,t.GeoJSON=Zi,t.geoJSON=Xt,t.geoJson=Yi,window.L||(window.L=t)})},function(t,e,i){"use strict";function n(t,e){t=t||{},null==e&&(e={scale:1,horizontalOrigin:l.default.HorizontalOrigin.CENTER,verticalOrigin:l.default.VerticalOrigin.BOTTOM});for(var i in t){var n=t[i];switch(i){default:e[i]=n;break;case"font_style":case"font_weight":case"font_size":case"font_family":case"scaleByDistance_near":case"scaleByDistance_nearValue":case"scaleByDistance_far":case"scaleByDistance_farValue":case"distanceDisplayCondition_far":case"distanceDisplayCondition_near":case"background_opacity":case"pixelOffsetY":break;case"text":e.text=n.replace(new RegExp("<br />","gm"),"\n");break;case"color":e.fillColor=new l.default.Color.fromCssColorString(n||"#ffffff").withAlpha(Number(t.opacity||1));break;case"border":e.style=n?l.default.LabelStyle.FILL_AND_OUTLINE:l.default.LabelStyle.FILL;break;case"border_color":e.outlineColor=new l.default.Color.fromCssColorString(n||"#000000").withAlpha(Number(t.opacity||1));break;case"border_width":e.outlineWidth=n;break;case"background":e.showBackground=n;break;case"background_color":e.backgroundColor=new l.default.Color.fromCssColorString(n||"#000000").withAlpha(Number(t.background_opacity||t.opacity||.5));break;case"pixelOffset":e.pixelOffset=new l.default.Cartesian2(t.pixelOffset[0],t.pixelOffset[1]);break;case"hasPixelOffset":n||(e.pixelOffset=new l.default.Cartesian2(0,0));break;case"pixelOffsetX":e.pixelOffset=new l.default.Cartesian2(n,t.pixelOffsetY);break;case"scaleByDistance":e.scaleByDistance=n?new l.default.NearFarScalar(Number(t.scaleByDistance_near||1e3),Number(t.scaleByDistance_nearValue||1),Number(t.scaleByDistance_far||1e6),Number(t.scaleByDistance_farValue||.1)):null;break;case"distanceDisplayCondition":e.distanceDisplayCondition=n?new l.default.DistanceDisplayCondition(Number(t.distanceDisplayCondition_near||0),Number(t.distanceDisplayCondition_far||1e5)):null;break;case"heightReference":switch(n){case"NONE":e.heightReference=l.default.HeightReference.NONE;break;case"CLAMP_TO_GROUND":e.heightReference=l.default.HeightReference.CLAMP_TO_GROUND;break;case"RELATIVE_TO_GROUND":e.heightReference=l.default.HeightReference.RELATIVE_TO_GROUND;break;default:e.heightReference=n}}}var r=(t.font_style||"normal")+" small-caps "+(t.font_weight||"normal")+" "+(t.font_size||"25")+"px "+(t.font_family||"楷体");return e.font=r,e}function r(t){return[t.position.getValue()]}function a(t){var e=r(t);return c.cartesians2lonlats(e)}function o(t){var e=a(t);return{type:"Feature",properties:t.attribute||{},geometry:{type:"Point",coordinates:e[0]}}}Object.defineProperty(e,"__esModule",{value:!0}),e.style2Entity=n,e.getPositions=r,e.getCoordinates=a,e.toGeoJSON=o;var s=i(0),l=function(t){return t&&t.__esModule?t:{default:t}}(s),u=i(2),c=function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e.default=t,e}(u)},function(t,e,i){"use strict";function n(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e.default=t,e}Object.defineProperty(e,"__esModule",{value:!0}),e.EditPolyline=void 0;var r=i(0),a=function(t){return t&&t.__esModule?t:{default:t}}(r),o=i(6),s=n(o),l=i(3),u=i(21),c=i(2),d=(n(c),i(1));e.EditPolyline=u.EditBase.extend({_positions_draw:[],getPosition:function(){return this._positions_draw},setPositions:function(t){this._positions_draw=t,this.updateAttrForEditing()},changePositionsToCallback:function(){this._positions_draw=this.entity._positions_draw||this.entity.polyline.positions.getValue()},finish:function(){this.entity._positions_draw=this.getPosition()},isClampToGround:function(){return this.entity.attribute.style.clampToGround},bindDraggers:function(){for(var t=this,e=this.isClampToGround(),i=this.getPosition(),n=i.length<this._maxPointNum,r=0,o=i.length;r<o;r++){var u=i[r];e&&(u=(0,d.updateHeightForClampToGround)(u),i[r]=u);var c=s.createDragger(this.dataSource,{position:u,onDrag:function(r,o){if(i[r.index]=o,n){if(r.index>0){var s=a.default.Cartesian3.midpoint(o,i[r.index-1],new a.default.Cartesian3);e&&(s=(0,d.updateHeightForClampToGround)(s)),t.draggers[2*r.index-1].position=s}if(r.index<i.length-1){var s=a.default.Cartesian3.midpoint(o,i[r.index+1],new a.default.Cartesian3);e&&(s=(0,d.updateHeightForClampToGround)(s)),t.draggers[2*r.index+1].position=s}}}});if(c.index=r,this.draggers.push(c),n){var h=r+1;if(h<o){var f=a.default.Cartesian3.midpoint(u,i[h],new a.default.Cartesian3);e&&(f=(0,d.updateHeightForClampToGround)(f));var c=s.createDragger(this.dataSource,{position:f,type:s.PointType.AddMidPoint,tooltip:l.message.dragger.addMidPoint,onDragStart:function(t,e){i.splice(t.index,0,e)},onDrag:function(t,e){i[t.index]=e},onDragEnd:function(e,i){t.updateDraggers()}});c.index=h,this.draggers.push(c)}}}}})},function(t,e,i){"use strict";function n(t,e){t=t||{},null==e&&(e={scale:1,horizontalOrigin:l.default.HorizontalOrigin.CENTER,verticalOrigin:l.default.VerticalOrigin.BOTTOM});for(var i in t){var n=t[i];switch(i){default:e[i]=n;break;case"scaleByDistance_near":case"scaleByDistance_nearValue":case"scaleByDistance_far":case"scaleByDistance_farValue":case"distanceDisplayCondition_far":case"distanceDisplayCondition_near":break;case"opacity":e.color=new l.default.Color.fromCssColorString("#FFFFFF").withAlpha(Number(n||1));break;case"rotation":e.rotation=l.default.Math.toRadians(n);break;case"scaleByDistance":e.scaleByDistance=n?new l.default.NearFarScalar(Number(t.scaleByDistance_near||1e3),Number(t.scaleByDistance_nearValue||1),Number(t.scaleByDistance_far||1e6),Number(t.scaleByDistance_farValue||.1)):null;break;case"distanceDisplayCondition":e.distanceDisplayCondition=n?new l.default.DistanceDisplayCondition(Number(t.distanceDisplayCondition_near||0),Number(t.distanceDisplayCondition_far||1e5)):null;break;case"heightReference":switch(n){case"NONE":e.heightReference=l.default.HeightReference.NONE;break;case"CLAMP_TO_GROUND":e.heightReference=l.default.HeightReference.CLAMP_TO_GROUND;break;case"RELATIVE_TO_GROUND":e.heightReference=l.default.HeightReference.RELATIVE_TO_GROUND;break;default:e.heightReference=n}}}return e}function r(t){return[t.position.getValue()]}function a(t){var e=r(t);return c.cartesians2lonlats(e)}function o(t){var e=a(t);return{type:"Feature",properties:t.attribute||{},geometry:{type:"Point",coordinates:e[0]}}}Object.defineProperty(e,"__esModule",{value:!0}),e.style2Entity=n,e.getPositions=r,e.getCoordinates=a,e.toGeoJSON=o;var s=i(0),l=function(t){return t&&t.__esModule?t:{default:t}}(s),u=i(2),c=function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e.default=t,e}(u)},function(t,e,i){"use strict";function n(t,e){t=t||{},null==e&&(e={fill:!0,classificationType:l.default.ClassificationType.BOTH});for(var i in t){var n=t[i];switch(i){default:e[i]=n;break;case"opacity":case"outlineOpacity":break;case"color":e.material=new l.default.Color.fromCssColorString(n||"#FFFF00").withAlpha(Number(t.opacity||1));break;case"outlineColor":e.outlineColor=new l.default.Color.fromCssColorString(n||t.color||"#FFFF00").withAlpha(t.outlineOpacity||t.opacity||1);break;case"extrudedHeight":var r=0;e.hierarchy&&(r=(0,d.getMaxHeight)(e.hierarchy.getValue?e.hierarchy.getValue():e.hierarchy)),e.extrudedHeight=Number(n)+r;break;case"clampToGround":e.perPositionHeight=!n}}return null==t.color&&(e.material=l.default.Color.fromRandom({minimumGreen:.75,maximumBlue:.75,alpha:Number(t.opacity||1)})),e}function r(t){var e=t.polygon.hierarchy.getValue();return e.positions&&c.isArray(e.positions)?e.positions:e}function a(t){var e=r(t);return c.cartesians2lonlats(e)}function o(t){var e=a(t);return e.length>0&&e.push(e[0]),{type:"Feature",properties:t.attribute||{},geometry:{type:"Polygon",coordinates:[e]}}}Object.defineProperty(e,"__esModule",{value:!0}),e.style2Entity=n,e.getPositions=r,e.getCoordinates=a,e.toGeoJSON=o;var s=i(0),l=function(t){return t&&t.__esModule?t:{default:t}}(s),u=i(2),c=function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e.default=t,e}(u),d=i(1)},function(t,e,i){"use strict";var n,r,a,o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t};!function(s,l){"object"===o(e)&&void 0!==t?l(e,i(12)):(r=[e,i(12)],n=l,void 0!==(a="function"==typeof n?n.apply(e,r):n)&&(t.exports=a))}(0,function(t,e){function i(t){var e="";t.f=t.f||"json";for(var i in t)if(t.hasOwnProperty(i)){var n,r=t[i],a=Object.prototype.toString.call(r);e.length&&(e+="&"),n="[object Array]"===a?"[object Object]"===Object.prototype.toString.call(r[0])?JSON.stringify(r):r.join(","):"[object Object]"===a?JSON.stringify(r):"[object Date]"===a?r.valueOf():r,e+=encodeURIComponent(i)+"="+encodeURIComponent(n)}return e}function n(t,i){var n=new window.XMLHttpRequest;return n.onerror=function(r){n.onreadystatechange=e.Util.falseFn,t.call(i,{error:{code:500,message:"XMLHttpRequest error"}},null)},n.onreadystatechange=function(){var r,a;if(4===n.readyState){try{r=JSON.parse(n.responseText)}catch(t){r=null,a={code:500,message:"Could not parse response as JSON. This could also be caused by a CORS or XMLHttpRequest error."}}!a&&r.error&&(a=r.error,r=null),n.onerror=e.Util.falseFn,t.call(i,a,r)}},n.ontimeout=function(){this.onerror()},n}function r(t,e,r,a){var o=n(r,a);return o.open("POST",t),void 0!==a&&null!==a&&void 0!==a.options&&(o.timeout=a.options.timeout),o.setRequestHeader("Content-Type","application/x-www-form-urlencoded; charset=UTF-8"),o.send(i(e)),o}function a(t,e,r,a){var o=n(r,a);return o.open("GET",t+"?"+i(e),!0),void 0!==a&&null!==a&&void 0!==a.options&&(o.timeout=a.options.timeout),o.send(null),o}function o(t,e,r,a){var o=i(e),l=n(r,a),u=(t+"?"+o).length;if(u<=2e3&&W.cors?l.open("GET",t+"?"+o):u>2e3&&W.cors&&(l.open("POST",t),l.setRequestHeader("Content-Type","application/x-www-form-urlencoded; charset=UTF-8")),void 0!==a&&null!==a&&void 0!==a.options&&(l.timeout=a.options.timeout),u<=2e3&&W.cors)l.send(null);else{if(!(u>2e3&&W.cors))return u<=2e3&&!W.cors?s(t,e,r,a):void A("a request to "+t+" was longer then 2000 characters and this browser cannot make a cross-domain post request. Please use a proxy http://esri.github.io/esri-leaflet/api-reference/request.html");l.send(o)}return l}function s(t,n,r,a){window._EsriLeafletCallbacks=window._EsriLeafletCallbacks||{};var o="c"+Z;n.callback="window._EsriLeafletCallbacks."+o,window._EsriLeafletCallbacks[o]=function(t){if(!0!==window._EsriLeafletCallbacks[o]){var e,i=Object.prototype.toString.call(t);"[object Object]"!==i&&"[object Array]"!==i&&(e={error:{code:500,message:"Expected array or object as JSONP response"}},t=null),!e&&t.error&&(e=t,t=null),r.call(a,e,t),window._EsriLeafletCallbacks[o]=!0}};var s=e.DomUtil.create("script",null,document.body);return s.type="text/javascript",s.src=t+"?"+i(n),s.id=o,e.DomUtil.addClass(s,"esri-leaflet-jsonp"),Z++,{id:o,url:s.src,abort:function(){window._EsriLeafletCallbacks._callback[o]({code:0,message:"Request aborted."})}}}function l(t,e){for(var i=0;i<t.length;i++)if(t[i]!==e[i])return!1;return!0}function u(t){return l(t[0],t[t.length-1])||t.push(t[0]),t}function c(t){var e,i=0,n=0,r=t.length,a=t[n];for(n;n<r-1;n++)e=t[n+1],i+=(e[0]-a[0])*(e[1]+a[1]),a=e;return i>=0}function d(t,e,i,n){var r=(n[0]-i[0])*(t[1]-i[1])-(n[1]-i[1])*(t[0]-i[0]),a=(e[0]-t[0])*(t[1]-i[1])-(e[1]-t[1])*(t[0]-i[0]),o=(n[1]-i[1])*(e[0]-t[0])-(n[0]-i[0])*(e[1]-t[1]);if(0!==o){var s=r/o,l=a/o;if(s>=0&&s<=1&&l>=0&&l<=1)return!0}return!1}function h(t,e){for(var i=0;i<t.length-1;i++)for(var n=0;n<e.length-1;n++)if(d(t[i],t[i+1],e[n],e[n+1]))return!0;return!1}function f(t,e){for(var i=!1,n=-1,r=t.length,a=r-1;++n<r;a=n)(t[n][1]<=e[1]&&e[1]<t[a][1]||t[a][1]<=e[1]&&e[1]<t[n][1])&&e[0]<(t[a][0]-t[n][0])*(e[1]-t[n][1])/(t[a][1]-t[n][1])+t[n][0]&&(i=!i);return i}function p(t,e){var i=h(t,e),n=f(t,e[0]);return!(i||!n)}function g(t){for(var e,i,n,r=[],a=[],o=0;o<t.length;o++){var s=u(t[o].slice(0));if(!(s.length<4))if(c(s)){var l=[s.slice().reverse()];r.push(l)}else a.push(s.slice().reverse())}for(var d=[];a.length;){n=a.pop();var f=!1;for(e=r.length-1;e>=0;e--)if(i=r[e][0],p(i,n)){r[e].push(n),f=!0;break}f||d.push(n)}for(;d.length;){n=d.pop();var g=!1;for(e=r.length-1;e>=0;e--)if(i=r[e][0],h(i,n)){r[e].push(n),g=!0;break}g||r.push([n.reverse()])}return 1===r.length?{type:"Polygon",coordinates:r[0]}:{type:"MultiPolygon",coordinates:r}}function m(t){var e=[],i=t.slice(0),n=u(i.shift().slice(0));if(n.length>=4){c(n)||n.reverse(),e.push(n);for(var r=0;r<i.length;r++){var a=u(i[r].slice(0));a.length>=4&&(c(a)&&a.reverse(),e.push(a))}}return e}function y(t){for(var e=[],i=0;i<t.length;i++)for(var n=m(t[i]),r=n.length-1;r>=0;r--){var a=n[r].slice(0);e.push(a)}return e}function v(t){var e={};for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i]);return e}function _(t,e){for(var i=e?[e,"OBJECTID","FID"]:["OBJECTID","FID"],n=0;n<i.length;n++){var r=i[n];if(r in t&&("string"==typeof t[r]||"number"==typeof t[r]))return t[r]}throw Error("No valid id attribute found")}function w(t,e){var i={};if("number"==typeof t.x&&"number"==typeof t.y&&(i.type="Point",i.coordinates=[t.x,t.y],"number"==typeof t.z&&i.coordinates.push(t.z)),t.points&&(i.type="MultiPoint",i.coordinates=t.points.slice(0)),t.paths&&(1===t.paths.length?(i.type="LineString",i.coordinates=t.paths[0].slice(0)):(i.type="MultiLineString",i.coordinates=t.paths.slice(0))),t.rings&&(i=g(t.rings.slice(0))),(t.geometry||t.attributes)&&(i.type="Feature",i.geometry=t.geometry?w(t.geometry):null,i.properties=t.attributes?v(t.attributes):null,t.attributes))try{i.id=_(t.attributes,e)}catch(t){}return JSON.stringify(i.geometry)===JSON.stringify({})&&(i.geometry=null),t.spatialReference&&t.spatialReference.wkid&&4326!==t.spatialReference.wkid&&console.warn("Object converted in non-standard crs - "+JSON.stringify(t.spatialReference)),i}function b(t,e){e=e||"OBJECTID";var i,n={wkid:4326},r={};switch(t.type){case"Point":r.x=t.coordinates[0],r.y=t.coordinates[1],r.spatialReference=n;break;case"MultiPoint":r.points=t.coordinates.slice(0),r.spatialReference=n;break;case"LineString":r.paths=[t.coordinates.slice(0)],r.spatialReference=n;break;case"MultiLineString":r.paths=t.coordinates.slice(0),r.spatialReference=n;break;case"Polygon":r.rings=m(t.coordinates.slice(0)),r.spatialReference=n;break;case"MultiPolygon":r.rings=y(t.coordinates.slice(0)),r.spatialReference=n;break;case"Feature":t.geometry&&(r.geometry=b(t.geometry,e)),r.attributes=t.properties?v(t.properties):{},t.id&&(r.attributes[e]=t.id);break;case"FeatureCollection":for(r=[],i=0;i<t.features.length;i++)r.push(b(t.features[i],e));break;case"GeometryCollection":for(r=[],i=0;i<t.geometries.length;i++)r.push(b(t.geometries[i],e))}return r}function C(t,e){return b(t,e)}function x(t,e){return w(t,e)}function P(t){if("NaN"!==t.xmin&&"NaN"!==t.ymin&&"NaN"!==t.xmax&&"NaN"!==t.ymax){var i=e.latLng(t.ymin,t.xmin),n=e.latLng(t.ymax,t.xmax);return e.latLngBounds(i,n)}return null}function M(t){return t=e.latLngBounds(t),{xmin:t.getSouthWest().lng,ymin:t.getSouthWest().lat,xmax:t.getNorthEast().lng,ymax:t.getNorthEast().lat,spatialReference:{wkid:4326}}}function E(t){var e;if(t.objectIdFieldName)e=t.objectIdFieldName;else if(t.fields){for(var i=0;i<=t.fields.length-1;i++)if("esriFieldTypeOID"===t.fields[i].type){e=t.fields[i].name;break}if(!e)for(i=0;i<=t.fields.length-1;i++)if(t.fields[i].name.match(X)){e=t.fields[i].name;break}}return e}function L(t){for(var e in t.attributes)if(e.match(X))return e}function S(t,e){var i,n=t.features||t.results,r=n.length;i=e||E(t);var a={type:"FeatureCollection",features:[]};if(r)for(var o=n.length-1;o>=0;o--){var s=x(n[o],i||L(n[o]));a.features.push(s)}return a}function O(t){return t=e.Util.trim(t),"/"!==t[t.length-1]&&(t+="/"),t}function T(t){if(-1!==t.url.indexOf("?")){t.requestParams=t.requestParams||{};var e=t.url.substring(t.url.indexOf("?")+1);t.url=t.url.split("?")[0],t.requestParams=JSON.parse('{"'+decodeURI(e).replace(/"/g,'\\"').replace(/&/g,'","').replace(/=/g,'":"')+'"}')}return t.url=O(t.url.split("?")[0]),t}function D(t){return/^(?!.*utility\.arcgis\.com).*\.arcgis\.com.*FeatureServer/i.test(t)}function k(t){var e;switch(t){case"Point":e="esriGeometryPoint";break;case"MultiPoint":e="esriGeometryMultipoint";break;case"LineString":case"MultiLineString":e="esriGeometryPolyline";break;case"Polygon":case"MultiPolygon":e="esriGeometryPolygon"}return e}function A(){console&&console.warn&&console.warn.apply(console,arguments)}function R(t){return t.getSize().x-q.attributionWidthOffset+"px"}function N(t){if(t.attributionControl&&!t.attributionControl._esriAttributionAdded){t.attributionControl.setPrefix('<a href="http://leafletjs.com" title="A JS library for interactive maps">Leaflet</a> | Powered by <a href="https://www.esri.com">Esri</a>');var i=document.createElement("style");i.type="text/css",i.innerHTML=".esri-truncated-attribution:hover {white-space: normal;}",document.getElementsByTagName("head")[0].appendChild(i),e.DomUtil.addClass(t.attributionControl._container,"esri-truncated-attribution:hover");var n=document.createElement("style");n.type="text/css",n.innerHTML=".esri-truncated-attribution {vertical-align: -3px;white-space: nowrap;overflow: hidden;text-overflow: ellipsis;display: inline-block;transition: 0s white-space;transition-delay: 1s;max-width: "+R(t)+";}",document.getElementsByTagName("head")[0].appendChild(n),e.DomUtil.addClass(t.attributionControl._container,"esri-truncated-attribution"),t.on("resize",function(e){t.attributionControl._container.style.maxWidth=R(e.target)}),t.on("unload",function(){i.parentNode.removeChild(i),n.parentNode.removeChild(n);for(var t=document.querySelectorAll(".esri-leaflet-jsonp"),e=0;e<t.length;e++)t.item(e).parentNode.removeChild(t.item(e))}),t.attributionControl._esriAttributionAdded=!0}}function F(t){var i={geometry:null,geometryType:null};return t instanceof e.LatLngBounds?(i.geometry=M(t),i.geometryType="esriGeometryEnvelope",i):(t.getLatLng&&(t=t.getLatLng()),t instanceof e.LatLng&&(t={type:"Point",coordinates:[t.lng,t.lat]}),t instanceof e.GeoJSON&&(t=t.getLayers()[0].feature.geometry,i.geometry=C(t),i.geometryType=k(t.type)),t.toGeoJSON&&(t=t.toGeoJSON()),"Feature"===t.type&&(t=t.geometry),"Point"===t.type||"LineString"===t.type||"Polygon"===t.type||"MultiPolygon"===t.type?(i.geometry=C(t),i.geometryType=k(t.type),i):void A("invalid geometry passed to spatial query. Should be L.LatLng, L.LatLngBounds, L.Marker or a GeoJSON Point, Line, Polygon or MultiPolygon object"))}function I(t,i){s(t,{},e.Util.bind(function(t,n){if(!t){i._esriAttributions=[];for(var r=0;r<n.contributors.length;r++)for(var a=n.contributors[r],o=0;o<a.coverageAreas.length;o++){var s=a.coverageAreas[o],l=e.latLng(s.bbox[0],s.bbox[1]),u=e.latLng(s.bbox[2],s.bbox[3]);i._esriAttributions.push({attribution:a.attribution,score:s.score,bounds:e.latLngBounds(l,u),minZoom:s.zoomMin,maxZoom:s.zoomMax})}i._esriAttributions.sort(function(t,e){return e.score-t.score});j({target:i})}},this))}function j(t){var i=t.target,n=i._esriAttributions;if(i&&i.attributionControl&&n){for(var r="",a=i.getBounds(),o=e.latLngBounds(a.getSouthWest().wrap(),a.getNorthEast().wrap()),s=i.getZoom(),l=0;l<n.length;l++){var u=n[l],c=u.attribution;!r.match(c)&&u.bounds.intersects(o)&&s>=u.minZoom&&s<=u.maxZoom&&(r+=", "+c)}r=r.substr(2);var d=i.attributionControl._container.querySelector(".esri-dynamic-attribution");d.innerHTML=r,d.style.maxWidth=R(i),i.fire("attributionupdated",{attribution:r})}}function H(t){return t=T(t),new K(t)}function G(t){return new $(t)}function B(t){return new tt(t)}function V(t){return new et(t)}var z=window.XMLHttpRequest&&"withCredentials"in new window.XMLHttpRequest,U=""===document.documentElement.style.pointerEvents,W={cors:z,pointerEvents:U},q={attributionWidthOffset:55},Z=0,J=W.cors?a:s;J.CORS=a,J.JSONP=s;var Y={request:o,get:J,post:r},X=/^(OBJECTID|FID|OID|ID)$/i,Q={warn:A,cleanUrl:O,getUrlParams:T,isArcgisOnline:D,geojsonTypeToArcGIS:k,responseToFeatureCollection:S,geojsonToArcGIS:C,arcgisToGeoJSON:x,boundsToExtent:M,extentToBounds:P,calcAttributionWidth:R,setEsriAttribution:N,_setGeometry:F,_getAttributionData:I,_updateMapAttribution:j,_findIdAttributeFromFeature:L,_findIdAttributeFromResponse:E},K=e.Class.extend({options:{proxy:!1,useCors:z},generateSetter:function(t,i){return e.Util.bind(function(e){return this.params[t]=e,this},i)},initialize:function(t){if(t.request&&t.options?(this._service=t,e.Util.setOptions(this,t.options)):(e.Util.setOptions(this,t),this.options.url=O(t.url)),this.params=e.Util.extend({},this.params||{}),this.setters)for(var i in this.setters){var n=this.setters[i];this[i]=this.generateSetter(n,this)}},token:function(t){return this._service?this._service.authenticate(t):this.params.token=t,this},format:function(t){return this.params.returnUnformattedValues=!t,this},request:function(t,i){return this.options.requestParams&&e.Util.extend(this.params,this.options.requestParams),this._service?this._service.request(this.path,this.params,t,i):this._request("request",this.path,this.params,t,i)},_request:function(t,e,i,n,r){var a=this.options.proxy?this.options.proxy+"?"+this.options.url+e:this.options.url+e;return"get"!==t&&"request"!==t||this.options.useCors?Y[t](a,i,n,r):Y.get.JSONP(a,i,n,r)}}),$=K.extend({setters:{offset:"resultOffset",limit:"resultRecordCount",fields:"outFields",precision:"geometryPrecision",featureIds:"objectIds",returnGeometry:"returnGeometry",returnM:"returnM",transform:"datumTransformation",token:"token"},path:"query",params:{returnGeometry:!0,where:"1=1",outSr:4326,outFields:"*"},within:function(t){return this._setGeometryParams(t),this.params.spatialRel="esriSpatialRelContains",this},intersects:function(t){return this._setGeometryParams(t),this.params.spatialRel="esriSpatialRelIntersects",this},contains:function(t){return this._setGeometryParams(t),this.params.spatialRel="esriSpatialRelWithin",this},crosses:function(t){return this._setGeometryParams(t),this.params.spatialRel="esriSpatialRelCrosses",this},touches:function(t){return this._setGeometryParams(t),this.params.spatialRel="esriSpatialRelTouches",this},overlaps:function(t){return this._setGeometryParams(t),this.params.spatialRel="esriSpatialRelOverlaps",this},bboxIntersects:function(t){return this._setGeometryParams(t),this.params.spatialRel="esriSpatialRelEnvelopeIntersects",this},indexIntersects:function(t){return this._setGeometryParams(t),this.params.spatialRel="esriSpatialRelIndexIntersects",this},nearby:function(t,i){return t=e.latLng(t),this.params.geometry=[t.lng,t.lat],this.params.geometryType="esriGeometryPoint",this.params.spatialRel="esriSpatialRelIntersects",this.params.units="esriSRUnit_Meter",this.params.distance=i,this.params.inSr=4326,this},where:function(t){return this.params.where=t,this},between:function(t,e){return this.params.time=[t.valueOf(),e.valueOf()],this},simplify:function(t,e){var i=Math.abs(t.getBounds().getWest()-t.getBounds().getEast());return this.params.maxAllowableOffset=i/t.getSize().y*e,this},orderBy:function(t,e){return e=e||"ASC",this.params.orderByFields=this.params.orderByFields?this.params.orderByFields+",":"",this.params.orderByFields+=[t,e].join(" "),this},run:function(t,e){return this._cleanParams(),this.options.isModern||D(this.options.url)?(this.params.f="geojson",this.request(function(i,n){this._trapSQLerrors(i),t.call(e,i,n,n)},this)):this.request(function(i,n){this._trapSQLerrors(i),t.call(e,i,n&&S(n),n)},this)},count:function(t,e){return this._cleanParams(),this.params.returnCountOnly=!0,this.request(function(e,i){t.call(this,e,i&&i.count,i)},e)},ids:function(t,e){return this._cleanParams(),this.params.returnIdsOnly=!0,this.request(function(e,i){t.call(this,e,i&&i.objectIds,i)},e)},bounds:function(t,e){return this._cleanParams(),this.params.returnExtentOnly=!0,this.request(function(i,n){n&&n.extent&&P(n.extent)?t.call(e,i,P(n.extent),n):(i={message:"Invalid Bounds"},t.call(e,i,null,n))},e)},distinct:function(){return this.params.returnGeometry=!1,this.params.returnDistinctValues=!0,this},pixelSize:function(t){var i=e.point(t);return this.params.pixelSize=[i.x,i.y],this},layer:function(t){return this.path=t+"/query",this},_trapSQLerrors:function(t){t&&"400"===t.code&&A("one common syntax error in query requests is encasing string values in double quotes instead of single quotes")},_cleanParams:function(){delete this.params.returnIdsOnly,delete this.params.returnExtentOnly,delete this.params.returnCountOnly},_setGeometryParams:function(t){this.params.inSr=4326;var e=F(t);this.params.geometry=e.geometry,this.params.geometryType=e.geometryType}}),tt=K.extend({setters:{contains:"contains",text:"searchText",fields:"searchFields",spatialReference:"sr",sr:"sr",layers:"layers",returnGeometry:"returnGeometry",maxAllowableOffset:"maxAllowableOffset",precision:"geometryPrecision",dynamicLayers:"dynamicLayers",returnZ:"returnZ",returnM:"returnM",gdbVersion:"gdbVersion",token:"token"},path:"find",params:{sr:4326,contains:!0,returnGeometry:!0,returnZ:!0,returnM:!1},layerDefs:function(t,e){return this.params.layerDefs=this.params.layerDefs?this.params.layerDefs+";":"",this.params.layerDefs+=[t,e].join(":"),this},simplify:function(t,e){var i=Math.abs(t.getBounds().getWest()-t.getBounds().getEast());return this.params.maxAllowableOffset=i/t.getSize().y*e,this},run:function(t,e){return this.request(function(i,n){t.call(e,i,n&&S(n),n)},e)}}),et=K.extend({path:"identify",between:function(t,e){return this.params.time=[t.valueOf(),e.valueOf()],this}});t.VERSION="2.1.4",t.Support=W,t.options=q,t.Util=Q,t.get=J,t.post=r,t.request=o,t.Task=K,t.task=H,t.Query=$,t.query=G,t.Find=tt,t.find=B,t.Identify=et,t.identify=V})},function(t,e,i){"use strict";var n,r,a;"function"==typeof Symbol&&Symbol.iterator;!function(i,o){r=[],n=o,void 0!==(a="function"==typeof n?n.apply(e,r):n)&&(t.exports=a)}(0,function(){var t=52.35987755982988,e=3.141592653589793,i=6378245,n=.006693421622965943,r=function(t){var e=Number(t[0]),i=Number(t[1]),n=52.35987755982988,r=e-.0065,a=i-.006,o=Math.sqrt(r*r+a*a)-2e-5*Math.sin(a*n),s=Math.atan2(a,r)-3e-6*Math.cos(r*n),l=o*Math.cos(s),u=o*Math.sin(s);return l=Number(l.toFixed(6)),u=Number(u.toFixed(6)),[l,u]},a=function(e){var i=Number(e[0]),n=Number(e[1]),r=Math.sqrt(i*i+n*n)+2e-5*Math.sin(n*t),a=Math.atan2(n,i)+3e-6*Math.cos(i*t),o=r*Math.cos(a)+.0065,s=r*Math.sin(a)+.006;return o=Number(o.toFixed(6)),s=Number(s.toFixed(6)),[o,s]},o=function(t){var r=Number(t[0]),a=Number(t[1]);if(h(r,a))return[r,a];var o=c(r-105,a-35),s=d(r-105,a-35),l=a/180*e,u=Math.sin(l);u=1-n*u*u;var f=Math.sqrt(u);o=180*o/(i*(1-n)/(u*f)*e),s=180*s/(i/f*Math.cos(l)*e);var p=a+o,g=r+s;return g=Number(g.toFixed(6)),p=Number(p.toFixed(6)),[g,p]},s=function(t){var r=Number(t[0]),a=Number(t[1]);if(h(r,a))return[r,a];var o=c(r-105,a-35),s=d(r-105,a-35),l=a/180*e,u=Math.sin(l);u=1-n*u*u;var f=Math.sqrt(u);o=180*o/(i*(1-n)/(u*f)*e),s=180*s/(i/f*Math.cos(l)*e);var p=a+o,g=r+s,m=2*r-g,y=2*a-p;return m=Number(m.toFixed(6)),y=Number(y.toFixed(6)),[m,y]},l=function(t){return s(r(t))},u=function(t){return a(o(t))},c=function(t,i){var n=2*t-100+3*i+.2*i*i+.1*t*i+.2*Math.sqrt(Math.abs(t));return n+=2*(20*Math.sin(6*t*e)+20*Math.sin(2*t*e))/3,n+=2*(20*Math.sin(i*e)+40*Math.sin(i/3*e))/3,n+=2*(160*Math.sin(i/12*e)+320*Math.sin(i*e/30))/3},d=function(t,i){var n=300+t+2*i+.1*t*t+.1*t*i+.1*Math.sqrt(Math.abs(t));return n+=2*(20*Math.sin(6*t*e)+20*Math.sin(2*t*e))/3,n+=2*(20*Math.sin(t*e)+40*Math.sin(t/3*e))/3,n+=2*(150*Math.sin(t/12*e)+300*Math.sin(t/30*e))/3},h=function(t,e){return t<72.004||t>137.8347||e<.8293||e>55.8271||!1};return{jwd2mct:function(t){var i=Number(t[0]),n=Number(t[1]),r=20037508.34*i/180,a=Math.log(Math.tan((90+n)*e/360))/(e/180);return a=20037508.34*a/180,r=Number(r.toFixed(2)),a=Number(a.toFixed(2)),[r,a]},mct2jwd:function(t){var i=Number(t[0]),n=Number(t[1]),r=i/20037508.34*180,a=n/20037508.34*180;return a=180/e*(2*Math.atan(Math.exp(a*e/180))-e/2),r=Number(r.toFixed(6)),a=Number(a.toFixed(6)),[r,a]},bd2gcj:r,gcj2bd:a,bd2wgs:l,wgs2bd:u,wgs2gcj:o,gcj2wgs:s}})},function(t,e,i){"use strict";function n(t){return t&&t.__esModule?t:{default:t}}Object.defineProperty(e,"__esModule",{value:!0}),e.GeoJsonLayer=void 0;var r=i(0),a=n(r),o=i(5),s=n(o),l=i(4),u=i(7),c=i(15),d=i(13),h=i(11),f=i(16),p=u.BaseLayer.extend({dataSource:null,add:function(){this.dataSource?this.viewer.dataSources.add(this.dataSource):this.queryData()},remove:function(){this.viewer.dataSources.remove(this.dataSource)},centerAt:function(t){if(this.config.extent||this.config.center)this.viewer.mars.centerAt(this.config.extent||this.config.center,{duration:t,isWgs84:!0});else{if(null==this.dataSource)return;this.viewer.flyTo(this.dataSource.entities.values,{duration:t})}},hasOpacity:!0,_opacity:.9,setOpacity:function(t){if(this._opacity=t,null!=this.dataSource)for(var e=this.dataSource.entities.values,i=0,n=e.length;i<n;i++){var r=e[i];r.polygon&&r.polygon.material&&r.polygon.material.color&&(this._updatEntityAlpha(r.polygon.material.color,this._opacity),r.polygon.outlineColor&&this._updatEntityAlpha(r.polygon.outlineColor,this._opacity)),r.polyline&&r.polyline.material&&r.polyline.material.color&&this._updatEntityAlpha(r.polyline.material.color,this._opacity),r.billboard&&(r.billboard.color=new a.default.Color.fromCssColorString("#FFFFFF").withAlpha(this._opacity)),r.model&&(r.model.color=new a.default.Color.fromCssColorString("#FFFFFF").withAlpha(this._opacity)),r.label&&(r.label.fillColor&&this._updatEntityAlpha(r.label.fillColor,this._opacity),r.label.outlineColor&&this._updatEntityAlpha(r.label.outlineColor,this._opacity),r.label.backgroundColor&&this._updatEntityAlpha(r.label.backgroundColor,this._opacity))}},_updatEntityAlpha:function(t,e){var i=t.getValue().withAlpha(e);t.setValue(i)},queryData:function(){var t=this,e=(0,l.getProxyUrl)(this.config);a.default.GeoJsonDataSource.load(e.url,e).then(function(e){t.showResult(e)}).otherwise(function(e){t.showError("服务出错",e)})},showResult:function(t){var e=this;this.dataSource=t,this.viewer.dataSources.add(t),this.config.flyTo&&this.centerAt();for(var i=t.entities.values,n=0,r=i.length;n<r;n++){var a=i[n];this.config.symbol&&("default"==this.config.symbol?this.setDefSymbol(a):this.setConfigSymbol(a,this.config.symbol)),(this.config.columns||this.config.popup)&&(a.popup={html:function(t){var i=e.getEntityAttr(t);return(0,l.isString)(i)?i:e.viewer.mars.popup.getPopupForConfig(e.config,i)},anchor:this.config.popupAnchor||[0,-15]}),this.config.tooltip&&(a.tooltip={html:function(t){var i=e.getEntityAttr(t);return(0,l.isString)(i)?i:e.viewer.mars.popup.getPopupForConfig({popup:e.config.tooltip},i)},anchor:this.config.tooltipAnchor||[0,-15]}),this.config.click&&(a.click=this.config.click),this.config.mouseover&&(a.mouseover=this.config.mouseover),this.config.mouseout&&(a.mouseout=this.config.mouseout)}},getEntityAttr:function(t){return t.properties},colorHash:{},setDefSymbol:function(t){var e=this.getEntityAttr(t)||{};if(t.polygon){var i=e.id||e.OBJECTID||0,n=this.colorHash[i];n||(n=a.default.Color.fromRandom({minimumGreen:.75,maximumBlue:.75,alpha:this._opacity}),this.colorHash[i]=n),t.polygon.material=n,t.polygon.outline=!0,t.polygon.outlineColor=a.default.Color.WHITE}else if(t.polyline){var i=e.id||e.OBJECTID||0,n=this.colorHash[i];n||(n=a.default.Color.fromRandom({minimumGreen:.75,maximumBlue:.75,alpha:this._opacity}),this.colorHash[i]=n),t.polyline.material=n,t.polyline.width=2}else t.billboard&&(t.billboard.scale=.5,t.billboard.horizontalOrigin=a.default.HorizontalOrigin.CENTER,t.billboard.verticalOrigin=a.default.VerticalOrigin.BOTTOM)},setConfigSymbol:function(t,e){var i=this.getEntityAttr(t)||{},n=e.styleOptions;if(e.styleField){var r=i[e.styleField],o=e.styleFieldOptions[r];null!=o&&(n=(0,l.clone)(n),n=s.default.extend(n,o))}if("function"==typeof e.calback){var o=e.calback(i,t,e);if(!o)return;n=(0,l.clone)(n),n=s.default.extend(n,o)}if(n=n||{},this._opacity=n.opacity||1,t.polyline&&(0,h.style2Entity)(n,t.polyline),t.polygon){if((0,f.style2Entity)(n,t.polygon),n.outlineWidth&&n.outlineWidth>1){t.polygon.outline=!1;var u={color:n.outlineColor,width:n.outlineWidth,opacity:n.outlineOpacity,lineType:"solid",clampToGround:!0,outline:!1},p=(0,h.style2Entity)(u);p.positions=t.polygon.hierarchy._value.positions,this.dataSource._entityCollection.add({polyline:p})}if(this.config.buildings){var g=Number(i[this.config.buildings.cloumn]||1),m=Number(this.config.buildings.height||5);t.polygon.extrudedHeight=g*m}}t.label&&(n.heightReference=n.heightReference||a.default.HeightReference.RELATIVE_TO_GROUND,(0,d.style2Entity)(n,t.label)),t.billboard&&(n.heightReference=n.heightReference||a.default.HeightReference.RELATIVE_TO_GROUND,(0,c.style2Entity)(n,t.billboard),n.label&&n.label.field&&(n.label.heightReference=n.label.heightReference||a.default.HeightReference.RELATIVE_TO_GROUND,t.label=(0,d.style2Entity)(n.label),t.label.text=i[n.label.field]||"")),t.attribute=n}});e.GeoJsonLayer=p},function(t,e,i){"use strict";function n(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e.default=t,e}Object.defineProperty(e,"__esModule",{value:!0}),e.DrawPoint=void 0;var r=i(0),a=function(t){return t&&t.__esModule?t:{default:t}}(r),o=i(26),s=i(1),l=i(24),u=n(l),c=i(3),d=i(8),h=n(d),f=i(58);e.DrawPoint=o.DrawBase.extend({type:"point",createFeature:function(t){this._positions_draw=null;var e=this,i={position:new a.default.CallbackProperty(function(t){return e.getDrawPosition()},!1),point:u.style2Entity(t.style),attribute:t};return this.entity=this.dataSource.entities.add(i),this.entity},style2Entity:function(t,e){return u.style2Entity(t,e.point)},bindEvent:function(){var t=this;this.getHandler().setInputAction(function(e){var i=(0,s.getCurrentMousePosition)(t.viewer.scene,e.endPosition,t.entity);i&&(t._positions_draw=i),t.tooltip.showAt(e.endPosition,c.message.draw.point.start),t.fire(h.DrawMouseMove,{drawtype:t.type,entity:t.entity,position:i})},a.default.ScreenSpaceEventType.MOUSE_MOVE),this.getHandler().setInputAction(function(e){var i=(0,s.getCurrentMousePosition)(t.viewer.scene,e.position,t.entity);i&&(t._positions_draw=i,t.disable())},a.default.ScreenSpaceEventType.LEFT_CLICK)},getEditClass:function(t){var e=new f.EditPoint(t,this.viewer,this.dataSource);return this._bindEdit(e)},getAttrClass:function(){return u},finish:function(){this.entity.editing=this.getEditClass(this.entity),this.entity.position=this.getDrawPosition()}})},function(t,e,i){"use strict";function n(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e.default=t,e}Object.defineProperty(e,"__esModule",{value:!0}),e.EditBase=void 0;var r=i(0),a=function(t){return t&&t.__esModule?t:{default:t}}(r),o=i(10),s=i(8),l=n(s),u=i(6),c=n(u),d=i(3),h=i(2),f=n(h),p=i(1);e.EditBase=o.Class.extend({_dataSource:null,_minPointNum:1,_maxPointNum:9999,initialize:function(t,e,i){this.entity=t,this.viewer=e,this.dataSource=i,this.draggers=[]},fire:function(t,e,i){this._fire&&this._fire(t,e,i)},formatNum:function(t,e){return f.formatNum(t,e)},setCursor:function(t){this.viewer._container.style.cursor=t?"crosshair":""},activate:function(){return this._enabled?this:(this._enabled=!0,this.entity.inProgress=!0,this.changePositionsToCallback(),this.bindDraggers(),this.bindEvent(),this.fire(l.EditStart,{edittype:this.entity.attribute.type,entity:this.entity}),this)},disable:function(){return this._enabled?(this._enabled=!1,this.destroyEvent(),this.destroyDraggers(),this.finish(),this.entity.inProgress=!1,this.fire(l.EditStop,{edittype:this.entity.attribute.type,entity:this.entity}),this.tooltip.setVisible(!1),this):this},changePositionsToCallback:function(){},finish:function(){},bindEvent:function(){var t=this,e=new a.default.BoundingSphere,i=new a.default.Cartesian3,n=new a.default.ScreenSpaceEventHandler(this.viewer.canvas);n.dragger=null,n.setInputAction(function(e){var i=t.viewer.scene.pick(e.position);if(a.default.defined(i)){var r=i.id||i.primitive.id||i.primitive;if(r&&a.default.defaultValue(r._isDragger,!1)&&(t.viewer.scene.screenSpaceCameraController.enableRotate=!1,t.viewer.scene.screenSpaceCameraController.enableTilt=!1,t.viewer.scene.screenSpaceCameraController.enableTranslate=!1,t.viewer.scene.screenSpaceCameraController.enableInputs=!1,t.viewer.mars&&t.viewer.mars.popup.close(r),n.dragger=r,n.dragger.show=!1,t.setCursor(!0),n.dragger.onDragStart)){var o=n.dragger.position;o&&o.getValue&&(o=o.getValue()),n.dragger.onDragStart(n.dragger,o)}}},a.default.ScreenSpaceEventType.LEFT_DOWN),n.setInputAction(function(r){var o=n.dragger;if(o)switch(o._pointType){case c.PointType.MoveHeight:var s=r.endPosition.y-r.startPosition.y,l=o.position;l&&l.getValue&&(l=l.getValue());var u=new a.default.EllipsoidTangentPlane(l);e.center=l,e.radius=1;var h=1.5*t.viewer.scene.frameState.camera.getPixelSize(e,t.viewer.scene.frameState.context.drawingBufferWidth,t.viewer.scene.frameState.context.drawingBufferHeight);a.default.Cartesian3.multiplyByScalar(u.zAxis,-s*h,i);var f=a.default.Cartesian3.clone(l);a.default.Cartesian3.add(l,i,f),o.position=f,o.onDrag&&o.onDrag(o,f,l),t.updateAttrForEditing();break;default:t.tooltip.showAt(r.endPosition,d.message.edit.end);var g=(0,p.getCurrentMousePosition)(t.viewer.scene,r.endPosition,t.entity);g&&(o.position=g,o.onDrag&&o.onDrag(o,g),t.updateAttrForEditing())}else{t.tooltip.setVisible(!1);var m=t.viewer.scene.pick(r.endPosition);if(a.default.defined(m)){var y=m.id;if(y&&a.default.defaultValue(y._isDragger,!1)&&y.draw_tooltip){var v=y.draw_tooltip;c.PointType.Control==y._pointType&&t._positions_draw&&t._positions_draw.length&&t._positions_draw.length>t._minPointNum&&(v+=d.message.del.def),t.tooltip.showAt(r.endPosition,v)}}}},a.default.ScreenSpaceEventType.MOUSE_MOVE),n.setInputAction(function(e){var i=n.dragger;if(i){t.setCursor(!1),i.show=!0;var r=i.position;r&&r.getValue&&(r=r.getValue()),i.onDragEnd&&i.onDragEnd(i,r),t.fire(l.EditMovePoint,{edittype:t.entity.attribute.type,entity:t.entity,position:r}),n.dragger=null,t.viewer.scene.screenSpaceCameraController.enableRotate=!0,t.viewer.scene.screenSpaceCameraController.enableTilt=!0,t.viewer.scene.screenSpaceCameraController.enableTranslate=!0,t.viewer.scene.screenSpaceCameraController.enableInputs=!0}},a.default.ScreenSpaceEventType.LEFT_UP),n.setInputAction(function(e){var i=t.viewer.scene.pick(e.position);if(a.default.defined(i)){var n=i.id;if(n&&a.default.defaultValue(n._isDragger,!1)&&c.PointType.Control==n._pointType){t.deletePointForDragger(n,e.position)&&t.fire(l.EditRemovePoint,{edittype:t.entity.attribute.type,entity:t.entity})}}},a.default.ScreenSpaceEventType.RIGHT_CLICK),this.draggerHandler=n},destroyEvent:function(){this.viewer.scene.screenSpaceCameraController.enableRotate=!0,this.viewer.scene.screenSpaceCameraController.enableTilt=!0,this.viewer.scene.screenSpaceCameraController.enableTranslate=!0,this.viewer.scene.screenSpaceCameraController.enableInputs=!0,this.setCursor(!1),this.draggerHandler&&(this.draggerHandler.dragger&&(this.draggerHandler.dragger.show=!0),this.draggerHandler.destroy(),this.draggerHandler=null)},bindDraggers:function(){},updateDraggers:function(){if(!this._enabled)return this;this.destroyDraggers(),this.bindDraggers()},destroyDraggers:function(){for(var t=0,e=this.draggers.length;t<e;t++)this.dataSource.entities.remove(this.draggers[t]);this.draggers=[]},deletePointForDragger:function(t,e){if(this._positions_draw.length-1<this._minPointNum)return this.tooltip.showAt(e,d.message.del.min+this._minPointNum),!1;var i=t.index;return i>0&&i<this._positions_draw.length&&(this._positions_draw.splice(i,1),this.updateDraggers(),!0)},updateAttrForEditing:function(){}})},function(t,e,i){"use strict";function n(t,e,i,r){var a;switch(t.url&&(i&&(t.url=t.url.replace("$serverURL$",i)),t.url=t.url.replace("$hostname$",location.hostname).replace("$host$",location.host)),t.type){case"group":if(t.layers&&t.layers.length>0){for(var o=[],s=0;s<t.layers.length;s++){var l=n(t.layers[s],e,i,r);null!=l&&o.push(l)}t._layers=o,a=new c.GroupLayer(t,e)}break;case"www_bing":case"www_osm":case"www_google":case"www_gaode":case"www_baidu":case"www_tdt":case"arcgis_cache":case"arcgis":case"arcgis_tile":case"arcgis_dynamic":case"wmts":case"tms":case"wms":case"xyz":case"tile":case"single":case"image":case"gee":case"mapbox":case"custom_tilecoord":case"custom_grid":a=new d.TileLayer(t,e),a.isTile=!0;break;case"www_poi":a=new g.POILayer(t,e);break;case"custom_featuregrid":a=new f.CustomFeatureGridLayer(t,e);break;case"custom_graticule":a=new h.GraticuleLayer(t,e);break;case"3dtiles":a=new _.Tiles3dLayer(t,e);break;case"gltf":a=new v.GltfLayer(t,e);break;case"arcgis_feature":a=new p.ArcFeatureGridLayer(t,e);break;case"arcgis_feature2":a=new y.ArcFeatureLayer(t,e);break;case"geojson":a=new m.GeoJsonLayer(t,e);break;case"geojson-draw":a=new x.DrawLayer(t,e);break;case"kml":a=new w.KmlLayer(t,e);break;case"czml":a=new b.CzmlLayer(t,e);break;case"terrain":a=new C.TerrainLayer(t,e)}if(r){var u=r(t,e,a);u&&(a=u)}return null==a?"group"!=t.type&&console.log("配置中的图层未处理："+JSON.stringify(t)):t._layer=a,a}function r(t,e){t.url&&(e&&(t.url=t.url.replace("$serverURL$",e)),t.url=t.url.replace("$hostname$",location.hostname).replace("$host$",location.host));var i={};for(var n in t){var r=t[n];if(null!=r)switch(n){default:i[n]=r;break;case"crs":"4326"==r||"EPSG4326"==r.toUpperCase()||"EPSG:4326"==r.toUpperCase()?i.tilingScheme=new s.default.GeographicTilingScheme({numberOfLevelZeroTilesX:t.numberOfLevelZeroTilesX||2,numberOfLevelZeroTilesY:t.numberOfLevelZeroTilesY||1}):i.tilingScheme=new s.default.WebMercatorTilingScheme({numberOfLevelZeroTilesX:t.numberOfLevelZeroTilesX||1,numberOfLevelZeroTilesY:t.numberOfLevelZeroTilesY||1});break;case"rectangle":i.rectangle=s.default.Rectangle.fromDegrees(r.xmin,r.ymin,r.xmax,r.ymax)}}i.url&&i.proxy&&(i=(0,l.getProxyUrl)(i));var o;switch(i.type_new||i.type){case"single":case"image":o=new s.default.SingleTileImageryProvider(i);break;case"xyz":case"tile":i.customTags={"z&1":function(t,e,i,n){return n+1}},o=new s.default.UrlTemplateImageryProvider(i);break;case"wms":o=new s.default.WebMapServiceImageryProvider(i);break;case"tms":i.url||(i.url=s.default.buildModuleUrl("Assets/Textures/NaturalEarthII")),o=new s.default.createTileMapServiceImageryProvider(i);break;case"wmts":o=new s.default.WebMapTileServiceImageryProvider(i);break;case"gee":o=new s.default.GoogleEarthEnterpriseImageryProvider({metadata:new s.default.GoogleEarthEnterpriseMetadata(i)});break;case"mapbox":o=new s.default.MapboxImageryProvider(i);break;case"arcgis":case"arcgis_tile":case"arcgis_dynamic":o=new s.default.ArcGisMapServerImageryProvider(i);break;case"arcgis_cache":s.default.UrlTemplateImageryProvider.prototype.padLeft0||(s.default.UrlTemplateImageryProvider.prototype.padLeft0=function(t,e){t=String(t);for(var i=t.length;i<e;)t="0"+t,i++;return t}),i.customTags={arc_x:function(t,e,i,n){return t.padLeft0(e.toString(16),8)},arc_y:function(t,e,i,n){return t.padLeft0(i.toString(16),8)},arc_z:function(t,e,i,n){return t.padLeft0(n.toString(),2)},arc_X:function(t,e,i,n){return t.padLeft0(e.toString(16),8).toUpperCase()},arc_Y:function(t,e,i,n){return t.padLeft0(i.toString(16),8).toUpperCase()},arc_Z:function(t,e,i,n){return t.padLeft0(n.toString(),2).toUpperCase()}},o=new s.default.UrlTemplateImageryProvider(i);break;case"www_tdt":var u;switch(i.layer){default:case"vec_d":u="vec";break;case"vec_z":u="cva";break;case"img_d":u="img";break;case"img_z":u="cia";break;case"ter_d":u="ter";break;case"ter_z":u="cta"}var c;c=null==i.key||0==i.key.length?"87949882c75775b5069a0076357b7530":a(i.key);if("4326"==t.crs){for(var d=new Array(18),h=0;h<=18;h++)d[h]=(h+1).toString();var f="http://t{s}.tianditu.gov.cn/"+u+"_c/wmts?service=WMTS&version=1.0.0&request=GetTile&tilematrix={TileMatrix}&layer="+u+"&style={style}&tilerow={TileRow}&tilecol={TileCol}&tilematrixset={TileMatrixSet}&format=tiles&tk="+c;o=new s.default.WebMapTileServiceImageryProvider({url:i.proxy?new s.default.Resource({url:f,proxy:i.proxy}):f,layer:u,style:"default",format:"tiles",tileMatrixSetID:"c",subdomains:["0","1","2","3","4","5","6","7"],tileMatrixLabels:d,tilingScheme:new s.default.GeographicTilingScheme,maximumLevel:18})}else{for(var d=new Array(18),h=0;h<=18;h++)d[h]=h.toString();var f="http://t{s}.tianditu.gov.cn/"+u+"_w/wmts?service=WMTS&version=1.0.0&request=GetTile&tilematrix={TileMatrix}&layer="+u+"&style={style}&tilerow={TileRow}&tilecol={TileCol}&tilematrixset={TileMatrixSet}&format=tiles&tk="+c;o=new s.default.WebMapTileServiceImageryProvider({url:i.proxy?new s.default.Resource({url:f.replace("{s}","0"),proxy:i.proxy}):f,layer:u,style:"default",format:"tiles",tileMatrixSetID:"w",subdomains:["0","1","2","3","4","5","6","7"],tileMatrixLabels:d,tilingScheme:new s.default.WebMercatorTilingScheme,maximumLevel:18})}break;case"www_gaode":var f;switch(i.layer){case"vec":default:f="http://"+(i.bigfont?"wprd":"webrd")+"0{s}.is.autonavi.com/appmaptile?lang=zh_cn&size=1&scale=1&style=7&x={x}&y={y}&z={z}";break;case"img_d":f="http://webst0{s}.is.autonavi.com/appmaptile?style=6&x={x}&y={y}&z={z}";break;case"img_z":f="http://webst0{s}.is.autonavi.com/appmaptile?x={x}&y={y}&z={z}&lang=zh_cn&size=1&scale=1&style=8";break;case"time":f="http://tm.amap.com/trafficengine/mapabc/traffictile?v=1.0&;t=1&x={x}&y={y}&z={z}&&t="+(new Date).getTime()}o=new s.default.UrlTemplateImageryProvider({url:i.proxy?new s.default.Resource({url:f,proxy:i.proxy}):f,subdomains:["1","2","3","4"],maximumLevel:18});break;case"www_baidu":o=new P.BaiduImageryProvider(i);break;case"www_google":var f;if("4326"==t.crs||"wgs84"==t.crs)switch(i.layer){default:case"img_d":f="http://www.google.cn/maps/vt?lyrs=s&x={x}&y={y}&z={z}"}else switch(i.layer){case"vec":default:f="http://mt{s}.google.cn/vt/lyrs=m@207000000&hl=zh-CN&gl=CN&src=app&x={x}&y={y}&z={z}&s=Galile";break;case"img_d":f="http://mt{s}.google.cn/vt/lyrs=s&hl=zh-CN&gl=CN&x={x}&y={y}&z={z}&s=Gali";break;case"img_z":f="http://mt{s}.google.cn/vt/imgtp=png32&lyrs=h@207000000&hl=zh-CN&gl=cn&x={x}&y={y}&z={z}&s=Galil";break;case"ter":f="http://mt{s}.google.cn/vt/lyrs=t@131,r@227000000&hl=zh-CN&gl=cn&x={x}&y={y}&z={z}&s=Galile"}o=new s.default.UrlTemplateImageryProvider({url:i.proxy?new s.default.Resource({url:f,proxy:i.proxy}):f,subdomains:["1","2","3"],maximumLevel:20});break;case"www_osm":var f="http://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png";o=new s.default.UrlTemplateImageryProvider({url:i.proxy?new s.default.Resource({url:f,proxy:i.proxy}):f,subdomains:"abc",maximumLevel:18});break;case"www_bing":var f="https://dev.virtualearth.net",p=i.layer||s.default.BingMapsStyle.Aerial;o=new s.default.BingMapsImageryProvider({url:i.proxy?new s.default.Resource({url:f,proxy:i.proxy}):f,key:i.key||"AtkX3zhnRe5fyGuLU30uZw8r3sxdBDnpQly7KfFTCB2rGlDgXBG3yr-qEiQEicEc",mapStyle:p});break;case"custom_grid":o=new s.default.GridImageryProvider;break;case"custom_tilecoord":o=new s.default.TileCoordinatesImageryProvider;break;case"custom_featuregrid":o=new M.FeatureGridImageryProvider(i);break;default:console.log("config配置图层未处理:"+t)}return o.config=i,o}function a(t){return t[Math.floor(Math.random()*t.length+1)-1]}var o=i(0),s=function(t){return t&&t.__esModule?t:{default:t}}(o),l=i(4),u=i(7),c=i(45),d=i(30),h=i(46),f=i(23),p=i(48),g=i(49),m=i(19),y=i(50),v=i(51),_=i(52),w=i(53),b=i(54),C=i(55),x=i(56),P=i(80),M=i(81);e.createLayer=n,e.createImageryProvider=r,e.BaseLayer=u.BaseLayer,e.GroupLayer=c.GroupLayer,e.TileLayer=d.TileLayer,e.GltfLayer=v.GltfLayer,e.Tiles3dLayer=_.Tiles3dLayer,e.GeoJsonLayer=m.GeoJsonLayer,e.ArcFeatureLayer=y.ArcFeatureLayer,e.KmlLayer=w.KmlLayer,e.CzmlLayer=b.CzmlLayer,e.TerrainLayer=C.TerrainLayer,e.DrawLayer=x.DrawLayer,e.CustomFeatureGridLayer=f.CustomFeatureGridLayer,e.ArcFeatureGridLayer=p.ArcFeatureGridLayer,e.POILayer=g.POILayer},function(t,e,i){"use strict";function n(t){return t&&t.__esModule?t:{default:t}}Object.defineProperty(e,"__esModule",{value:!0}),e.CustomFeatureGridLayer=void 0;var r=i(0),a=n(r),o=i(5),s=n(o),l=i(4),u=i(47),c=i(15),d=i(13),h=i(11),f=i(16),p=u.FeatureGridLayer.extend({_cacheGrid:{},_cacheFeature:{},_addImageryCache:function(t){this._cacheGrid[t.key]={opts:t,isLoading:!0};var e=this;this.getDataForGrid(t,function(i){e._visible&&e._showData(t,i)})},getDataForGrid:function(t,e){this.config.getDataForGrid&&this.config.getDataForGrid(t,e)},checkHasBreak:function(t){return!this._visible||!this._cacheGrid[t]},_showData:function(t,e){var i=t.key;if(!this.checkHasBreak[i]){for(var n=this,r=[],a=0,o=e.length;a<o;a++){var s=e[a],l=s[this.config.IdName||"id"],u=this._cacheFeature[l];if(u)u.grid.push(i),this.updateEntity(u.entity,s);else{var c=this.createEntity(t,s,function(t){n.config.debuggerTileInfo&&(t._temp_id=l,t.popup=function(t){return JSON.stringify(n._cacheFeature[t._temp_id].grid)}),n._cacheFeature[l]={grid:[i],entity:t}});null!=c&&(n.config.debuggerTileInfo&&(c._temp_id=l,c.popup=function(t){return JSON.stringify(n._cacheFeature[t._temp_id].grid)}),n._cacheFeature[l]={grid:[i],entity:c})}r.push(l)}this._cacheGrid[i]=this._cacheGrid[i]||{},this._cacheGrid[i].ids=r,this._cacheGrid[i].isLoading=!1}},createEntity:function(t,e,i){return this.config.createEntity?this.config.createEntity(t,e,i):null},updateEntity:function(t,e){this.config.updateEntity&&this.config.updateEntity(t,e)},removeEntity:function(t){this.config.removeEntity?this.config.removeEntity(t):this.dataSource.entities.remove(t)},_removeImageryCache:function(t){var e=t.key,i=this._cacheGrid[e];if(i){if(i.ids)for(var n=0;n<i.ids.length;n++){var r=i.ids[n],a=this._cacheFeature[r];a&&(a.grid.remove(e),0==a.grid.length&&(delete this._cacheFeature[r],this.removeEntity(a.entity)))}delete this._cacheGrid[e]}},_removeAllImageryCache:function(){this.config.removeAllEntity?this.config.removeAllEntity():(this.dataSource.entities.removeAll(),this.primitives.removeAll()),this._cacheFeature={},this._cacheGrid={}},removeEx:function(){this.config.removeAllEntity?this.config.removeAllEntity():(this.dataSource.entities.removeAll(),this.primitives.removeAll()),this._cacheFeature={},this._cacheGrid={},this.viewer.dataSources.remove(this.dataSource),this.viewer.scene.primitives.remove(this.primitives)},reload:function(){var t=this;for(var e in this._cacheGrid){var i=this._cacheGrid[e];if(null!=i&&null!=i.opts&&!i.isLoading){var n=i.opts;this.getDataForGrid(n,function(e){t._showData(n,e)})}}},hasOpacity:!0,_opacity:1,setOpacity:function(t){this._opacity=t;for(var e in this._cacheFeature){var i=this._cacheFeature[e].entity;i.polygon&&i.polygon.material&&i.polygon.material.color?(this._updatEntityAlpha(i.polygon.material.color,this._opacity),i.polygon.outlineColor&&this._updatEntityAlpha(i.polygon.outlineColor,this._opacity)):i.polyline&&i.polyline.material&&i.polyline.material.color?this._updatEntityAlpha(i.polyline.material.color,this._opacity):i.billboard&&(i.billboard.color=new a.default.Color.fromCssColorString("#FFFFFF").withAlpha(this._opacity),i.label&&(i.label.fillColor&&this._updatEntityAlpha(i.label.fillColor,this._opacity),i.label.outlineColor&&this._updatEntityAlpha(i.label.outlineColor,this._opacity),i.label.backgroundColor&&this._updatEntityAlpha(i.label.backgroundColor,this._opacity)))}},_updatEntityAlpha:function(t,e){var i=t.getValue().withAlpha(e);t.setValue(i)},colorHash:{},setDefSymbol:function(t){if(t.polygon){var e=t.properties.OBJECTID,i=this.colorHash[e];i||(i=a.default.Color.fromRandom({minimumGreen:.75,maximumBlue:.75,alpha:this._opacity}),this.colorHash[e]=i),t.polygon.material=i,t.polygon.outline=!0,t.polygon.outlineColor=a.default.Color.WHITE}else if(t.polyline){var e=t.properties.OBJECTID,i=this.colorHash[e];i||(i=a.default.Color.fromRandom({minimumGreen:.75,maximumBlue:.75,alpha:this._opacity}),this.colorHash[e]=i),t.polyline.material=i,t.polyline.width=2}else t.billboard&&(t.billboard.scale=.5,t.billboard.horizontalOrigin=a.default.HorizontalOrigin.CENTER,t.billboard.verticalOrigin=a.default.VerticalOrigin.BOTTOM)},setConfigSymbol:function(t,e){var i=t.properties,n=e.styleOptions;if(e.styleField){var r=i[e.styleField],o=e.styleFieldOptions[r];null!=o&&(n=(0,l.clone)(n),n=s.default.extend(n,o))}if("function"==typeof e.calback){var o=e.calback(i,t,e);if(!o)return;n=(0,l.clone)(n),n=s.default.extend(n,o)}if(n=n||{},this._opacity=n.opacity||1,t.polygon){if((0,f.style2Entity)(n,t.polygon),n.outlineWidth&&n.outlineWidth>1){t.polygon.outline=!1;var u={color:n.outlineColor,width:n.outlineWidth,opacity:n.outlineOpacity,lineType:"solid",outline:!1},p=(0,h.style2Entity)(u);p.positions=t.polygon.hierarchy._value.positions,this.dataSource.entities.add({polyline:p})}if(this.config.buildings){var g=Number(i[this.config.buildings.cloumn]||1),m=Number(this.config.buildings.height||5);t.polygon.extrudedHeight=g*m}}else t.polyline?(0,h.style2Entity)(n,t.polyline):t.billboard&&(t.billboard.heightReference=a.default.HeightReference.RELATIVE_TO_GROUND,(0,c.style2Entity)(n,t.billboard),n.label&&n.label.field&&(n.label.heightReference=a.default.HeightReference.RELATIVE_TO_GROUND,t.label=(0,d.style2Entity)(n.label),t.label.text=i[n.label.field]))}});e.CustomFeatureGridLayer=p},function(t,e,i){"use strict";function n(t,e){t=t||{},null==e&&(e={});for(var i in t){var n=t[i];switch(i){default:e[i]=n;break;case"opacity":case"outlineOpacity":case"scaleByDistance_near":case"scaleByDistance_nearValue":case"scaleByDistance_far":case"scaleByDistance_farValue":case"distanceDisplayCondition_far":case"distanceDisplayCondition_near":break;case"outlineColor":e.outlineColor=new l.default.Color.fromCssColorString(n||"#FFFF00").withAlpha(t.outlineOpacity||t.opacity||1);break;case"color":e.color=new l.default.Color.fromCssColorString(n||"#FFFF00").withAlpha(Number(t.opacity||1));break;case"scaleByDistance":e.scaleByDistance=n?new l.default.NearFarScalar(Number(t.scaleByDistance_near||1e3),Number(t.scaleByDistance_nearValue||1),Number(t.scaleByDistance_far||1e6),Number(t.scaleByDistance_farValue||.1)):null;break;case"distanceDisplayCondition":e.distanceDisplayCondition=n?new l.default.DistanceDisplayCondition(Number(t.distanceDisplayCondition_near||0),Number(t.distanceDisplayCondition_far||1e5)):null;break;case"heightReference":switch(n){case"NONE":e.heightReference=l.default.HeightReference.NONE;break;case"CLAMP_TO_GROUND":e.heightReference=l.default.HeightReference.CLAMP_TO_GROUND;break;case"RELATIVE_TO_GROUND":e.heightReference=l.default.HeightReference.RELATIVE_TO_GROUND;break;default:e.heightReference=n}}}return t.outline||(e.outlineWidth=0),e}function r(t){return[t.position.getValue()]}function a(t){var e=r(t);return c.cartesians2lonlats(e)}function o(t){var e=a(t);return{type:"Feature",properties:t.attribute||{},geometry:{type:"Point",coordinates:e[0]}}}Object.defineProperty(e,"__esModule",{value:!0}),e.style2Entity=n,e.getPositions=r,e.getCoordinates=a,e.toGeoJSON=o;var s=i(0),l=function(t){return t&&t.__esModule?t:{default:t}}(s),u=i(2),c=function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e.default=t,e}(u)},function(t,e,i){"use strict";function n(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e.default=t,e}Object.defineProperty(e,"__esModule",{value:!0}),e.Draw=void 0;var r=i(0),a=function(t){return t&&t.__esModule?t:{default:t}}(r),o=i(57),s=i(3),l=i(4),u=n(l),c=i(2),d=n(c),h=i(8),f=n(h),p=i(20),g=i(59),m=i(60),y=i(61),v=i(9),_=i(62),w=i(64),b=i(66),C=i(69),x=i(70),P=i(72),M=i(74),E=i(76),L=i(78),S=e.Draw=o.Evented.extend({dataSource:null,primitives:null,drawCtrl:null,initialize:function(t,e){this.viewer=t,this.options=e||{},this.dataSource=new a.default.CustomDataSource,this.viewer.dataSources.add(this.dataSource),this.primitives=new a.default.PrimitiveCollection,this.viewer.scene.primitives.add(this.primitives),a.default.defaultValue(this.options.removeScreenSpaceEvent,!0)&&(this.viewer.screenSpaceEventHandler.removeInputAction(a.default.ScreenSpaceEventType.LEFT_DOUBLE_CLICK),this.viewer.screenSpaceEventHandler.removeInputAction(a.default.ScreenSpaceEventType.LEFT_CLICK)),this.tooltip=new s.Tooltip(this.viewer.container),this.hasEdit(a.default.defaultValue(this.options.hasEdit,!0));var i={viewer:this.viewer,dataSource:this.dataSource,primitives:this.primitives,tooltip:this.tooltip};this.drawCtrl={},this.drawCtrl.point=new p.DrawPoint(i),this.drawCtrl.billboard=new g.DrawBillboard(i),this.drawCtrl.label=new m.DrawLabel(i),this.drawCtrl.model=new y.DrawModel(i),this.drawCtrl.polyline=new v.DrawPolyline(i),this.drawCtrl.curve=new _.DrawCurve(i),this.drawCtrl.polylineVolume=new w.DrawPolylineVolume(i),this.drawCtrl.corridor=new b.DrawCorridor(i),this.drawCtrl.polygon=new C.DrawPolygon(i),this.drawCtrl.rectangle=new x.DrawRectangle(i),this.drawCtrl.ellipse=new P.DrawCircle(i),this.drawCtrl.circle=this.drawCtrl.ellipse,this.drawCtrl.ellipsoid=new M.DrawEllipsoid(i),this.drawCtrl.wall=new E.DrawWall(i),this.drawCtrl["model-p"]=new L.DrawPModel(i);var n=this;for(var r in this.drawCtrl)this.drawCtrl[r]._fire=function(t,e,i){n.fire(t,e,i)};this.on(f.DrawCreated,function(t){this.startEditing(t.entity)},this)},startDraw:function(t){if("string"==typeof t)t={type:t};else if(null==t||null==t.type)return void console.error("需要传入指定绘制的type类型！");var e=t.type;if(null==this.drawCtrl[e])return void console.error("不能进行type为【"+e+"】的绘制，无该类型！");var i;return t.success&&(i=t.success,delete t.success),t=d.addGeoJsonDefVal(t),this.stopDraw(),this.drawCtrl[e].activate(t,i)},stopDraw:function(){this.stopEditing();for(var t in this.drawCtrl)this.drawCtrl[t].disable(!0)},clearDraw:function(){this.stopDraw(),this.dataSource.entities.removeAll(),this.primitives.removeAll()},currEditFeature:null,getCurrentEntity:function(){return this.currEditFeature},_hasEdit:null,hasEdit:function(t){null!==this._hasEdit&&this._hasEdit===t||(this._hasEdit=t,t?this.bindSelectEvent():(this.stopEditing(),this.destroySelectEvent()))},bindSelectEvent:function(){var t=this,e=new a.default.ScreenSpaceEventHandler(this.viewer.scene.canvas);e.setInputAction(function(e){var i=t.viewer.scene.pick(e.position);if(a.default.defined(i)){var n=i.id||i.primitive.id||i.primitive;if(n&&t.isMyEntity(n)){if(t.currEditFeature&&t.currEditFeature===n)return;if(!a.default.defaultValue(n.inProgress,!1))return void t.startEditing(n)}}t.stopEditing()},a.default.ScreenSpaceEventType.LEFT_CLICK),e.setInputAction(function(e){if(t._hasEdit){t.tooltip.setVisible(!1);var i=t.viewer.scene.pick(e.endPosition);if(a.default.defined(i)){var n=i.id||i.primitive.id||i.primitive;if(n&&n.editing&&!a.default.defaultValue(n.inProgress,!1)&&t.isMyEntity(n)){var r=t.tooltip;setTimeout(function(){r.showAt(e.endPosition,s.message.edit.start)},100)}}}},a.default.ScreenSpaceEventType.MOUSE_MOVE),this.selectHandler=e},destroySelectEvent:function(){this.selectHandler&&this.selectHandler.destroy(),this.selectHandler=void 0},startEditing:function(t){this.stopEditing(),null!=t&&this._hasEdit&&(t.editing&&t.editing.activate&&t.editing.activate(),this.currEditFeature=t)},stopEditing:function(){this.currEditFeature&&this.currEditFeature.editing&&this.currEditFeature.editing.disable&&this.currEditFeature.editing.disable(),this.currEditFeature=null},updateAttribute:function(t,e){if(null==e&&(e=this.currEditFeature),null!=e&&null!=t){t.style=t.style||{},t.attr=t.attr||{};var i=e.attribute.type;if(this.drawCtrl[i].style2Entity(t.style,e),e.attribute=t,e.editing&&(e.editing.updateAttrForEditing&&e.editing.updateAttrForEditing(),e.editing.updateDraggers&&e.editing.updateDraggers()),this.options.nameTooltip){var n=this;e.attribute.attr&&e.attribute.attr.name?e.tooltip={html:e.attribute.attr.name,check:function(){return!n._hasEdit}}:e.tooltip=null}return e}},setPositions:function(t,e){if(null==e&&(e=this.currEditFeature),null!=e&&null!=t)return e.editing&&(e.editing.setPositions(t),e.editing.updateDraggers()),e},deleteEntity:function(t){null==t&&(t=this.currEditFeature),null!=t&&(t.editing&&t.editing.disable(),this.dataSource.entities.contains(t)&&this.dataSource.entities.remove(t),this.primitives.contains(t)&&this.primitives.remove(t))},isMyEntity:function(t){return!!this.dataSource.entities.contains(t)||!!this.primitives.contains(t)},deleteAll:function(){this.clearDraw()},toGeoJSON:function(t){if(this.stopDraw(),null==t){var e=this.getEntitys();if(0==e.length)return null;for(var i=[],n=0,r=e.length;n<r;n++){var t=e[n];if(null!=t.attribute&&null!=t.attribute.type){var a=t.attribute.type,o=this.drawCtrl[a].toGeoJSON(t);null!=o&&(o=d.removeGeoJsonDefVal(o),i.push(o))}}return i.length>0?{type:"FeatureCollection",features:i}:null}var a=t.attribute.type,o=this.drawCtrl[a].toGeoJSON(t);return o=d.removeGeoJsonDefVal(o)},jsonToEntity:function(t,e,i){var n=t;try{u.isString(t)&&(n=JSON.parse(t))}catch(t){return void u.alert(t.name+": "+t.message+" \n请确认json文件格式正确!!!")}e&&this.clearDraw();for(var r=[],a=n.features?n.features:[n],o=0,s=a.length;o<s;o++){var l=a[o];if(!l.properties||!l.properties.type)switch(l.properties=l.properties||{},l.geometry.type){case"MultiPolygon":case"Polygon":l.properties.type="polygon";break;case"MultiLineString":case"LineString":l.properties.type="polyline";break;case"MultiPoint":case"Point":l.properties.type="point"}var c=l.properties.type;if(null!=this.drawCtrl[c]){l.properties.style=l.properties.style||{},l.properties=d.addGeoJsonDefVal(l.properties);var h=this.drawCtrl[c].jsonToEntity(l);if(this.options.nameTooltip)if(h.attribute.attr&&h.attribute.attr.name){var f=this;h.tooltip={html:h.attribute.attr.name,check:function(){return!f._hasEdit}}}else h.tooltip=null;r.push(h)}else console.log("数据无法识别或者数据的["+c+"]类型参数有误")}return i&&this.viewer.flyTo(r),r},attributeToEntity:function(t,e){return this.drawCtrl[t.type].attributeToEntity(t,e)},bindExtraEntity:function(t,e){var t=this.drawCtrl[e.type].attributeToEntity(t,e);this.dataSource.entities.add(t)},_visible:!0,setVisible:function(t){this._visible=t,t?(this.viewer.dataSources.contains(this.dataSource)||this.viewer.dataSources.add(this.dataSource),this.viewer.scene.primitives.contains(this.primitives)||this.viewer.scene.primitives.add(this.primitives)):(this.stopDraw(),this.viewer.dataSources.contains(this.dataSource)&&this.viewer.dataSources.remove(this.dataSource,!1),this.viewer.scene.primitives.contains(this.dataSource)&&this.viewer.scene.primitives.remove(this.primitives))},hasDraw:function(){return this.getEntitys().length>0},getEntitys:function(){this.stopDraw();var t=this.dataSource.entities.values;return t=t.concat(this.primitives._primitives)},getDataSource:function(){return this.dataSource},getEntityById:function(t){for(var e=this.getEntitys(),i=0,n=e.length;i<n;i++){var r=e[i];if(t==r.attribute.attr.id)return r}return null},getCoordinates:function(t){var e=t.attribute.type;return this.drawCtrl[e].getCoordinates(t)},getPositions:function(t){var e=t.attribute.type;return this.drawCtrl[e].getPositions(t)},destroy:function(){this.stopDraw(),this.hasEdit(!1),this.clearDraw(),this.viewer.dataSources.contains(this.dataSource)&&this.viewer.dataSources.remove(this.dataSource,!0)}});S.Point=p.DrawPoint,S.Billboard=g.DrawBillboard,S.Label=m.DrawLabel,S.Model=y.DrawModel,S.Polyline=v.DrawPolyline,S.Curve=_.DrawCurve,S.PolylineVolume=w.DrawPolylineVolume,S.Polygon=C.DrawPolygon,S.Rectangle=x.DrawRectangle,S.Circle=P.DrawCircle,S.Ellipsoid=M.DrawEllipsoid,S.Wall=E.DrawWall},function(t,e,i){"use strict";function n(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e.default=t,e}Object.defineProperty(e,"__esModule",{value:!0}),e.DrawBase=void 0;var r=i(0),a=function(t){return t&&t.__esModule?t:{default:t}}(r),o=(i(1),i(10)),s=i(2),l=n(s),u=i(8),c=n(u);e.DrawBase=o.Class.extend({type:null,dataSource:null,initialize:function(t){this.viewer=t.viewer,this.dataSource=t.dataSource,this.primitives=t.primitives,this.dataSource||(this.dataSource=new a.default.CustomDataSource,viewer.dataSources.add(this.dataSource)),this.tooltip=t.tooltip||new Tooltip(this.viewer.container)},fire:function(t,e,i){this._fire&&this._fire(t,e,i)},formatNum:function(t,e){return l.formatNum(t,e)},activate:function(t,e){return this._enabled?this:(this._enabled=!0,this.drawOkCalback=e,this.createFeature(t),this.entity.inProgress=!0,this.setCursor(!0),this.bindEvent(),this.fire(c.DrawStart,{drawtype:this.type,entity:this.entity}),this.entity)},disable:function(t){return this._enabled?(this._enabled=!1,this.setCursor(!1),t&&this.entity.inProgress?(this.dataSource&&this.dataSource.entities.contains(this.entity)&&this.dataSource.entities.remove(this.entity),this.primitives&&this.primitives.contains(this.entity)&&this.primitives.remove(this.entity)):(this.entity.inProgress=!1,this.finish(),this.drawOkCalback&&(this.drawOkCalback(this.entity),delete this.drawOkCalback),this.fire(c.DrawCreated,{drawtype:this.type,entity:this.entity})),this.destroyHandler(),this._positions_draw=null,this.entity=null,this.tooltip.setVisible(!1),this):this},createFeature:function(t){},getHandler:function(){return this.handler&&!this.handler.isDestroyed()||(this.handler=new a.default.ScreenSpaceEventHandler(this.viewer.scene.canvas)),this.handler},destroyHandler:function(){this.handler&&this.handler.destroy(),this.handler=void 0},setCursor:function(t){this.viewer._container.style.cursor=t?"crosshair":""},bindEvent:function(){},_positions_draw:null,getDrawPosition:function(){return this._positions_draw},_bindEdit:function(t){return t._fire=this._fire,t.tooltip=this.tooltip,t},updateAttrForDrawing:function(){},finish:function(){},getCoordinates:function(t){return this.getAttrClass().getCoordinates(t)},getPositions:function(t){return this.getAttrClass().getPositions(t)},toGeoJSON:function(t){return this.getAttrClass().toGeoJSON(t)},attributeToEntity:function(t,e){var i=this.createFeature(t);return this._positions_draw=e,this.updateAttrForDrawing(!0),this.finish(),i},jsonToEntity:function(t){var e=t.properties,i=l.getPositionByGeoJSON(t);return this.attributeToEntity(e,i)},bindExtraEntity:function(t,e){return e&&e.style&&this.style2Entity(e.style,t),this._positions_draw=this.getPositions(t),this.updateAttrForDrawing(!0),this.finish(),t}})},function(t,e,i){"use strict";function n(t,e){t=t||{},null==e&&(e={});for(var i in t){var n=t[i];switch(i){default:e[i]=n;break;case"silhouette":case"silhouetteColor":case"silhouetteAlpha":case"silhouetteSize":case"fill":case"color":case"opacity":break;case"modelUrl":e.uri=n;break;case"heightReference":switch(n){case"NONE":e.heightReference=l.default.HeightReference.NONE;break;case"CLAMP_TO_GROUND":e.heightReference=l.default.HeightReference.CLAMP_TO_GROUND;break;case"RELATIVE_TO_GROUND":e.heightReference=l.default.HeightReference.RELATIVE_TO_GROUND;break;default:e.heightReference=n}}}t.silhouette?(e.silhouetteColor=new l.default.Color.fromCssColorString(t.silhouetteColor||"#FFFFFF").withAlpha(Number(t.silhouetteAlpha||1)),e.silhouetteSize=Number(t.silhouetteSize||1)):e.silhouetteSize=0;var r=t.hasOwnProperty("opacity")?Number(t.opacity):1;return t.fill?e.color=new l.default.Color.fromCssColorString(t.color||"#FFFFFF").withAlpha(r):e.color=new l.default.Color.fromCssColorString("#FFFFFF").withAlpha(r),e}function r(t){var e=t.position;return e&&e.getValue&&(e=e.getValue()),[e]}function a(t){var e=r(t);return c.cartesians2lonlats(e)}function o(t){var e=a(t);return{type:"Feature",properties:t.attribute||{},geometry:{type:"Point",coordinates:e[0]}}}Object.defineProperty(e,"__esModule",{value:!0}),e.style2Entity=n,e.getPositions=r,e.getCoordinates=a,e.toGeoJSON=o;var s=i(0),l=function(t){return t&&t.__esModule?t:{default:t}}(s),u=i(2),c=function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e.default=t,e}(u)},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.EditPolygon=void 0;var n=i(0),r=function(t){return t&&t.__esModule?t:{default:t}}(n),a=i(6),o=function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e.default=t,e}(a),s=i(3),l=i(14),u=i(1);e.EditPolygon=l.EditPolyline.extend({changePositionsToCallback:function(){this._positions_draw=this.entity._positions_draw||this.entity.polygon.hierarchy.getValue()},finish:function(){this.entity._positions_draw=this.getPosition()},isClampToGround:function(){return this.entity.attribute.style.hasOwnProperty("clampToGround")?this.entity.attribute.style.clampToGround:!this.entity.attribute.style.perPositionHeight},bindDraggers:function(){for(var t=this,e=this.getPosition(),i=e.length<this._maxPointNum,n=this.isClampToGround(),a=0,l=e.length;a<l;a++){var c=e[a];n&&(c=(0,u.updateHeightForClampToGround)(c),e[a]=c);var d=o.createDragger(this.dataSource,{position:c,onDrag:function(a,o){if(e[a.index]=o,t.heightDraggers&&t.heightDraggers.length>0){var s=t.entity.polygon.extrudedHeight.getValue();t.heightDraggers[a.index].position=(0,u.setPositionsHeight)(o,s)}if(i){var c,d;0==a.index?(c=2*l-1,d=l-1):(c=2*a.index-1,d=a.index-1);var h=r.default.Cartesian3.midpoint(o,e[d],new r.default.Cartesian3);n&&(h=(0,u.updateHeightForClampToGround)(h)),t.draggers[c].position=h,a.index==l-1?(c=2*a.index+1,d=0):(c=2*a.index+1,d=a.index+1);var h=r.default.Cartesian3.midpoint(o,e[d],new r.default.Cartesian3);n&&(h=(0,u.updateHeightForClampToGround)(h)),t.draggers[c].position=h}}});if(d.index=a,this.draggers.push(d),i){var h=(a+1)%l,f=r.default.Cartesian3.midpoint(c,e[h],new r.default.Cartesian3);n&&(f=(0,u.updateHeightForClampToGround)(f));var p=o.createDragger(this.dataSource,{position:f,type:o.PointType.AddMidPoint,tooltip:s.message.dragger.addMidPoint,onDragStart:function(t,i){e.splice(t.index,0,i)},onDrag:function(t,i){e[t.index]=i},onDragEnd:function(e,i){t.updateDraggers()}});p.index=h,this.draggers.push(p)}}this.entity.polygon.extrudedHeight&&this.bindHeightDraggers(this.entity.polygon)},heightDraggers:null,bindHeightDraggers:function(t,e){var i=this;this.heightDraggers=[],e=e||this.getPosition();for(var n=t.extrudedHeight.getValue(),a=0,l=e.length;a<l;a++){var c=e[a];c=(0,u.setPositionsHeight)(c,n);var d=o.createDragger(this.dataSource,{position:c,type:o.PointType.MoveHeight,tooltip:s.message.dragger.moveHeight,onDrag:function(e,n){var a=r.default.Cartographic.fromCartesian(n).height;t.extrudedHeight=a;var o=(0,u.getMaxHeight)(i.getPosition());i.entity.attribute.style.extrudedHeight=i.formatNum(a-o,2),i.updateHeightDraggers(a)}});this.draggers.push(d),this.heightDraggers.push(d)}},updateHeightDraggers:function(t){for(var e=0;e<this.heightDraggers.length;e++){var i=this.heightDraggers[e],n=(0,u.setPositionsHeight)(i.position.getValue(),t);i.position.setValue(n)}}})},function(t,e,i){"use strict";function n(t,e){t=t||{},null==e&&(e={fill:!0}),t.clampToGround&&(t.hasOwnProperty("height")&&delete t.height,t.hasOwnProperty("extrudedHeight")&&delete t.extrudedHeight);for(var i in t){var n=t[i];switch(i){default:e[i]=n;break;case"opacity":case"outlineOpacity":break;case"outlineColor":e.outlineColor=new l.default.Color.fromCssColorString(n||"#FFFF00").withAlpha(t.outlineOpacity||t.opacity||1);break;case"color":e.material=new l.default.Color.fromCssColorString(n||"#FFFF00").withAlpha(Number(t.opacity||1));break;case"rotation":e.rotation=l.default.Math.toRadians(n);break;case"height":e.height=Number(n),t.extrudedHeight&&(e.extrudedHeight=Number(t.extrudedHeight)+Number(n));break;case"extrudedHeight":e.extrudedHeight=Number(e.height||t.height||0)+Number(n);break;case"radius":e.semiMinorAxis=Number(n),e.semiMajorAxis=Number(n)}}return null==e.material&&(e.material=l.default.Color.fromRandom({minimumGreen:.75,maximumBlue:.75,alpha:Number(t.opacity||1)})),e}function r(t){return[t.position.getValue()]}function a(t){var e=r(t);return c.cartesians2lonlats(e)}function o(t){var e=a(t);return{type:"Feature",properties:t.attribute||{},geometry:{type:"Point",coordinates:e[0]}}}Object.defineProperty(e,"__esModule",{value:!0}),e.style2Entity=n,e.getPositions=r,e.getCoordinates=a,e.toGeoJSON=o;var s=i(0),l=function(t){return t&&t.__esModule?t:{default:t}}(s),u=i(2),c=function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e.default=t,e}(u)},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.TileLayer=void 0;var n=i(0),r=function(t){return t&&t.__esModule?t:{default:t}}(n),a=i(7),o=i(22),s=a.BaseLayer.extend({layer:null,add:function(){null!=this.layer&&this.remove(),this.addEx();var t=this.createImageryProvider(this.config);if(null!=t){var e=this.config,i={show:!0,alpha:this._opacity};if(e.rectangle&&e.rectangle.xmin&&e.rectangle.xmax&&e.rectangle.ymin&&e.rectangle.ymax){var n=e.rectangle.xmin,a=e.rectangle.xmax,o=e.rectangle.ymin,s=e.rectangle.ymax,l=r.default.Rectangle.fromDegrees(n,o,a,s);this.rectangle=l,i.rectangle=l}e.brightness&&(i.brightness=e.brightness),e.contrast&&(i.contrast=e.contrast),e.hue&&(i.hue=e.hue),e.saturation&&(i.saturation=e.saturation),e.gamma&&(i.gamma=e.gamma),e.maximumAnisotropy&&(i.maximumAnisotropy=e.maximumAnisotropy),e.minimumTerrainLevel&&(i.minimumTerrainLevel=e.minimumTerrainLevel),e.maximumTerrainLevel&&(i.maximumTerrainLevel=e.maximumTerrainLevel),this.layer=new r.default.ImageryLayer(t,i),this.layer.config=this.config,this.viewer.imageryLayers.add(this.layer),this.setZIndex(this.config.order)}},createImageryProvider:function(t){return(0,o.createImageryProvider)(t)},addEx:function(){},remove:function(){null!=this.layer&&(this.removeEx(),this.viewer.imageryLayers.remove(this.layer,!0),this.layer=null)},removeEx:function(){},centerAt:function(t){if(null!=this.layer)if(this.config.extent||this.config.center)this.viewer.mars.centerAt(this.config.extent||this.config.center,{duration:t,isWgs84:!0});else if(this.rectangle)this.viewer.camera.flyTo({destination:this.rectangle,duration:t});else{var e=this.layer.imageryProvider.rectangle;e&&e!=r.default.Rectangle.MAX_VALUE&&e.west>0&&e.south>0&&e.east>0&&e.north>0&&this.viewer.camera.flyTo({destination:e,duration:t})}},hasOpacity:!0,_opacity:1,setOpacity:function(t){this._opacity=t,null!=this.layer&&(this.layer.alpha=t)},hasZIndex:!0,setZIndex:function(t){if(null!=this.layer&&null!=t){this.viewer.imageryLayers.raiseToTop(this.layer);for(var e=this.viewer.imageryLayers._layers,i=e.length-1;i>=0;i--)if(e[i]!=this.layer){var n=e[i].config;n&&n.order&&t<n.order&&this.viewer.imageryLayers.lower(this.layer)}}}});e.TileLayer=s},function(t,e,i){"use strict";function n(t,e){t=t||{},null==e&&(e={});for(var i in t){var n=t[i];switch(i){default:e[i]=n;break;case"opacity":case"outlineOpacity":case"radius":case"shape":break;case"outlineColor":e.outlineColor=new d.default.Color.fromCssColorString(n||"#FFFF00").withAlpha(t.outlineOpacity||t.opacity||1);break;case"color":e.material=new d.default.Color.fromCssColorString(n||"#FFFF00").withAlpha(Number(t.opacity||1))}}switch(t.radius=t.radius||10,t.shape){default:case"pipeline":e.shape=r(t.radius);break;case"circle":e.shape=a(t.radius);break;case"star":e.shape=o(t.radius)}return e}function r(t){for(var e=t/3,i=[],n=0;n<=360;n++){var r=d.default.Math.toRadians(n);i.push(new d.default.Cartesian2(t*Math.cos(r),t*Math.sin(r)))}for(var n=360;n>=0;n--){var r=d.default.Math.toRadians(n);i.push(new d.default.Cartesian2((t-e)*Math.cos(r),(t-e)*Math.sin(r)))}return i}function a(t){for(var e=[],i=0;i<=360;i++){var n=d.default.Math.toRadians(i);e.push(new d.default.Cartesian2(t*Math.cos(n),t*Math.sin(n)))}return e}function o(t,e){for(var e=e||6,i=Math.PI/e,n=2*e,r=new Array(n),a=0;a<n;a++){var o=a%2==0?t:t/3;r[a]=new d.default.Cartesian2(Math.cos(a*i)*o,Math.sin(a*i)*o)}return r}function s(t){return t._positions_draw&&t._positions_draw.length>0?t._positions_draw:t.polylineVolume.positions.getValue()}function l(t){var e=s(t);return f.cartesians2lonlats(e)}function u(t){var e=l(t);return{type:"Feature",properties:t.attribute||{},geometry:{type:"LineString",coordinates:e}}}Object.defineProperty(e,"__esModule",{value:!0}),e.style2Entity=n,e.getPositions=s,e.getCoordinates=l,e.toGeoJSON=u;var c=i(0),d=function(t){return t&&t.__esModule?t:{default:t}}(c),h=i(2),f=function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e.default=t,e}(h)},function(t,e,i){"use strict";function n(t,e){t=t||{},null==e&&(e={fill:!0}),t.clampToGround&&(t.hasOwnProperty("height")&&delete t.height,t.hasOwnProperty("extrudedHeight")&&delete t.extrudedHeight);for(var i in t){var n=t[i];switch(i){default:e[i]=n;break;case"opacity":case"outlineOpacity":break;case"outlineColor":e.outlineColor=new l.default.Color.fromCssColorString(n||"#FFFF00").withAlpha(t.outlineOpacity||t.opacity||1);break;case"height":e.height=Number(n),t.extrudedHeight&&(e.extrudedHeight=Number(t.extrudedHeight)+Number(n));break;case"extrudedHeight":e.extrudedHeight=Number(e.height||t.height||0)+Number(n);break;case"color":e.material=new l.default.Color.fromCssColorString(n||"#FFFF00").withAlpha(Number(t.opacity||1));break;case"image":e.material=new l.default.ImageMaterialProperty({image:t.image,color:new l.default.Color.fromCssColorString("#FFFFFF").withAlpha(Number(t.opacity||1))});break;case"rotation":e.rotation=l.default.Math.toRadians(n),t.stRotation||(e.stRotation=l.default.Math.toRadians(n));break;case"stRotation":e.stRotation=l.default.Math.toRadians(n)}}return null==e.material&&(e.material=l.default.Color.fromRandom({minimumGreen:.75,maximumBlue:.75,alpha:Number(t.opacity||1)})),e}function r(t){if(t._positions_draw&&t._positions_draw.length>0)return t._positions_draw;var e=t.rectangle.coordinates.getValue(),i=t.rectangle.height?t.rectangle.height.getValue():0;return[l.default.Cartesian3.fromRadians(e.west,e.south,i),l.default.Cartesian3.fromRadians(e.east,e.north,i)]}function a(t){var e=r(t);return c.cartesians2lonlats(e)}function o(t){var e=a(t);return{type:"Feature",properties:t.attribute||{},geometry:{type:"MultiPoint",coordinates:e}}}Object.defineProperty(e,"__esModule",{value:!0}),e.style2Entity=n,e.getPositions=r,e.getCoordinates=a,e.toGeoJSON=o;var s=i(0),l=function(t){return t&&t.__esModule?t:{default:t}}(s),u=i(2),c=function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e.default=t,e}(u)},function(t,e,i){"use strict";function n(t,e){t=t||{},null==e&&(e={fill:!0});for(var i in t){var n=t[i];switch(i){default:e[i]=n;break;case"opacity":case"outlineOpacity":case"widthRadii":case"heightRadii":break;case"outlineColor":e.outlineColor=new l.default.Color.fromCssColorString(n||"#FFFF00").withAlpha(t.outlineOpacity||t.opacity||1);break;case"color":e.material=new l.default.Color.fromCssColorString(n||"#FFFF00").withAlpha(Number(t.opacity||1));break;case"extentRadii":var r=t.extentRadii||100,a=t.widthRadii||100,o=t.heightRadii||100;e.radii=new l.default.Cartesian3(r,a,o)}}return null==e.material&&(e.material=l.default.Color.fromRandom({minimumGreen:.75,maximumBlue:.75,alpha:Number(t.opacity||1)})),e}function r(t){return[t.position.getValue()]}function a(t){var e=r(t);return c.cartesians2lonlats(e)}function o(t){var e=a(t);return{type:"Feature",properties:t.attribute||{},geometry:{type:"Point",coordinates:e[0]}}}Object.defineProperty(e,"__esModule",{value:!0}),e.style2Entity=n,e.getPositions=r,e.getCoordinates=a,e.toGeoJSON=o;var s=i(0),l=function(t){return t&&t.__esModule?t:{default:t}}(s),u=i(2),c=function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e.default=t,e}(u)},function(t,e,i){"use strict";function n(t,e){t=t||{},e||(e={fill:!0});for(var i in t){var n=t[i];switch(i){default:e[i]=n;break;case"opacity":case"outlineOpacity":break;case"outlineColor":e.outlineColor=new l.default.Color.fromCssColorString(n||"#FFFF00").withAlpha(t.outlineOpacity||t.opacity||1);break;case"color":e.material=new l.default.Color.fromCssColorString(n||"#FFFF00").withAlpha(Number(t.opacity||1))}}return null==e.material&&(e.material=l.default.Color.fromRandom({minimumGreen:.75,maximumBlue:.75,alpha:Number(t.opacity||1)})),e}function r(t){return t.wall.positions.getValue()}function a(t){var e=r(t);return c.cartesians2lonlats(e)}function o(t){var e=a(t);return{type:"Feature",properties:t.attribute||{},geometry:{type:"LineString",coordinates:e}}}Object.defineProperty(e,"__esModule",{value:!0}),e.style2Entity=n,e.getPositions=r,e.getCoordinates=a,e.toGeoJSON=o;var s=i(0),l=function(t){return t&&t.__esModule?t:{default:t}}(s),u=i(2),c=function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e.default=t,e}(u)},function(t,e,i){"use strict";function n(t,e,i){M=t,e=e||{},k=i||"",A=[],C=e.defaultOptions||{windowOptions:{position:"rt",maxmin:!1,resize:!0},autoDisable:!0,disableOhter:!0},"time"==(x=e.version)&&(x=(new Date).getTime());var n=e.widgetsAtStart;if(n&&n.length>0)for(var r=0;r<n.length;r++){var a=n[r];a.hasOwnProperty("uri")&&""!=a.uri?a.hasOwnProperty("visible")&&!a.visible||(a.autoDisable=!1,a.openAtStart=!0,a._nodebug=!0,o(a),A.push(a)):console.log("widget未配置uri："+JSON.stringify(a))}if(P=e.debugger){var l='<div id="widget-testbar" class="widgetbar animation-slide-bottom no-print-view" >      <div style="height: 30px; line-height:30px;"><b style="color: #4db3ff;">widget测试栏</b>&nbsp;&nbsp;<button  id="widget-testbar-remove"  type="button" class="btn btn-link btn-xs">关闭</button> </div>     <button id="widget-testbar-disableAll" type="button" class="btn btn-info" ><i class="fa fa-globe"></i>漫游</button></div>';(0,T.default)("body").append(l),(0,T.default)("#widget-testbar-remove").click(function(t){_()}),(0,T.default)("#widget-testbar-disableAll").click(function(t){h()})}if((n=e.widgets)&&n.length>0){for(var r=0;r<n.length;r++){var a=n[r];if("group"==a.type){for(var l=' <div class="btn-group dropup">  <button type="button" class="btn btn-primary dropdown-toggle" data-toggle="dropdown" aria-expanded="false"><i class="fa fa-align-justify"></i>'+a.name+' <span class="caret"></span></button> <ul class="dropdown-menu">',u=0;u<a.children.length;u++){var f=a.children[u];f.hasOwnProperty("uri")&&""!=f.uri?(l+=' <li data-widget="'+f.uri+'" class="widget-btn" ><a href="#"><i class="fa fa-star"></i>'+f.name+"</a></li>",o(f),A.push(f)):console.log("widget未配置uri："+JSON.stringify(f))}l+="</ul></div>",P&&!a._nodebug&&(0,T.default)("#widget-testbar").append(l)}else{if(!a.hasOwnProperty("uri")||""==a.uri){console.log("widget未配置uri："+JSON.stringify(a));continue}if(P&&!a._nodebug){var l='<button type="button" class="btn btn-primary widget-btn" data-widget="'+a.uri+'"  > <i class="fa fa-globe"></i>'+a.name+" </button>";(0,T.default)("#widget-testbar").append(l)}o(a),A.push(a)}}P&&(0,T.default)("#widget-testbar .widget-btn").each(function(){(0,T.default)(this).click(function(t){var e=(0,T.default)(this).attr("data-widget");null!=e&&""!=e&&(c(e)?d(e):s(e))})})}for(var r=0;r<A.length;r++){var a=A[r];(a.openAtStart||a.createAtStart)&&R.push(a)}(0,T.default)(window).resize(function(){for(var t=0;t<A.length;t++){var e=A[t];e._class&&e._class.indexResize()}}),g()}function r(){return a(C.windowOptions)}function a(t,e){if(null==t||"object"!=(void 0===t?"undefined":S(t)))return t;if(t.constructor!=Object&&t.constructor!=Array)return t;if(t.constructor==Date||t.constructor==RegExp||t.constructor==Function||t.constructor==String||t.constructor==Number||t.constructor==Boolean)return new t.constructor(t);e=e||new t.constructor;for(var i in t)e[i]=void 0===e[i]?a(t[i],null):e[i];return e}function o(t){if(C)for(var e in C)"windowOptions"==e||t.hasOwnProperty(e)||(t[e]=C[e]);t.path=v(k+t.uri),t.name=t.name||t.label}function s(t,e){null==M&&t.viewer&&n(t.viewer),"string"==typeof t?(t={uri:t},null!=e&&(t.disableOhter=!e)):null==t.uri&&console.error("activate激活widget时需要uri参数！");for(var i,r=0;r<A.length;r++){var a=A[r];if(t.uri==a.uri||a.id&&t.uri==a.id){if(i=a,i.isloading)return i;for(var s in t)"uri"!=s&&(i[s]=t[s]);break}}if(null==i&&(o(t),i=t,A.push(t)),P&&console.log("开始激活widget："+i.uri),i.disableOhter?h(i.uri,i.group):f(i.group,i.uri),i._class)if(i._class.isActivate)if(i._class.update)i._class.update();else{i._class.disableBase();var l=setInterval(function(){i._class.isActivate||(i._class.activateBase(),clearInterval(l))},200)}else i._class.activateBase();else{for(var r=0;r<R.length;r++)if(R[r].uri==i.uri)return R[r];R.push(i),1==R.length&&g()}return i}function l(t){for(var e=0;e<A.length;e++){var i=A[e];if(t==i.uri||t==i.id)return i}}function u(t){var e=l(t);return e?e._class:null}function c(t){var e=u(t);return null!=e&&e.isActivate}function d(t){if(null!=t)for(var e=0;e<A.length;e++){var i=A[e];if(i._class&&(t==i.uri||t==i.id)){i._class.disableBase();break}}}function h(t,e){for(var i=0;i<A.length;i++){var n=A[i];if(e&&n.group==e);else if(!n.autoDisable)continue;(!t||t!=n.uri&&t!=n.id)&&(n._class&&n._class.disableBase())}}function f(t,e){if(null!=t)for(var i=0;i<A.length;i++){var n=A[i];if(n.group==t){if(e&&(e==n.uri||e==n.id))continue;n._class&&n._class.disableBase()}}}function p(t){for(var e=0;e<A.length;e++){t(A[e])}}function g(){if(0!=R.length){if(L)return void setTimeout(g,500);L=!0,E=R[0],E.isloading=!0;var t=E.uri;x&&(-1==t.indexOf("?")?t+="?time="+x:t+="&time="+x),window.NProgress&&NProgress.start(),P&&console.log("开始加载js："+k+t),D.Loader.async([k+t],function(){L=!1,E.isloading=!1,P&&console.log("完成js加载："+k+t),window.NProgress&&NProgress.done(!0),R.shift(),g()})}}function m(t){if(null!=E)return E.isloading=!1,E._class=new t(E,M),E._class.activateBase(),E._class;for(var e=y(),i=0;i<A.length;i++){var n=A[i];if(e.endsWith(n.uri))return n.isloading=!1,n._class=new t(n,M),n._class.activateBase(),n._class}}function y(){for(var t,e=document.scripts,i=e.length-1;i>=0;i--)if(null!=(t=e[i].src)&&""!=t&&-1!=t.indexOf("widgets"))return t;return""}function v(t){var e=t.lastIndexOf("/");return t.substring(0,e+1)}function _(){(0,T.default)("#widget-testbar").remove()}function w(){return x}function b(){return k}Object.defineProperty(e,"__esModule",{value:!0}),e.getBasePath=e.getCacheVersion=e.getDefWindowOptions=e.bindClass=e.removeDebugeBar=e.getClass=e.getWidget=e.eachWidget=e.disableGroup=e.disableAll=e.disable=e.activate=e.isActivate=e.init=void 0;var C,x,P,M,E,L,S="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},O=i(5),T=function(t){return t&&t.__esModule?t:{default:t}}(O),D=i(36),k="",A=[],R=[];e.init=n,e.isActivate=c,e.activate=s,e.disable=d,e.disableAll=h,e.disableGroup=f,e.eachWidget=p,e.getWidget=l,e.getClass=u,e.removeDebugeBar=_,e.bindClass=m,e.getDefWindowOptions=r,e.getCacheVersion=w,e.getBasePath=b},function(t,e,i){"use strict";function n(t){return"complete"===t.readyState||"loaded"===t.readyState}function r(t,e,i){var n=document.createElement("link");n.rel="stylesheet",s(n,i,"css"),n.async=!0,n.href=t,h.appendChild(n)}function a(t,e,i){var n=document.createElement("script");n.charset="utf-8",s(n,i,"js"),n.async=!e.sync,n.src=t,h.appendChild(n)}function o(t,e){var i;t.sheet&&(i=!0),setTimeout(function(){i?e():o(t,e)},20)}function s(t,e,i){function r(){t.onload=t.onreadystatechange=null,t=null,e()}var a="onload"in t;if("css"===i&&(f||!a))return void setTimeout(function(){o(t,e)},1);a?(t.onload=r,t.onerror=function(){t.onerror=null,"css"==i?console.error("该css文件不存在："+t.href):console.error("该js文件不存在："+t.src),r()}):t.onreadystatechange=function(){n(t)&&r()}}function l(t,e,i,n){function o(){var i=e.indexOf(t);i>-1&&e.splice(i,1),0===e.length&&n()}if(!t)return void setTimeout(function(){o()});d.test(t)?r(t,i,o):a(t,i,o)}function u(t,e,i){var n=function(){i&&i()};if(t=Array.prototype.slice.call(t||[]),0===t.length)return void n();for(var r=0,a=t.length;r<a;r++)l(t[r],t,e,n)}function c(t,e){if(n(t))e();else{var i=!1;window.addEventListener("load",function(){i||(e(),i=!0)}),setTimeout(function(){i||(e(),i=!0)},1500)}}Object.defineProperty(e,"__esModule",{value:!0});var d=new RegExp("\\.css"),h=document.head||document.getElementsByTagName("head")[0],f=+navigator.userAgent.replace(/.*(?:AppleWebKit|AndroidWebKit)\/?(\d+).*/i,"$1")<536,p={async:function(t,e){c(document,function(){u(t,{},e)})},sync:function(t,e){c(document,function(){u(t,{sync:!0},e)})}};e.Loader=p},function(t,e,i){"use strict";function n(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e.default=t,e}function r(t){return t&&t.__esModule?t:{default:t}}i(38),i(39);var a=i(0),o=r(a),s=i(40),l=i(22),u=r(l),c=i(18),d=r(c),h=i(12),f=r(h),p=i(17),g=r(p),m=i(1),y=n(m),v=i(4),_=n(v),w=i(82),b=n(w),C=i(83),x=i(84),P=(i(85),i(88)),M=i(89),E=i(90),L=i(91),S=i(25),O=i(92),T=n(O),D=i(8),k=n(D),A=i(3),R=i(2),N=n(R),F=i(6),I=n(F),j=i(10),H=i(35),G=n(H),B=i(93);e.name="MarsGIS for Cesium三维地球框架",e.version="1.7.3",e.author="木遥（QQ 346819890，微信 muyao1987）",e.website="http://cesium.marsgis.cn",e.Class=j.Class,e.createMap=s.createMap,e.layer=u.default,e.pointconvert=d.default,e.latlng=y,e.point=y,e.util=_,e.matrix=b,e.Measure=C.Measure,e.FlowEcharts=x.FlowEcharts,e.AnimationLineMaterialProperty=P.AnimationLineMaterialProperty,e.ElliposidFadeMaterialProperty=M.ElliposidFadeMaterialProperty,e.DivPoint=E.DivPoint,e.TilesEditor=L.TilesEditor,e.Draw=S.Draw,e.draw={},e.draw.util=N,e.draw.event=k,e.draw.tooltip=A.message,e.draw.dragger=I,e.draw.attr=T,e.widget=G,e.widget.BaseWidget=B.BaseWidget,e.L=f.default,e.L.esri=g.default,console.log("当前Cesium版本："+o.default.VERSION+" ， MarsGIS版本："+e.version)},function(t,e){},function(t,e){},function(module,exports,__webpack_require__){"use strict";function _interopRequireWildcard(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e.default=t,e}function _interopRequireDefault(t){return t&&t.__esModule?t:{default:t}}function initMap(id,config,options){function destroy(){_tooltip.destroy(),_popup.destroy()}function getLayer(t,e){null==e&&(e="name");var i=configdata.basemaps;if(i&&i.length>0)for(var n=0;n<i.length;n++){var r=i[n];if(null!=r&&r[e]==t)return r._layer}if((i=configdata.operationallayers)&&i.length>0)for(var n=0;n<i.length;n++){var r=i[n];if(null!=r&&r[e]==t)return r._layer}return null}function getConfig(){return _util.clone(configdata)}function getTerrainProvider(){if(null==stkTerrainProvider){var t=configdata.terrain;t.url&&(configdata.serverURL&&(t.url=t.url.replace("$serverURL$",configdata.serverURL)),t.url=t.url.replace("$hostname$",location.hostname).replace("$host$",location.host)),stkTerrainProvider=_util.getTerrainProvider(t)}return stkTerrainProvider}function hasTerrain(){return null!=stkTerrainProvider&&viewer.terrainProvider!=_util.getEllipsoidTerrain()}function updateTerrainProvider(t){viewer.terrainProvider=t?getTerrainProvider():_util.getEllipsoidTerrain()}function changeBasemap(t){for(var e=configdata.basemaps,i=0;i<e.length;i++){var n=e[i];"group"==n.type&&null==n.layers||null!=n._layer&&(t==n.name||t==n.id?n._layer.setVisible(!0):n._layer.setVisible(!1))}}function getImageryProviderArr(){var providerViewModels=[];window._temp_createImageryProvider=_layer.createImageryProvider;var layersCfg=configdata.basemaps;if(layersCfg&&layersCfg.length>0)for(var i=0;i<layersCfg.length;i++){var item=layersCfg[i];if("group"!=item.type||null!=item.layers){var funstr="window._temp_basemaps"+i+" = function () {                        var item = "+JSON.stringify(item)+';                        if (item.type == "group") {                            var arrVec = [];                            for (var index = 0; index < item.layers.length; index++) {                                var temp = window._temp_createImageryProvider(item.layers[index]);                                if (temp == null) continue;                                arrVec.push(temp);                            }                            return arrVec;                        }                        else {                            return window._temp_createImageryProvider(item);                        }                     }';eval(funstr);var imgModel=new _Cesium2.default.ProviderViewModel({name:item.name||"未命名",tooltip:item.name||"未命名",iconUrl:item.icon||"",creationFunction:eval("window._temp_basemaps"+i)});providerViewModels.push(imgModel)}}return providerViewModels}function getTerrainProviderViewModelsArr(){return[new _Cesium2.default.ProviderViewModel({name:"无地形",iconUrl:_Cesium2.default.buildModuleUrl("Widgets/Images/TerrainProviders/Ellipsoid.png"),tooltip:"WGS84标准椭球，即 EPSG:4326",category:"",creationFunction:function(){return new _Cesium2.default.EllipsoidTerrainProvider({ellipsoid:_Cesium2.default.Ellipsoid.WGS84})}}),new _Cesium2.default.ProviderViewModel({name:"中国地形",iconUrl:_Cesium2.default.buildModuleUrl("Widgets/Images/TerrainProviders/CesiumWorldTerrain.png"),tooltip:"火星科技 提供的高分辨率中国地形",category:"",creationFunction:function(){return getTerrainProvider()}}),new _Cesium2.default.ProviderViewModel({name:"全球地形",iconUrl:_Cesium2.default.buildModuleUrl("Widgets/Images/TerrainProviders/CesiumWorldTerrain.png"),tooltip:"Cesium官方 提供的高分辨率全球地形",category:"",creationFunction:function(){return _util.getTerrainProvider({type:"ion"})}})]}function _centerAtArrItem(t,e){if(t<0||t>=arrCenterTemp.length)return void(e&&e());var i=arrCenterTemp[t];i.onStart&&i.onStart(),centerAt(i,{duration:i.duration,complete:function(){i.onEnd&&i.onEnd();var n=i.stop||1;setTimeout(function(){_centerAtArrItem(++t,e)},1e3*n)}})}function centerAtArr(t,e){arrCenterTemp=t,_centerAtArrItem(0,e)}function centerAt(t,e){if(null==e?e={}:_util.isNumber(e)&&(e={duration:e}),null==t&&(e.isWgs84=!0,t=configdata.extent||configdata.center||{y:17.196575,x:114.184276,z:9377198,heading:0,pitch:-80,roll:0}),t.xmin&&t.xmax&&t.ymin&&t.ymax){var i=t.xmin,n=t.xmax,r=t.ymin,a=t.ymax;if(e.isWgs84){var o=point2map({x:i,y:r});i=o.x,r=o.y;var s=point2map({x:n,y:a});n=s.x,a=s.y}var l=_Cesium2.default.Rectangle.fromDegrees(i,r,n,a);viewer.camera.flyTo({destination:l,duration:e.duration,complete:e.complete})}else{e.isWgs84&&(t=point2map(t));var u=e.minz||2500;viewer.camera.positionCartographic.height<u&&(u=viewer.camera.positionCartographic.height),null!=t.z&&0!=t.z&&(u=t.z),viewer.camera.flyTo({destination:_Cesium2.default.Cartesian3.fromDegrees(t.x,t.y,u),orientation:{heading:_Cesium2.default.Math.toRadians(t.heading||0),pitch:_Cesium2.default.Math.toRadians(t.pitch||-90),roll:_Cesium2.default.Math.toRadians(t.roll||0)},duration:e.duration,complete:e.complete})}}function isFlyAnimation(){return _isFlyAnimation}function openFlyAnimation(t,e){var i=e||point.getCameraView(viewer);_isFlyAnimation=!0,viewer.camera.setView({destination:_Cesium2.default.Cartesian3.fromDegrees(-85.16,13.71,23e6)}),viewer.camera.flyTo({destination:_Cesium2.default.Cartesian3.fromDegrees(i.x,i.y,23e6),duration:2,easingFunction:_Cesium2.default.EasingFunction.LINEAR_NONE,complete:function(){var e=1.2*(i.z||9e4)+8e3;e>23e6&&(e=23e6),viewer.camera.flyTo({destination:_Cesium2.default.Cartesian3.fromDegrees(i.x,i.y,e),complete:function(){centerAt(i,{duration:2,complete:function(){_isFlyAnimation=!1,t&&t()}})}})}})}function rotateAnimation(t,e){var i=point.getCameraView(viewer),n=e/3;viewer.camera.flyTo({destination:_Cesium2.default.Cartesian3.fromDegrees(i.x+120,i.y,i.z),orientation:{heading:_Cesium2.default.Math.toRadians(i.heading),pitch:_Cesium2.default.Math.toRadians(i.pitch),roll:_Cesium2.default.Math.toRadians(i.roll)},duration:n,easingFunction:_Cesium2.default.EasingFunction.LINEAR_NONE,complete:function(){viewer.camera.flyTo({destination:_Cesium2.default.Cartesian3.fromDegrees(i.x+240,i.y,i.z),orientation:{heading:_Cesium2.default.Math.toRadians(i.heading),pitch:_Cesium2.default.Math.toRadians(i.pitch),roll:_Cesium2.default.Math.toRadians(i.roll)},duration:n,easingFunction:_Cesium2.default.EasingFunction.LINEAR_NONE,complete:function(){viewer.camera.flyTo({destination:_Cesium2.default.Cartesian3.fromDegrees(i.x,i.y,i.z),orientation:{heading:_Cesium2.default.Math.toRadians(i.heading),pitch:_Cesium2.default.Math.toRadians(i.pitch),roll:_Cesium2.default.Math.toRadians(i.roll)},duration:n,easingFunction:_Cesium2.default.EasingFunction.LINEAR_NONE,complete:function(){t&&t()}})}})}})}function addLocationWidget(t){(0,_jquery2.default)("#"+viewerDivId).prepend('<div id="location_mars_jwd"  class="location-bar animation-slide-bottom no-print" ></div>'),t.style?(0,_jquery2.default)("#location_mars_jwd").css(t.style):(0,_jquery2.default)("#location_mars_jwd").css({left:viewer.animation?"170px":"0",right:"0",bottom:viewer.timeline?"25px":"0"}),t.format=t.format||"<div>视高：{height}米</div><div>俯仰角：{pitch}度</div><div>方向：{heading}度</div><div>海拔：{z}米</div><div>纬度:{y}</div><div>经度:{x}</div>";var e={};new _Cesium2.default.ScreenSpaceEventHandler(viewer.scene.canvas).setInputAction(function(i){var n=point.getCurrentMousePosition(viewer.scene,i.endPosition);if(n){var r=_Cesium2.default.Cartographic.fromCartesian(n);e.z=r.height.toFixed(1);var a=_Cesium2.default.Math.toDegrees(r.longitude),o=_Cesium2.default.Math.toDegrees(r.latitude);switch(t.crs){default:var s=t.hasOwnProperty("toFixed")?t.toFixed:6;e.x=a.toFixed(s),e.y=o.toFixed(s);break;case"degree":e.x=_util.formatDegree(a),e.y=_util.formatDegree(o);break;case"project":var s=t.hasOwnProperty("toFixed")?t.toFixed:0;e.x=n.x.toFixed(s),e.y=n.y.toFixed(s);break;case"wgs":var s=t.hasOwnProperty("toFixed")?t.toFixed:6,l=point2wgs({x:a,y:o});e.x=l.x.toFixed(s),e.y=l.y.toFixed(s);break;case"wgs-degree":var l=point2wgs({x:a,y:o});e.x=_util.formatDegree(l.x),e.y=_util.formatDegree(l.y)}var u=_util.template(t.format,e);(0,_jquery2.default)("#location_mars_jwd").html(u)}},_Cesium2.default.ScreenSpaceEventType.MOUSE_MOVE),viewer.scene.camera.changed.addEventListener(function(i){if(e.height=viewer.camera.positionCartographic.height.toFixed(1),e.heading=_Cesium2.default.Math.toDegrees(viewer.camera.heading).toFixed(0),e.pitch=_Cesium2.default.Math.toDegrees(viewer.camera.pitch).toFixed(0),null!=e.x){var n=_util.template(t.format,e);(0,_jquery2.default)("#location_mars_jwd").html(n)}})}function addNavigationWidget(t){_Cesium2.default.viewerCesiumNavigationMixin&&(viewer.extend(_Cesium2.default.viewerCesiumNavigationMixin,{defaultResetView:_Cesium2.default.Rectangle.fromDegrees(110,20,120,30),enableZoomControls:!0}),viewer.animation?(0,_jquery2.default)(".distance-legend").css({left:"150px",bottom:"25px",border:"none",background:"rgba(0, 0, 0, 0)","z-index":"992"}):(0,_jquery2.default)(".distance-legend").css({left:"-10px",bottom:"-1px",border:"none",background:"rgba(0, 0, 0, 0)","z-index":"992"}),t.legend&&(0,_jquery2.default)(".distance-legend").css(t.legend),(0,_jquery2.default)(".navigation-controls").hide(),t.compass?(0,_jquery2.default)(".compass").css(t.compass):(0,_jquery2.default)(".compass").css({top:"10px",left:"10px"}))}function getCrs(){return crs}function point2map(t){if("gcj"==crs){var e=_util.clone(t),i=_pointconvert2.default.wgs2gcj([e.x,e.y]);return e.x=i[0],e.y=i[1],e}if("baidu"==crs){var e=_util.clone(t),i=_pointconvert2.default.wgs2bd([e.x,e.y]);return e.x=i[0],e.y=i[1],e}return t}function point2wgs(t){if("gcj"==crs){var e=_util.clone(t),i=_pointconvert2.default.gcj2wgs([e.x,e.y]);return e.x=i[0],e.y=i[1],e}if("baidu"==crs){var e=_util.clone(t),i=_pointconvert2.default.bd2gcj([e.x,e.y]);return e.x=i[0],e.y=i[1],e}return t}var viewer,viewerDivId,configdata,crs;viewerDivId=id,configdata=config;var defoptions={animation:!1,timeline:!1,fullscreenButton:!0,vrButton:!1,geocoder:!1,sceneModePicker:!1,homeButton:!0,navigationHelpButton:!0,navigationInstructionsInitiallyVisible:!1,infoBox:!0,selectionIndicator:!1,shouldAnimate:!0,showRenderLoopErrors:!0,baseLayerPicker:!1};for(var key in configdata)"crs"!==key&&"controls"!==key&&"minzoom"!==key&&"maxzoom"!==key&&"center"!==key&&"style"!==key&&"terrain"!==key&&"basemaps"!==key&&"operationallayers"!==key&&(defoptions[key]=configdata[key]);null==options&&(options={});for(var i in defoptions)options.hasOwnProperty(i)||(options[i]=defoptions[i]);_Cesium2.default.BingMapsApi.defaultKey="AtkX3zhnRe5fyGuLU30uZw8r3sxdBDnpQly7KfFTCB2rGlDgXBG3yr-qEiQEicEc",_Cesium2.default.Ion&&(_Cesium2.default.Ion.defaultAccessToken=configdata.ionToken||"eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJqdGkiOiI1NjM5MjMxOS1lMWVkLTQyNDQtYTM4Yi0wZjA4ZDMxYTlmNDMiLCJpZCI6MTQ4MiwiaWF0IjoxNTI4Njc3NDQyfQ.vVoSexHMqQhKK5loNCv6gCA5d5_z3wE2M0l_rWnIP_w"),_Cesium2.default.AnimationViewModel.defaultTicks=configdata.animationTicks||[.1,.25,.5,1,2,5,10,15,30,60,120,300,600,900,1800,3600],configdata.crs=configdata.crs||"3857",crs=configdata.crs,!0===options.geocoder&&(options.geocoder=new _GaodePOIGeocoder.GaodePOIGeocoder(options.geocoderConfig)),configdata.terrain&&configdata.terrain.visible&&(options.terrainProvider=getTerrainProvider());var hasremoveimagery=!1;if(options.baseLayerPicker?(options.imageryProviderViewModels||(options.imageryProviderViewModels=getImageryProviderArr()),options.terrainProviderViewModels||(options.terrainProviderViewModels=getTerrainProviderViewModelsArr())):null==options.imageryProvider&&(hasremoveimagery=!0,options.imageryProvider=_Cesium2.default.createTileMapServiceImageryProvider({url:_Cesium2.default.buildModuleUrl("Assets/Textures/NaturalEarthII")})),viewer=new _Cesium2.default.Viewer(id,options),viewer.cesiumWidget.creditContainer.style.display="none",viewer.mars={popup:_popup,tooltip:_tooltip,keyboard:function(t,e){t?_firstPerson.bind(viewer,e):_firstPerson.unbind(viewer)},centerAt:centerAt,centerAtArr:centerAtArr,getConfig:getConfig,getLayer:getLayer,changeBasemap:changeBasemap,hasTerrain:hasTerrain,updateTerrainProvider:updateTerrainProvider,isFlyAnimation:isFlyAnimation,openFlyAnimation:openFlyAnimation,rotateAnimation:rotateAnimation,getCrs:getCrs,point2map:point2map,point2wgs:point2wgs,destroy:destroy},hasremoveimagery)for(var imageryLayerCollection=viewer.imageryLayers,length=imageryLayerCollection.length,i=0;i<length;i++){var layer=imageryLayerCollection.get(0);imageryLayerCollection.remove(layer,!0)}viewer.homeButton&&viewer.homeButton.viewModel.command.beforeExecute.addEventListener(function(t){centerAt(),t.cancel=!0}),centerAt(null,{duration:0});var orderlayers=[];if(!options.baseLayerPicker){var layersCfg=configdata.basemaps;if(layersCfg&&layersCfg.length>0)for(var i=0;i<layersCfg.length;i++){var item=layersCfg[i];if(item.visible&&item.crs&&(crs=item.crs),(0,_layer.createLayer)(item,viewer,config.serverURL,options.layerToMap),orderlayers.push(item),"group"==item.type&&item.layers)for(var idx=0;idx<item.layers.length;idx++){var childitem=item.layers[idx];orderlayers.push(childitem)}}}var layersCfg=configdata.operationallayers;if(layersCfg&&layersCfg.length>0)for(var i=0;i<layersCfg.length;i++){var item=layersCfg[i];if((0,_layer.createLayer)(item,viewer,config.serverURL,options.layerToMap),orderlayers.push(item),"group"==item.type&&item.layers)for(var idx=0;idx<item.layers.length;idx++){var childitem=item.layers[idx];orderlayers.push(childitem)}}for(var i=0;i<orderlayers.length;i++){var item=orderlayers[i],order=Number(item.order);isNaN(order)&&(order=i),item.order=order,null!=item._layer&&item._layer.setZIndex(order)}viewer.sceneModePicker&&(viewer.sceneModePicker.viewModel.duration=0),configdata.navigation&&addNavigationWidget(configdata.navigation),configdata.location&&addLocationWidget(configdata.location),options.geocoder&&(options.geocoder.viewer=viewer),_popup.init(viewer),_tooltip.init(viewer);var scene=viewer.scene;if(scene.globe.baseColor=new _Cesium2.default.Color.fromCssColorString(configdata.baseColor||"#546a53"),scene.backgroundColor=scene.globe.baseColor,configdata.style&&(scene.globe.depthTestAgainstTerrain=configdata.style.testTerrain,scene.globe.enableLighting=configdata.style.lighting,scene.skyAtmosphere.show=configdata.style.atmosphere,scene.globe.showGroundAtmosphere=configdata.style.atmosphere,scene.fog.enabled=configdata.style.fog,scene.globe.show=_Cesium2.default.defaultValue(configdata.style.globe,!0),scene.moon.show=_Cesium2.default.defaultValue(configdata.style.moon,scene.globe.show),scene.sun.show=_Cesium2.default.defaultValue(configdata.style.sun,scene.globe.show),scene.skyBox.show=_Cesium2.default.defaultValue(configdata.style.skyBox,scene.globe.show)),scene.screenSpaceCameraController.maximumZoomDistance=configdata.maxzoom||2e7,scene.screenSpaceCameraController.minimumZoomDistance=configdata.minzoom||1,viewer._cesiumWidget._supportsImageRenderingPixelated=_Cesium2.default.FeatureDetection.supportsImageRenderingPixelated(),viewer._cesiumWidget._forceResize=!0,_Cesium2.default.FeatureDetection.supportsImageRenderingPixelated()){for(var _dpr=window.devicePixelRatio;_dpr>=2;)_dpr/=2;viewer.resolutionScale=_dpr}if(viewer.camera.changed.addEventListener(function(){viewer.camera._suspendTerrainAdjustment&&viewer.scene.mode===_Cesium2.default.SceneMode.SCENE3D&&(viewer.camera._suspendTerrainAdjustment=!1,viewer.camera._adjustHeightForTerrain())}),copyright){var viewportQuad=new _Cesium2.default.ViewportQuad;viewportQuad.rectangle=new _Cesium2.default.BoundingRectangle(10,5,103,24),viewer.scene.primitives.add(viewportQuad),viewportQuad.material=new _Cesium2.default.Material({fabric:{type:"Image",uniforms:{color:new _Cesium2.default.Color(1,1,1,1),image:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAGcAAAAYCAYAAADnNePtAAAACXBIWXMAAAsTAAALEwEAmpwYAAAF42lUWHRYTUw6Y29tLmFkb2JlLnhtcAAAAAAAPD94cGFja2V0IGJlZ2luPSLvu78iIGlkPSJXNU0wTXBDZWhpSHpyZVN6TlRjemtjOWQiPz4gPHg6eG1wbWV0YSB4bWxuczp4PSJhZG9iZTpuczptZXRhLyIgeDp4bXB0az0iQWRvYmUgWE1QIENvcmUgNS42LWMxNDIgNzkuMTYwOTI0LCAyMDE3LzA3LzEzLTAxOjA2OjM5ICAgICAgICAiPiA8cmRmOlJERiB4bWxuczpyZGY9Imh0dHA6Ly93d3cudzMub3JnLzE5OTkvMDIvMjItcmRmLXN5bnRheC1ucyMiPiA8cmRmOkRlc2NyaXB0aW9uIHJkZjphYm91dD0iIiB4bWxuczp4bXBNTT0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL21tLyIgeG1sbnM6c3RSZWY9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9zVHlwZS9SZXNvdXJjZVJlZiMiIHhtbG5zOnN0RXZ0PSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvc1R5cGUvUmVzb3VyY2VFdmVudCMiIHhtbG5zOnhtcD0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wLyIgeG1sbnM6ZGM9Imh0dHA6Ly9wdXJsLm9yZy9kYy9lbGVtZW50cy8xLjEvIiB4bWxuczpwaG90b3Nob3A9Imh0dHA6Ly9ucy5hZG9iZS5jb20vcGhvdG9zaG9wLzEuMC8iIHhtcE1NOk9yaWdpbmFsRG9jdW1lbnRJRD0ieG1wLmRpZDo2NzBCMzhDNkMyQjdFNzExOEQ3MUQ1NDIzMjRERTZDQyIgeG1wTU06RG9jdW1lbnRJRD0ieG1wLmRpZDozQ0ZEMzEyOEJEREIxMUU3ODBCOTg1QTM3NDY2NEVEMSIgeG1wTU06SW5zdGFuY2VJRD0ieG1wLmlpZDpmZDk2M2I4ZC01MDdlLTVjNDUtOTg4OS02MmY0NTg2NDhjNGEiIHhtcDpDcmVhdG9yVG9vbD0iQWRvYmUgUGhvdG9zaG9wIENTNSBXaW5kb3dzIiB4bXA6Q3JlYXRlRGF0ZT0iMjAxOC0xMC0yNVQyMDowNzozMyswODowMCIgeG1wOk1vZGlmeURhdGU9IjIwMTgtMTAtMjVUMjA6MjY6MjMrMDg6MDAiIHhtcDpNZXRhZGF0YURhdGU9IjIwMTgtMTAtMjVUMjA6MjY6MjMrMDg6MDAiIGRjOmZvcm1hdD0iaW1hZ2UvcG5nIiBwaG90b3Nob3A6Q29sb3JNb2RlPSIzIiBwaG90b3Nob3A6SUNDUHJvZmlsZT0ic1JHQiBJRUM2MTk2Ni0yLjEiPiA8eG1wTU06RGVyaXZlZEZyb20gc3RSZWY6aW5zdGFuY2VJRD0ieG1wLmlpZDozM0I4MEQ3RkM3QjdFNzExOTE4NkRGNjMwMjlEOTE4MiIgc3RSZWY6ZG9jdW1lbnRJRD0ieG1wLmRpZDo2NzBCMzhDNkMyQjdFNzExOEQ3MUQ1NDIzMjRERTZDQyIvPiA8eG1wTU06SGlzdG9yeT4gPHJkZjpTZXE+IDxyZGY6bGkgc3RFdnQ6YWN0aW9uPSJzYXZlZCIgc3RFdnQ6aW5zdGFuY2VJRD0ieG1wLmlpZDpmZDk2M2I4ZC01MDdlLTVjNDUtOTg4OS02MmY0NTg2NDhjNGEiIHN0RXZ0OndoZW49IjIwMTgtMTAtMjVUMjA6MjY6MjMrMDg6MDAiIHN0RXZ0OnNvZnR3YXJlQWdlbnQ9IkFkb2JlIFBob3Rvc2hvcCBDQyAoV2luZG93cykiIHN0RXZ0OmNoYW5nZWQ9Ii8iLz4gPC9yZGY6U2VxPiA8L3htcE1NOkhpc3Rvcnk+IDwvcmRmOkRlc2NyaXB0aW9uPiA8L3JkZjpSREY+IDwveDp4bXBtZXRhPiA8P3hwYWNrZXQgZW5kPSJyIj8+fps6oAAACQpJREFUaIHtmnuw1VUVxz+Xx+WChTwERXm/EuWpIIkJDYSMgImNFmBTwYB4MRIYsVQkHiZgylgJWmShSC/y0YgCCgr4oEiEgJwUkAgQeRuI6AX59sdavzn77Pv7nXtv0zTNxJrZ89t7rbXXfq/9XfucIklUgroAA4BLgHZAEdAGqAvsBdYBTwFPAscrY/AMVUxFFSxOfeBxYHCK7CBwDGiILRLACWAc8Oh/sI//t1StgGwssIvyC/McdoIaAa2Bs4EmwJ1AbeDnwBP/Rl+KsRP5v041gOr/lZYkpaXHlE4zA50Wkr7o34TXWNIq130ow3ZWmiFpi6SHJX1TUq1K1jtH0uOS7pPUQ1IrSZ8LUntJ50m6XdJ6SV+thO1iSbMlLZXUMJINk3RA0jJJ0yXVSanfRtK3JPWUdFYkayXpO26na6F+pDF/mrEwt7n8S5IWStrk/COSSqMBr3FZnyoszp1BWztSBpWV6kja5fV2yzbQNP/OlHSPpHslvR/YvyPDVlMf5/ZA96lI54ZAtklStRQ7Vwc6hyR1C2RXBLJXCo0tZoxXOi0KdJrIdpUk7Zd0VYrhTi5/rlDjURodtDe+CvVQbjJXFtB5IbDfJeDXljRC0mJJRwOdA7KTvFY2oUmdHoHO9zPaaivpuOu8FMm6BfVnO6+jpIGxnRqBh6sG3Jji+fYCs4PyPuAqz08FXkipsxlYAwwEGgP7K+Fhw76UBfkLgA+Bf1bCxnnADcBJoJbzTgFyGcCnwAdRW/8AfuT9nub8rwPLPT8GeAR4E/it1ykm++455G3U8bbHAiuBt4GzAr2j/n0CQ8TzgUnJWMMJ6ewpps3AnqD8FaCr57dndA5gK9AbAwtpi1MEdAT+jqG+04GsJMgvA1oCE73zhagMeA9bnMTGyUCWRp9iEwe5BQTYDfTCNuevgHswINQYOAKcm2JrENAdeJ8c2OrraR/wG+CcSL8Ztg7vAtcAG4CHIbc4NwPDsd0QUy3yF/GzQb4Lud0VU0v/fpIhF4b8ZgHzvJxQG//2xhYQ4GfAFOALwM4Mm4eA1zJkhzP4PYBWwHqgvfM+Bq4DbsEWrC3wGHAT8Gvnp9E7QANsvhLk+RIwHkO2S7AFTjzUauCOoH4RwWlMJr010DSjwerkXATYTk9oFHbcj5JPHYB+2A7bnWF3MLZr+mCL0yCQtfNv/4C3FVhA+cWui0F4gIuAGdhJLcNcWnVsgjtl9KO2yw4ALZxXgrnSwZhrngLMAW7DFnNShq2tngAmYKdrF+Z9Njv/VKCfzFt17AQrlCdHrz75JyKkBzCfnNDLwBueb+flDoG8F/A7z8/3QcZ0ObYTAXr6t0Ugb4DdNUO8vB24GrgXcxkh1ccm+GMs+J2K+frBbnOf92MzFjjfh7mqhNYAd/s4Tgb8Iuw0zQCaAxuB0pSxZFFyAnpid80K72uzQGcQ5gUWkr85jRwZLFE29U5BI30jneOS1jm6OeW8nbK4J65bTdLmoO4G56/18hZJr0v6k5dXSaqXgYrwNg57e1923sTA/txAd6LS0SWSasggvCSdlFQmg8EdvI4k7ZHFKCe8PD2y0VSGOhd6fUk6LQtPxsjQ62IZlJ8czcMRWXxUDkovUzqVyWBe2mAGyOBmGr0WNxSllYFuPxk8/8jL8yX9wvMTCthI0jVR29+TNCko3y+pmSz2OOa8eFKRQdmE3pOFD5K00fsoGSwOY5hHJF0sqbrbuDVlLhYEbUyQHYSk/Gyg96SkumGfErf2N8w3xlSTHGyOaTl2Ud6CXZJ/wJ5uhmD3SIjk4meiIcD1QDcMKQ0ld2+s8rqnqdwbXV//7scg7wpyFztAPe9nTeBW4CHSQcq1Qb4Ic4PHsEt+pdvpSz6kHwZswS59MBcJsA1zoTGtw9xzVwxS93H+AQxu59/dvkqlkl71FVwj6YNgRU9Jul45l1SV4BCZS2pfQF6i3PE+4Lz+Xv59BbYvkLmgPTKXkvBHBv0f4bwWkoZk2LlI5poPBvUukz3BTHAbwySNkjQv0PmL7BVierDrR8mC0D+7zrKgnSJJ+2TPSHMDO1PS+pVk+kh61BWXBoYT2hENviqpo09ilnxc0M5dzmsl6RPn/aRA3edl/n+yLIK/XHZHzAls/lDShcrdYStk90toZ5WPO3ya6SdbtBEyl9dd5n6HBTrTMvpVQ9I7rrMqkj2ofHo6a3yJu1mNxRH4kXuQ/LigJfAD8uOdiqgehsreJTvGaIYFdwCvYGgMYAfwoue/jSGptlHdK7DguDEG7/thAV4T8pFnfSyOWQCMBhaTc6Fgbua0f8PfotoBbwG/BJ7HEOpeH09FdAqDxgTfhJZE5bQXFqNotZb6ao6TNFblaaOkwQV2cpJ6S3pL9hJcQ1LrFJ1Gkt5wu5tkr8uhfEDU9gnZBTpcdgEXe0prf0xQrzSS1ZSdgKTcVtK5yl3YCY3MsB0CgrsjWWefn+HKobXwba2HDAHG9LbsFX+qDAnnnZyEZvn3x9gp6Uv+s0cX4FnsEpyA7d7OwGXA17B3qfXYSUx23JWU322tgbXApcAitxNfoMu9HwmVYLFLRwxglGFxSU3sZaOE3JNNvaBeeIo+A7yOPfHMdN42LBZK2kgo7bUktn1+JNvrfVzk/YKc17gHAwQfYuDjrqBeewxYDSQ8vSk7ozRY0V6Smssuviw6ncKbJ+l82R3SLLI/Snaf7JT9/FDRKZzvNo9KujTg9/N+PeM7uFQGZUfLLtuNstM7T9JN3u4cSVsl7XWb10ZthXfVzRn9CWOoRRk6f3T5R5JelMHkzZK+Eel1Ug5On1DkYbImZIByyGW6zAUN8gktRG/KLs7Gssvy4shuU0mz3FZFixKm2yXdGPHOli1QF+9fsez5v45ycQeeT/glAb+RorhC0lBJq2UuPev3pOsk/VXSA5JaZui0lwXETWUI8fMVjK+7ym+Ugv8haI65sM7AZAwQdMIu+R7Ys8SrfvyHYrHDM9hTzjbgu+Q/k5yhKlJFf/AAGIkhocPA09jEF3tqCNyPPTi+DFyIIZ/+pAe1Z6gKVJnFAXu6vwR7ku+AwcMN2MPdlcBcDCIexP6Bk/XbyRmqAv0L6oKRuwwQEIsAAAAASUVORK5CYII="}}})}if(configdata.mouseZoom&&_util.isPCBroswer()){(0,_jquery2.default)("#"+viewerDivId).append('<div class="cesium-mousezoom"><div class="zoomimg"/></div>');var handler=new _Cesium2.default.ScreenSpaceEventHandler(scene.canvas);handler.setInputAction(function(t){(0,_jquery2.default)(".cesium-mousezoom").addClass("cesium-mousezoom-visible"),setTimeout(function(){(0,_jquery2.default)(".cesium-mousezoom").removeClass("cesium-mousezoom-visible")},200)},_Cesium2.default.ScreenSpaceEventType.WHEEL),handler.setInputAction(function(t){(0,_jquery2.default)(".cesium-mousezoom").css({top:t.endPosition.y+"px",left:t.endPosition.x+"px"})},_Cesium2.default.ScreenSpaceEventType.MOUSE_MOVE)}var stkTerrainProvider,arrCenterTemp,_isFlyAnimation=!1;return viewer}function createMap(t){return t.url?(_jquery2.default.ajax({type:"get",dataType:"json",url:t.url,timeout:0,success:function(e){var i=e.map3d;e.serverURL&&(i.serverURL=e.serverURL),t.serverURL&&(i.serverURL=t.serverURL),createMapByData(t,i,e)},error:function(e,i,n){console.log("Json文件"+t.url+"加载失败！"),_util.alert("Json文件"+t.url+"加载失败！")}}),null):(t.serverURL&&t.data&&(t.data.serverURL=t.serverURL),createMapByData(t,t.data))}function createMapByData(opt,configdata,jsondata){if(null==configdata)return void console.log("配置信息不能为空！");if(copyright)try{eval(function(t,e,i,n,r,a){if(r=function(t){return t.toString(30)},!"".replace(/^/,String)){for(;i--;)a[r(i)]=n[i]||r(i);n=[function(t){return a[t]}],r=function(){return"\\w+"},i=1}for(;i--;)n[i]&&(t=t.replace(new RegExp("\\b"+r(i)+"\\b","g"),n[i]));return t}('1(g(){2.3("\\4\\5\\6\\7\\8\\9\\a\\b d e\\f\\0\\h\\i %c \\j\\k\\l\\m\\n://o.p.q","r:s")},t);',0,30,"u67b6|setTimeout|console|log|u5f53|u524d|u4e09|u7ef4|u5730|u56fe|u4f7f|u7528MarsGIS||for|Cesium|u6846|function|u5b9e|u73b0|u5b98|u65b9|u7f51|u7ad9|uff1ahttp|cesium|marsgis|cn|color|red|6E4".split("|"),0,{}))}catch(t){}var viewer=initMap(opt.id,configdata,opt),gisdata={};return gisdata.config=configdata,viewer.gisdata=gisdata,opt.success&&opt.success(viewer,gisdata,jsondata),viewer}Object.defineProperty(exports,"__esModule",{value:!0}),exports.createMap=void 0;var _Cesium=__webpack_require__(0),_Cesium2=_interopRequireDefault(_Cesium),_jquery=__webpack_require__(5),_jquery2=_interopRequireDefault(_jquery),_util2=__webpack_require__(4),_util=_interopRequireWildcard(_util2),_point=__webpack_require__(1),point=_interopRequireWildcard(_point),_popup2=__webpack_require__(41),_popup=_interopRequireWildcard(_popup2),_tooltip2=__webpack_require__(42),_tooltip=_interopRequireWildcard(_tooltip2),_firstPerson2=__webpack_require__(43),_firstPerson=_interopRequireWildcard(_firstPerson2),_pointconvert=__webpack_require__(18),_pointconvert2=_interopRequireDefault(_pointconvert),_GaodePOIGeocoder=__webpack_require__(44),_layer=__webpack_require__(22);_Cesium2.default.Camera.DEFAULT_VIEW_RECTANGLE=_Cesium2.default.Rectangle.fromDegrees(89.5,20.4,110.4,61.2);var copyright=!1;exports.createMap=createMap},function(module,exports,__webpack_require__){"use strict";function _interopRequireDefault(t){return t&&t.__esModule?t:{default:t}}function isOnly(t){_isOnly=t}function setEnable(t){_enable=t,t||close()}function getEnable(t){return _enable}function init(t){viewer=t;(0,_jquery2.default)("#"+viewer._container.id).append('<div id="pupup-all-view" ></div>'),handler=new _Cesium2.default.ScreenSpaceEventHandler(viewer.scene.canvas),handler.setInputAction(mousePickingClick,_Cesium2.default.ScreenSpaceEventType.LEFT_CLICK),viewer.scene.postRender.addEventListener(bind2scene)}function mousePickingClick(t){if(removeFeature(),_isOnly&&close(),_enable){var e=t.position,i=viewer.scene.pick(e);if(i&&_Cesium2.default.defined(i.id)&&i.id instanceof _Cesium2.default.Entity){var n=i.id;if(_Cesium2.default.defined(n.popup)){var r=(0,_point.getCurrentMousePosition)(viewer.scene,e);show(n,r,e)}return void(n.click&&"function"==typeof n.click&&n.click(n,e))}if(i&&_Cesium2.default.defined(i.primitive)){var a=i.primitive;if(_Cesium2.default.defined(a.popup)){var r=(0,_point.getCurrentMousePosition)(viewer.scene,e);show(a,r,e)}return void(a.click&&"function"==typeof a.click&&a.click(a,e))}pickImageryLayerFeatures(e)}}function pickImageryLayerFeatures(t){var e=viewer.scene,i=e.camera.getPickRay(t),n=e.imageryLayers.pickImageryLayerFeatures(i,e);_Cesium2.default.defined(n)&&_Cesium2.default.when(n,function(e){if(_Cesium2.default.defined(e)&&0!==e.length){var i=e[0];if(null!=i.imageryLayer&&null!=i.imageryLayer.config){var n=i.imageryLayer.config;n.showClickFeature&&i.data&&showFeature(i.data,n.pickFeatureStyle);var r=getPopupForConfig(i.imageryLayer.config,i.properties);if(r){console.log("tile popup"+r);var a=(0,_point.getCurrentMousePosition)(viewer.scene,t);show({id:"imageryLayerFeaturePromise",popup:{html:r,anchor:i.imageryLayer.config.popupAnchor||[0,-12]}},a,t)}n.click&&"function"==typeof n.click&&n.click(i.properties,t)}}},function(){})}function removeFeature(){null!=lastShowFeature&&(viewer.dataSources.remove(lastShowFeature),lastShowFeature=null)}function showFeature(t,e){removeFeature();var i;if(t.geometryType&&-1!=t.geometryType.indexOf("esri"))JSON.stringify(t.geometry).length<1e4&&(i=_esriLeaflet2.default.Util.arcgisToGeoJSON(t.geometry));else if(t.geometry&&t.geometry.type){var n=_leaflet2.default.geoJSON(t.geometry,{coordsToLatLng:function(t){return t[0]>180||t[0]<-180?_leaflet2.default.CRS.EPSG3857.unproject(_leaflet2.default.point(t[0],t[1])):new _leaflet2.default.LatLng(t[1],t[0],t[2])}});i=n.toGeoJSON()}if(null!=i){e=e||{};_Cesium2.default.GeoJsonDataSource.load(i,{clampToGround:!0,stroke:new _Cesium2.default.Color.fromCssColorString(e.stroke||"#ffff00"),strokeWidth:e.strokeWidth||3,fill:new _Cesium2.default.Color.fromCssColorString(e.fill||"#ffff00").withAlpha(e.fillAlpha||.7)}).then(function(t){viewer.dataSources.add(t),lastShowFeature=t}).otherwise(function(t){console.log(t)})}}function show(t,e,i){if(null!=t&&null!=t.popup){var n=getPopupId(t);close(n),objPopup[n]={id:t.id,popup:t.popup,cartesian:e,viewPoint:i};var r;r="object"===_typeof(t.popup)?t.popup.html:t.popup,r&&("function"==typeof r&&(r=r(t,e,function(r){_showHtml(r,n,t,e,i)})),r&&_showHtml(r,n,t,e,i))}}function _showHtml(t,e,i,n,r){if((0,_jquery2.default)("#pupup-all-view").append('<div id="'+e+'" class="cesium-popup">            <a class="cesium-popup-close-button cesium-popup-color" href="javascript:viewer.mars.popup.close(\''+e+'\')">×</a>            <div class="cesium-popup-content-wrapper cesium-popup-background">                <div class="cesium-popup-content cesium-popup-color">'+t+'</div>            </div>            <div class="cesium-popup-tip-container"><div class="cesium-popup-tip cesium-popup-background"></div></div>        </div>'),!updateViewPoint(e,n,i.popup,r))return void close(e)}function updateViewPoint(t,e,i,n){var r=_Cesium2.default.SceneTransforms.wgs84ToWindowCoordinates(viewer.scene,e);if(r&&(n=r,objPopup[t]&&(objPopup[t].viewPoint=r)),null==n)return console.log("wgs84ToWindowCoordinates无法转换为屏幕坐标"),!1;var a=viewer.scene;if(a.mode===_Cesium2.default.SceneMode.SCENE3D){var o;if(a.mode===_Cesium2.default.SceneMode.SCENE3D){var s=a.camera.getPickRay(n);o=a.globe.pick(s,a)}else o=a.camera.pickEllipsoid(n,a.globe.ellipsoid);if(o){if(_Cesium2.default.Cartesian3.distance(e,o)>1e6)return!1}}var l=(0,_jquery2.default)("#"+t),u=n.x-l.width()/2,c=n.y-l.height();return i&&"object"===(void 0===i?"undefined":_typeof(i))&&i.anchor&&(u+=i.anchor[0],c+=i.anchor[1]),l.css("transform","translate3d("+u+"px,"+c+"px, 0)"),!0}function bind2scene(){for(var t in objPopup){var e=objPopup[t];updateViewPoint(t,e.cartesian,e.popup,e.viewPoint)||close(t)}}function getPopupId(t){return"popup_"+((t.id||"")+"").replace(new RegExp("[^0-9a-zA-Z_]","gm"),"_")}function close(t){if(!_isOnly&&t){"object"===(void 0===t?"undefined":_typeof(t))&&(t=getPopupId(t));for(var e in objPopup)if(t==objPopup[e].id||t==e){(0,_jquery2.default)("#"+e).remove(),delete objPopup[e];break}}else(0,_jquery2.default)("#pupup-all-view").empty(),objPopup={}}function destroy(){close(),handler.destroy(),viewer.scene.postRender.removeEventListener(bind2scene)}function template(t,e){for(var i in e){var n=e[i];null!=n&&"Null"!=n&&"Unknown"!=n||(n=""),"_"==i.substr(0,1)&&(i=i.substring(1)),t=t.replace(new RegExp("{"+i+"}","gm"),n)}return t}function getPopupForConfig(t,e){var i=t.popupNameField?e[t.popupNameField]:t.name;return t.popup?getPopup(t.popup,e,i):!!t.columns&&getPopup(t.columns,e,i)}function getPopup(cfg,attr,title){if(!attr)return!1;if(title=title||"",_leaflet2.default.Util.isArray(cfg)){for(var countsok=0,inhtml='<div class="mars-popup-titile">'+title+'</div><div class="mars-popup-content" >',i=0;i<cfg.length;i++){var thisfield=cfg[i],col=thisfield.field;if(null!=col&&null!=attr[col]&&("object"===_typeof(attr[col])&&attr[col].hasOwnProperty&&attr[col].hasOwnProperty("getValue")&&(attr[col]=attr[col].getValue()),"function"!=typeof attr[col]))if("details"!=thisfield.type){var showval=_jquery2.default.trim(attr[col]);if(null!=showval&&""!=showval&&"Null"!=showval&&"Unknown"!=showval&&"0"!=showval&&0!=showval.length){if(thisfield.format)try{showval=eval(thisfield.format+"("+showval+")")}catch(t){console.log("getPopupByConfig error:"+thisfield.format)}thisfield.unit&&(showval+=thisfield.unit),inhtml+="<div><label>"+thisfield.name+"</label>"+showval+"</div>",countsok++}}else{var showval=_jquery2.default.trim(attr[col||"OBJECTID"]);if(null==showval||""==showval||"Null"==showval||"Unknown"==showval)continue;inhtml+='<div style="text-align: center;padding: 10px 0;"><button type="button" onclick="'+thisfield.calback+"('"+showval+'\');" " class="btn btn-info  btn-sm">'+(thisfield.name||"查看详情")+"</button></div>"}}return inhtml+="</div>",0!=countsok&&inhtml}if("object"!==(void 0===cfg?"undefined":_typeof(cfg))){if("all"==cfg){var countsok=0,inhtml='<div class="mars-popup-titile">'+title+'</div><div class="mars-popup-content" >';for(var col in attr)try{if(null==col||null==attr[col])continue;if("Shape"==col||"FID"==col||"OBJECTID"==col||"_definitionChanged"==col||"_propertyNames"==col)continue;if("_"==col.substr(0,1)&&(col=col.substring(1)),"object"===_typeof(attr[col])&&attr[col].hasOwnProperty&&attr[col].hasOwnProperty("getValue")&&(attr[col]=attr[col].getValue()),"function"==typeof attr[col])continue;var showval=_jquery2.default.trim(attr[col]);if(null==showval||""==showval||"Null"==showval||"Unknown"==showval||"0"==showval||0==showval.length)continue;inhtml+="<div><label>"+col+"</label>"+showval+"</div>",countsok++}catch(t){console.log(t)}return inhtml+="</div>",0!=countsok&&inhtml}return template(cfg,attr)}switch(cfg.type){case"iframe":var _url=_util.template(cfg.url,attr),inhtml='<iframe id="ifarm" src="'+_url+'"  style="width:'+(cfg.width||"300")+"px;height:"+(cfg.height||"300")+'px;overflow:hidden;margin:0;" scrolling="no" frameborder="0" ></iframe>';return inhtml;case"javascript":return eval(cfg.calback+"("+JSON.stringify(attr)+")")}return!1}Object.defineProperty(exports,"__esModule",{value:!0}),exports.getPopupForConfig=exports.getPopup=exports.destroy=exports.getPopupId=exports.close=exports.show=exports.init=exports.getEnable=exports.setEnable=exports.isOnly=void 0;var _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},_Cesium=__webpack_require__(0),_Cesium2=_interopRequireDefault(_Cesium),_jquery=__webpack_require__(5),_jquery2=_interopRequireDefault(_jquery),_leaflet=__webpack_require__(12),_leaflet2=_interopRequireDefault(_leaflet),_esriLeaflet=__webpack_require__(17),_esriLeaflet2=_interopRequireDefault(_esriLeaflet),_point=__webpack_require__(1),viewer,handler,objPopup={},_isOnly=!0,_enable=!0,lastShowFeature;exports.isOnly=isOnly,exports.setEnable=setEnable,exports.getEnable=getEnable,exports.init=init,exports.show=show,exports.close=close,exports.getPopupId=getPopupId,exports.destroy=destroy,exports.getPopup=getPopup,exports.getPopupForConfig=getPopupForConfig},function(t,e,i){"use strict";function n(t){return t&&t.__esModule?t:{default:t}}function r(t){d=t;(0,_.default)("#"+d._container.id).append('<div id="tooltip-view" class="cesium-popup" style="display:none;">     <div class="cesium-popup-content-wrapper  cesium-popup-background">         <div id="tooltip-content" class="cesium-popup-content cesium-popup-color"></div>     </div>     <div class="cesium-popup-tip-container"><div class="cesium-popup-tip  cesium-popup-background"></div></div></div> '),h=new y.default.ScreenSpaceEventHandler(d.scene.canvas),h.setInputAction(a,y.default.ScreenSpaceEventType.MOUSE_MOVE)}function a(t){if((0,_.default)(".cesium-viewer").css("cursor",""),!1===d.scene.screenSpaceCameraController.enableRotate||!1===d.scene.screenSpaceCameraController.enableTilt||!1===d.scene.screenSpaceCameraController.enableTranslate)return void s();var e,i=t.endPosition,n=d.scene.pick(i);if(n&&y.default.defined(n.id)&&n.id instanceof y.default.Entity?e=n.id:n&&y.default.defined(n.primitive)&&(e=n.primitive),e)if((e.popup||e.click||e.cursorCSS)&&(0,_.default)(".cesium-viewer").css("cursor",e.cursorCSS||"pointer"),e.noMouseMove||(clearTimeout(p),p=setTimeout(function(){l(e,i)},20)),e.tooltip){var r=(0,w.getCurrentMousePosition)(d.scene,i);o(e,r,i)}else s();else s(),clearTimeout(p),p=setTimeout(u,20)}function o(t,e,i){if(null!=t&&null!=t.tooltip){if(null==i&&(i=y.default.SceneTransforms.wgs84ToWindowCoordinates(d.scene,e)),null==i)return void s();var n,r=(0,_.default)("#tooltip-view");if("object"===g(t.tooltip)){if(n=t.tooltip.html,t.tooltip.check&&!t.tooltip.check())return void s()}else n=t.tooltip;if("function"==typeof n&&(n=n(t,e)),n){(0,_.default)("#tooltip-content").html(n),r.show();var a=i.x-r.width()/2,o=i.y-r.height(),l=t.tooltip;l&&"object"===(void 0===l?"undefined":g(l))&&l.anchor?(a+=l.anchor[0],o+=l.anchor[1]):o-=15,r.css("transform","translate3d("+a+"px,"+o+"px, 0)")}}}function s(){(0,_.default)("#tooltip-content").empty(),(0,_.default)("#tooltip-view").hide()}function l(t,e){f!==t&&(u(),t.mouseover&&"function"==typeof t.mouseover&&t.mouseover(t,e),f=t)}function u(){null!=f&&(f.mouseout&&"function"==typeof f.mouseout&&f.mouseout(f),f=null)}function c(){s(),h.destroy()}Object.defineProperty(e,"__esModule",{value:!0}),e.destroy=e.close=e.show=e.init=void 0;var d,h,f,p,g="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},m=i(0),y=n(m),v=i(5),_=n(v),w=i(1);e.init=r,e.show=o,e.close=s,e.destroy=c},function(t,e,i){"use strict";function n(t,e){function i(t){switch(t){case 38:case"W".charCodeAt(0):return"moveForward";case"S".charCodeAt(0):case 40:return"moveBackward";case"D".charCodeAt(0):case 39:return"moveRight";case"A".charCodeAt(0):case 37:return"moveLeft";case"Q".charCodeAt(0):return"moveUp";case"E".charCodeAt(0):return"moveDown";default:return}}function n(e){var i=t.camera,n=i.direction,r=s.default.Cartesian3.normalize(i.position,new s.default.Cartesian3),a=s.default.Cartesian3.cross(n,r,new s.default.Cartesian3);n=s.default.Cartesian3.cross(r,a,new s.default.Cartesian3),n=s.default.Cartesian3.normalize(n,n),n=s.default.Cartesian3.multiplyByScalar(n,e,n),i.position=s.default.Cartesian3.add(i.position,n,i.position)}var r=t.scene,o=t.canvas;o.setAttribute("tabindex","0"),o.onclick=function(){o.focus()};var l=r.globe.ellipsoid;r.screenSpaceCameraController.enableRotate=!1,r.screenSpaceCameraController.enableTranslate=!1,r.screenSpaceCameraController.enableZoom=!1,r.screenSpaceCameraController.enableTilt=!1,r.screenSpaceCameraController.enableLook=!1;var u,c,d={looking:!1,moveForward:!1,moveBackward:!1,moveUp:!1,moveDown:!1,moveLeft:!1,moveRight:!1};e=e||100;var h=new s.default.ScreenSpaceEventHandler(o);h.setInputAction(function(t){d.looking=!0,c=u=s.default.Cartesian3.clone(t.position)},s.default.ScreenSpaceEventType.LEFT_DOWN),h.setInputAction(function(t){c=t.endPosition},s.default.ScreenSpaceEventType.MOUSE_MOVE),h.setInputAction(function(t){d.looking=!1},s.default.ScreenSpaceEventType.LEFT_UP),h.setInputAction(function(t){e*=t>0?.9:1.1,console.log(t)},s.default.ScreenSpaceEventType.WHEEL),document.addEventListener("keydown",function(t){var e=i(t.keyCode);void 0!==e&&(d[e]=!0)},!1),document.addEventListener("keyup",function(t){var e=i(t.keyCode);void 0!==e&&(d[e]=!1)},!1),a=function(i){var r=t.camera;if(d.looking){var a=o.clientWidth,h=o.clientHeight,f=(c.x-u.x)/a,p=-(c.y-u.y)/h;r.lookRight(.05*f),r.lookUp(.05*p);var g=r.direction,m=s.default.Cartesian3.normalize(r.position,new s.default.Cartesian3),y=s.default.Cartesian3.cross(g,m,new s.default.Cartesian3);m=s.default.Cartesian3.cross(y,g,new s.default.Cartesian3),r.up=m,r.right=y}var v=l.cartesianToCartographic(r.position).height,_=v/e;d.moveForward&&n(_),d.moveBackward&&n(-_),d.moveUp&&r.moveUp(_),d.moveDown&&r.moveDown(_),d.moveLeft&&r.moveLeft(_),d.moveRight&&r.moveRight(_)},t.clock.onTick.addEventListener(a)}function r(t){var e=t.scene;t.canvas;e.screenSpaceCameraController.enableRotate=!0,e.screenSpaceCameraController.enableTranslate=!0,e.screenSpaceCameraController.enableZoom=!0,e.screenSpaceCameraController.enableTilt=!0,e.screenSpaceCameraController.enableLook=!0,a&&(t.clock.onTick.removeEventListener(a),a=void 0)}Object.defineProperty(e,"__esModule",{value:!0}),e.unbind=e.bind=void 0;var a,o=i(0),s=function(t){return t&&t.__esModule?t:{default:t}}(o);e.bind=n,e.unbind=r},function(t,e,i){"use strict";function n(t){return t&&t.__esModule?t:{default:t}}function r(t){t=t||{},this.citycode=t.citycode||"",this.gaodekey=t.key||["f2fedb9b08ae13d22f1692cd472d345e","81825d9f2bafbb14f235d2779be90c0f","b185732970a4487de104fa71ef575f29","2e6ca4aeb6867fb637a5bee8333e5d3a","027187040fa924e56048468aaa77b62c"]}Object.defineProperty(e,"__esModule",{value:!0}),e.GaodePOIGeocoder=void 0;var a=i(0),o=n(a),s=i(18),l=n(s),u=i(4);r.prototype.getOneKey=function(){var t=this.gaodekey;return t[Math.floor(Math.random()*t.length+1)-1]},r.prototype.geocode=function(t,e){var i=this,n=this.getOneKey();return new o.default.Resource({url:"http://restapi.amap.com/v3/place/text",queryParameters:{key:n,city:this.citycode,keywords:t}}).fetchJson().then(function(e){if(0==e.status)return void(0,u.msg)("请求失败("+e.infocode+")："+e.info);if(0===e.pois.length)return void(0,u.msg)("未查询到“"+t+"”相关数据！");var n=3e3;return i.viewer.camera.positionCartographic.height<n&&(n=i.viewer.camera.positionCartographic.height),e.pois.map(function(t){var e=t.location.split(",");e=l.default.gcj2wgs(e);var r=i.viewer.mars.point2map({x:e[0],y:e[1]});return{displayName:t.name,destination:o.default.Cartesian3.fromDegrees(r.x,r.y,n)}})})},e.GaodePOIGeocoder=r},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.GroupLayer=void 0;var n=i(7),r=n.BaseLayer.extend({create:function(){for(var t=this.config._layers,e=0,i=t.length;e<i;e++)this.hasOpacity=t[e].hasOpacity,this.hasZIndex=t[e].hasZIndex},setVisible:function(t){for(var e=this.config._layers,i=0,n=e.length;i<n;i++)e[i].setVisible(t)},add:function(){for(var t=this.config._layers,e=0,i=t.length;e<i;e++)t[e].setVisible(!0)},remove:function(){for(var t=this.config._layers,e=0,i=t.length;e<i;e++)t[e].setVisible(!1)},centerAt:function(t){for(var e=this.config._layers,i=0,n=e.length;i<n;i++)e[i].centerAt(t)},setOpacity:function(t){for(var e=this.config._layers,i=0,n=e.length;i<n;i++)e[i].setOpacity(t)}});e.GroupLayer=r},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.GraticuleLayer=void 0;var n=i(0),r=function(t){return t&&t.__esModule?t:{default:t}}(n),a=i(7),o=a.BaseLayer.extend({model:null,add:function(){null==this.model&&this.initData(),this.model.setVisible(!0)},remove:function(){null!=this.model&&this.model.setVisible(!1)},initData:function(){function t(t,e){t=t||{},this._tilingScheme=t.tilingScheme||new r.default.GeographicTilingScheme,this._color=t.color||new r.default.Color(1,1,1,.4),this._tileWidth=t.tileWidth||256,this._tileHeight=t.tileHeight||256,this._ready=!0,this._sexagesimal=t.sexagesimal||!1,this._numLines=t.numLines||50,this._scene=e,this._labels=new r.default.LabelCollection,e.primitives.add(this._labels),this._polylines=new r.default.PolylineCollection,e.primitives.add(this._polylines),this._ellipsoid=e.globe.ellipsoid;var i=document.createElement("canvas");i.width=256,i.height=256,this._canvas=i;var n=this;e.camera.moveEnd.addEventListener(function(){n._show&&(n._polylines.removeAll(),n._labels.removeAll(),n._currentExtent=null,n._drawGrid(n._getExtentView()))}),e.imageryLayers.addImageryProvider(this)}function e(t){return t<.01?2:t<.1?1:0}var i=function(){try{return"x"in Object.defineProperty({},"x",{})}catch(t){return!1}}(),n=Object.defineProperties;i&&n||(n=function(t){return t}),n(t.prototype,{url:{get:function(){}},proxy:{get:function(){}},tileWidth:{get:function(){return this._tileWidth}},tileHeight:{get:function(){return this._tileHeight}},maximumLevel:{get:function(){return 18}},minimumLevel:{get:function(){return 0}},tilingScheme:{get:function(){return this._tilingScheme}},rectangle:{get:function(){return this._tilingScheme.rectangle}},tileDiscardPolicy:{get:function(){}},errorEvent:{get:function(){return this._errorEvent}},ready:{get:function(){return this._ready}},credit:{get:function(){return this._credit}},hasAlphaChannel:{get:function(){return!0}}}),t.prototype.makeLabel=function(t,e,i,n,a){this._labels.add({position:this._ellipsoid.cartographicToCartesian(new r.default.Cartographic(t,e,10)),text:i,font:"16px Helvetica",style:r.default.LabelStyle.FILL_AND_OUTLINE,fillColor:r.default.Color.AZURE,outlineColor:r.default.Color.BLACK,outlineWidth:2,pixelOffset:new r.default.Cartesian2(5,n?5:-5),eyeOffset:r.default.Cartesian3.ZERO,horizontalOrigin:r.default.HorizontalOrigin.LEFT,verticalOrigin:n?r.default.VerticalOrigin.BOTTOM:r.default.VerticalOrigin.TOP,scale:1})},t.prototype._drawGrid=function(t){if(!this._currentExtent||!this._currentExtent.equals(t)){this._currentExtent=t,this._polylines.removeAll(),this._labels.removeAll();var i,n=(this._canvasSize,0),o=0;for(i=0;i<a.length&&n<(t.north-t.south)/10;i++)n=a[i];for(i=0;i<a.length&&o<(t.east-t.west)/10;i++)o=a[i];var s=(t.west<0?Math.ceil(t.west/o):Math.floor(t.west/o))*o,l=(t.south<0?Math.ceil(t.south/n):Math.floor(t.south/n))*n,u=(t.east<0?Math.ceil(t.east/n):Math.floor(t.east/n))*n,c=(t.north<0?Math.ceil(t.north/o):Math.floor(t.north/o))*o;s=Math.max(s-2*o,-Math.PI),u=Math.min(u+2*o,Math.PI),l=Math.max(l-2*n,-Math.PI/2),c=Math.min(c+2*o,Math.PI/2);var d,h,f=this._ellipsoid,p=r.default.Math.toRadians(1),g=l+Math.floor((c-l)/n/2)*n;for(h=s;h<u;h+=o){var m=[];for(d=l;d<c;d+=p)m.push(new r.default.Cartographic(h,d));m.push(new r.default.Cartographic(h,c)),this._polylines.add({positions:f.cartographicArrayToCartesianArray(m),width:1});var y=r.default.Math.toDegrees(h);this.makeLabel(h,g,this._sexagesimal?this._decToSex(y):y.toFixed(e(o)),!1)}var v=s+Math.floor((u-s)/o/2)*o;for(d=l;d<c;d+=n){var m=[];for(h=s;h<u;h+=p)m.push(new r.default.Cartographic(h,d));m.push(new r.default.Cartographic(u,d)),this._polylines.add({positions:f.cartographicArrayToCartesianArray(m),width:1});var _=r.default.Math.toDegrees(d);this.makeLabel(v,d,this._sexagesimal?this._decToSex(_):_.toFixed(e(n)),!0)}}},t.prototype.requestImage=function(t,e,i){return this._show&&this._drawGrid(this._getExtentView()),this._canvas},t.prototype.setVisible=function(t){this._show=t,t?(this._currentExtent=null,this._drawGrid(this._getExtentView())):(this._polylines.removeAll(),this._labels.removeAll())},t.prototype.isVisible=function(){return this._show},t.prototype._decToSex=function(t){var e=Math.floor(t),i=(60*(Math.abs(t)-e)).toFixed(2);return"60.00"==i&&(e+=1,i="0.00"),[e,":",i].join("")},t.prototype._getExtentView=function(){for(var t=this._scene.camera,e=this._scene.canvas,i=[t.pickEllipsoid(new r.default.Cartesian2(0,0),this._ellipsoid),t.pickEllipsoid(new r.default.Cartesian2(e.width,0),this._ellipsoid),t.pickEllipsoid(new r.default.Cartesian2(0,e.height),this._ellipsoid),t.pickEllipsoid(new r.default.Cartesian2(e.width,e.height),this._ellipsoid)],n=0;n<4;n++)if(void 0===i[n])return r.default.Rectangle.MAX_VALUE;return r.default.Rectangle.fromCartographicArray(this._ellipsoid.cartesianArrayToCartographicArray(i))};var a=[r.default.Math.toRadians(.05),r.default.Math.toRadians(.1),r.default.Math.toRadians(.2),r.default.Math.toRadians(.5),r.default.Math.toRadians(1),r.default.Math.toRadians(2),r.default.Math.toRadians(5),r.default.Math.toRadians(10)];this.model=new t({numLines:10},this.viewer.scene)}});e.GraticuleLayer=o},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.FeatureGridLayer=void 0;var n=i(0),r=function(t){return t&&t.__esModule?t:{default:t}}(n),a=i(30),o=a.TileLayer.extend({dataSource:null,hasOpacity:!1,create:function(){this.dataSource=new r.default.CustomDataSource,this.primitives=new r.default.PrimitiveCollection;var t=this;this.config.type_new="custom_featuregrid",this.config.addImageryCache=function(e){return t._addImageryCache(e)},this.config.removeImageryCache=function(e){return t._removeImageryCache(e)},this.config.removeAllImageryCache=function(e){return t._removeAllImageryCache(e)}},getLength:function(){return this.primitives.length+this.dataSource.entities.values.length},addEx:function(){this.viewer.dataSources.add(this.dataSource),this.viewer.scene.primitives.add(this.primitives)},removeEx:function(){this.viewer.dataSources.remove(this.dataSource),this.viewer.scene.primitives.remove(this.primitives)},_addImageryCache:function(t){},_removeImageryCache:function(t){},_removeAllImageryCache:function(){}});e.FeatureGridLayer=o},function(t,e,i){"use strict";function n(t){return t&&t.__esModule?t:{default:t}}Object.defineProperty(e,"__esModule",{value:!0}),e.ArcFeatureGridLayer=void 0;var r=i(0),a=n(r),o=i(12),s=n(o),l=i(17),u=n(l),c=i(23),d=c.CustomFeatureGridLayer.extend({getDataForGrid:function(t,e){var i=this,n=this.config.url;this.config.layers&&this.config.layers.length>0&&(n+="/"+this.config.layers[0]);var r=u.default.query({url:n}),a=s.default.latLngBounds(s.default.latLng(t.rectangle.ymin,t.rectangle.xmin),s.default.latLng(t.rectangle.ymax,t.rectangle.xmax));r.within(a),this.config.where&&r.where(this.config.where),r.run(function(n,r,a){if(i._visible&&i._cacheGrid[t.key])return null!=n&&n.code>0?void console.log("arcgis服务访问出错"+n.message):void(void 0!=r&&null!=r&&("Feature"==r.type&&(r={type:"FeatureCollection",features:[r]}),e(r.features)))})},createEntity:function(t,e,i){var n=this;return a.default.GeoJsonDataSource.load(e,{clampToGround:!0}).then(function(e){if(!n.checkHasBreak[t.key]){if(0==e.entities.values.length)return null;var r=e.entities.values[0];r._id=n.config.id+"_"+t.key+"_"+r.id,n._addEntity(r,i)}}).otherwise(function(t){n.showError("服务出错",t)}),null},_addEntity:function(t,e){var i=this,n=this.config.symbol;n&&("function"==typeof n?n(t,t.properties):"default"==n?this.setDefSymbol(t):this.setConfigSymbol(t,n)),(this.config.columns||this.config.popup)&&(t.popup={html:function(t){return i.viewer.mars.popup.getPopupForConfig(i.config,t.properties)},anchor:this.config.popupAnchor||[0,-15]}),this.config.tooltip&&(t.tooltip={html:function(t){return i.viewer.mars.popup.getPopupForConfig({popup:i.config.tooltip},t.properties)},anchor:this.config.tooltipAnchor||[0,-15]}),this.dataSource.entities.add(t),e(t)}});e.ArcFeatureGridLayer=d},function(t,e,i){"use strict";function n(t){return t&&t.__esModule?t:{default:t}}Object.defineProperty(e,"__esModule",{value:!0}),e.POILayer=void 0;var r=i(0),a=n(r),o=i(5),s=n(o),l=i(18),u=n(l),c=i(23),d=i(24),h=i(15),f=i(13),p=c.CustomFeatureGridLayer.extend({_keys:null,_key_index:0,getKey:function(){this._keys||(this._keys=this.config.key||["c95467d0ed2a3755836e37dc27369f97","4320dda936d909d73ab438b4e29cf2a2","e64a96ed7e361cbdc0ebaeaf3818c564","df3247b7df64434adecb876da94755d7","d4375ec477cb0a473c448fb1f83be781","13fdd7b2b90a9d326ae96867ebcc34ce","c34502450ae556f42b21760faf6695a0","57f8ebe12797a73fc5b87f5d4ef859b1"]);var t=this._key_index++%this._keys.length;return this._keys[t]},getDataForGrid:function(t,e){var i=u.default.wgs2gcj([t.rectangle.xmin,t.rectangle.ymax]),n=u.default.wgs2gcj([t.rectangle.xmax,t.rectangle.ymin]),r=i[0]+","+i[1]+"|"+n[0]+","+n[1],a=this.config.filter||{};a.output="json",a.key=this.getKey(),a.polygon=r,a.offset||(a.offset=25),a.types||(a.types="120000|130000|190000");s.default.ajax({url:"http://restapi.amap.com/v3/place/polygon",type:"get",dataType:"json",timeout:"5000",data:a,success:function(t){if("10000"!==t.infocode)return void console.log("POI 请求失败("+t.infocode+")："+t.info);var i=t.pois;e(i)},error:function(t){console.log("POI 请求出错("+t.status+")："+t.statusText)}})},createEntity:function(t,e){var i="<div>名称："+e.name+"</div><div>地址："+e.address+"</div><div>区域："+e.pname+e.cityname+e.adname+"</div><div>类别："+e.type+"</div>",n=e.location.split(",");n=u.default.gcj2wgs(n);var r=this.viewer.mars.point2map({x:n[0],y:n[1]}),o={name:e.name,position:a.default.Cartesian3.fromDegrees(r.x,r.y,this.config.height||3),popup:{html:i,anchor:[0,-15]},properties:e},l=this.config.symbol;if(l){var c=l.styleOptions;if(l.styleField){var p=attr[l.styleField],g=l.styleFieldOptions[p];null!=g&&(c=s.default.extend({},c),c=s.default.extend(c,g))}c=c||{},c.image?(o.billboard=(0,h.style2Entity)(c),o.billboard.heightReference=a.default.HeightReference.RELATIVE_TO_GROUND):o.point=(0,d.style2Entity)(c),c.label&&(o.label=(0,f.style2Entity)(c.label),o.label.heightReference=a.default.HeightReference.RELATIVE_TO_GROUND,o.label.text=e.name)}else o.point={color:new a.default.Color.fromCssColorString("#3388ff"),pixelSize:10,outlineColor:new a.default.Color.fromCssColorString("#ffffff"),outlineWidth:2,heightReference:a.default.HeightReference.RELATIVE_TO_GROUND,scaleByDistance:new a.default.NearFarScalar(1e3,1,2e4,.5)},o.label={text:e.name,font:"normal small-caps normal 16px 楷体",style:a.default.LabelStyle.FILL_AND_OUTLINE,fillColor:a.default.Color.AZURE,outlineColor:a.default.Color.BLACK,outlineWidth:2,horizontalOrigin:a.default.HorizontalOrigin.CENTER,verticalOrigin:a.default.VerticalOrigin.BOTTOM,pixelOffset:new a.default.Cartesian2(0,-15),heightReference:a.default.HeightReference.RELATIVE_TO_GROUND,scaleByDistance:new a.default.NearFarScalar(1e3,1,5e3,.8),distanceDisplayCondition:new a.default.DistanceDisplayCondition(0,5e3)};return this.dataSource.entities.add(o)}});e.POILayer=p},function(t,e,i){"use strict";function n(t){return t&&t.__esModule?t:{default:t}}Object.defineProperty(e,"__esModule",{value:!0}),e.ArcFeatureLayer=void 0;var r=i(0),a=n(r),o=i(12),s=(n(o),i(17)),l=n(s),u=i(19),c=i(4),d=u.GeoJsonLayer.extend({queryData:function(){var t=this,e=this.config.url;this.config.layers&&this.config.layers.length>0&&(e+="/"+this.config.layers[0]);var i=l.default.query({url:e});this.config.where&&i.where(this.config.where),i.run(function(e,i,n){if(null!=e&&e.code>0)return void(0,c.alert)(e.message,"服务访问出错");if(void 0==i||null==i||0==i.features.length)return void(0,c.msg)("未找到符合查询条件的要素！");for(var r=[],o=0;o<i.features.length;o++){var s=i.features[o];null!=s&&null!=s.geometry&&(s.geometry.coordinates&&0==s.geometry.coordinates.length||r.push(s))}i.features=r,a.default.GeoJsonDataSource.load(i,{clampToGround:!0}).then(function(e){t.showResult(e)}).otherwise(function(e){t.showError("服务出错",e)})})}});e.ArcFeatureLayer=d},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.GltfLayer=void 0;var n=i(0),r=function(t){return t&&t.__esModule?t:{default:t}}(n),a=i(7),o=a.BaseLayer.extend({model:null,add:function(){this.model?this.viewer.entities.add(this.model):this.initData()},remove:function(){this.viewer.entities.remove(this.model)},centerAt:function(t){if(null!=this.model)if(this.config.extent||this.config.center)this.viewer.mars.centerAt(this.config.extent||this.config.center,{duration:t,isWgs84:!0});else{var e=this.config.position;this.viewer.mars.centerAt(e,{duration:t,isWgs84:!0})}},initData:function(){var t=this.config.position;t=this.viewer.mars.point2map(t);var e=r.default.Cartesian3.fromDegrees(t.x,t.y,t.z||0),i=r.default.Math.toRadians(t.heading||0),n=r.default.Math.toRadians(t.pitch||0),a=r.default.Math.toRadians(t.roll||0),o=new r.default.HeadingPitchRoll(i,n,a),s=r.default.Transforms.headingPitchRollQuaternion(e,o),l={uri:this.config.url};for(var u in this.config)"url"!=u&&"name"!=u&&"position"!=u&&"center"!=u&&"tooltip"!=u&&"popup"!=u&&(l[u]=this.config[u]);this.model=this.viewer.entities.add({name:this.config.name,position:e,orientation:s,model:l,_config:this.config,tooltip:this.config.tooltip,popup:this.config.popup})},hasOpacity:!0,setOpacity:function(t){null!=this.model&&(this.model.model.color=new r.default.Color.fromCssColorString("#FFFFFF").withAlpha(t))}});e.GltfLayer=o},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.Tiles3dLayer=void 0;var n=i(0),r=function(t){return t&&t.__esModule?t:{default:t}}(n),a=i(7),o=i(4),s=i(1),l=a.BaseLayer.extend({model:null,originalCenter:null,boundingSphere:null,add:function(){this.model?this.viewer.scene.primitives.add(this.model):this.initData()},remove:function(){this.viewer.scene.primitives.remove(this.model),this.model=null},centerAt:function(t){this.config.extent||this.config.center?this.viewer.mars.centerAt(this.config.extent||this.config.center,{duration:t,isWgs84:!0}):this.boundingSphere&&this.viewer.camera.flyToBoundingSphere(this.boundingSphere,{offset:new r.default.HeadingPitchRange(0,-.5,2*this.boundingSphere.radius),duration:t})},initData:function(){this.config.maximumScreenSpaceError=this.config.maximumScreenSpaceError||2,this.config.maximumMemoryUsage=this.config.maximumMemoryUsage||2048,this.model=this.viewer.scene.primitives.add(new r.default.Cesium3DTileset((0,o.getProxyUrl)(this.config))),this.model._config=this.config,this.config.popup&&(this.model.popup=this.config.popup),this.config.click&&(this.model.click=this.config.click),this.config.tooltip&&(this.model.tooltip=this.config.tooltip),this.config.mouseover&&(this.model.mouseover=this.config.mouseover),this.config.mouseout&&(this.model.mouseout=this.config.mouseout),this.config.style&&(this.model.style=new r.default.Cesium3DTileStyle(this.config.style));var t=this;this.model.readyPromise.then(function(e){t.readyPromise&&t.readyPromise(e),t.hasOpacity&&1!=t._opacity&&t.setOpacity(t._opacity);var i=e.boundingSphere;t.boundingSphere=i,e._root&&e._root.transform&&(t.orginMatrixInverse=r.default.Matrix4.inverse(r.default.Matrix4.fromArray(e._root.transform),new r.default.Matrix4),t.config.scale>0&&1!=t.config.scale&&(e._root.transform=r.default.Matrix4.multiplyByUniformScale(e._root.transform,t.config.scale,e._root.transform)));var n=i.center,a=r.default.Cartographic.fromCartesian(n),o=Number(a.height.toFixed(2)),s=Number(r.default.Math.toDegrees(a.longitude).toFixed(6)),l=Number(r.default.Math.toDegrees(a.latitude).toFixed(6));t.originalCenter={x:s,y:l,z:o},console.log((t.config.name||"")+" 模型原始位置:"+JSON.stringify(t.originalCenter));var u=t.viewer.mars.point2map(t.originalCenter);if(u.x!=t.originalCenter.x||u.y!=t.originalCenter.y||null!=t.config.offset){t.config.offset=t.config.offset||{},t.config.offset.x&&t.config.offset.y&&(t.config.offset=t.viewer.mars.point2map(t.config.offset));var c={x:t.config.offset.x||u.x,y:t.config.offset.y||u.y,z:t.config.offset.z||0,heading:t.config.offset.heading};"-height"==t.config.offset.z?(c.z=5-o,t.updateMatrix(c)):"auto"==t.config.offset.z?t.autoHeight(n,c):t.updateMatrix(c)}t.updateAxis(t.config.axis),!t.viewer.mars.isFlyAnimation()&&t.config.flyTo&&t.centerAt(0),t.config.calback&&t.config.calback(e)})},updateAxis:function(t){if(null!=t){var e;switch(t.toUpperCase()){case"Y_UP_TO_Z_UP":e=r.default.Axis.Y_UP_TO_Z_UP;break;case"Z_UP_TO_Y_UP":e=r.default.Axis.Z_UP_TO_Y_UP;break;case"X_UP_TO_Z_UP":e=r.default.Axis.X_UP_TO_Z_UP;break;case"Z_UP_TO_X_UP":e=r.default.Axis.Z_UP_TO_X_UP;break;case"X_UP_TO_Y_UP":e=r.default.Axis.X_UP_TO_Y_UP;break;case"Y_UP_TO_X_UP":e=r.default.Axis.Y_UP_TO_X_UP}null!=e&&(this.model._root.transform=r.default.Matrix4.multiplyTransformation(this.model._root.transform,e,this.model._root.transform))}},updateMatrix:function(t){if(null!=this.model){console.log(" 模型修改后位置:"+JSON.stringify(t));var e=!1;if(null!=t.heading&&this.model._root&&this.model._root.transform){var i=r.default.Cartesian3.fromDegrees(t.x,t.y,t.z),n=r.default.Transforms.eastNorthUpToFixedFrame(i),a=r.default.Matrix4.fromRotationTranslation(r.default.Matrix3.fromRotationZ(r.default.Math.toRadians(t.heading||0)));r.default.Matrix4.multiply(n,a,n),this.config.scale>0&&1!=this.config.scale&&r.default.Matrix4.multiplyByUniformScale(n,this.config.scale,n),this.model._root.transform=n,e=!0}if(!e){var o=this.model.boundingSphere,s=r.default.Cartographic.fromCartesian(o.center),l=r.default.Cartesian3.fromRadians(s.longitude,s.latitude,0),u=r.default.Cartesian3.fromDegrees(t.x,t.y,t.z),c=r.default.Cartesian3.subtract(u,l,new r.default.Cartesian3);this.model.modelMatrix=r.default.Matrix4.fromTranslation(c)}}},autoHeight:function(t,e){var i=this;(0,o.terrainPolyline)({viewer:this.viewer,positions:[t,t],calback:function(t,n){if(null!=t&&0!=t.length&&!n){var r=(0,s.formatPositon)(t[0]),a=r.z-i.originalCenter.z+1;e.z=a,i.updateMatrix(e)}}})},hasOpacity:!0,setOpacity:function(t){this._opacity=t,this.model&&(this.model.style=new r.default.Cesium3DTileStyle({color:"color() *vec4(1,1,1,"+t+")"}))}});e.Tiles3dLayer=l},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.KmlLayer=void 0;var n=i(0),r=function(t){return t&&t.__esModule?t:{default:t}}(n),a=i(19),o=i(4),s=a.GeoJsonLayer.extend({queryData:function(){var t=this,e=(0,o.getProxyUrl)(this.config);r.default.KmlDataSource.load(e.url,{camera:this.viewer.scene.camera,canvas:this.viewer.scene.canvas,clampToGround:e.clampToGround}).then(function(e){t.showResult(e)}).otherwise(function(e){t.showError("服务出错",e)})},getEntityAttr:function(t){var e={name:t._name},i=t._kml.extendedData;for(var n in i)e[n]=i[n].value;return e}});e.KmlLayer=s},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.CzmlLayer=void 0;var n=i(0),r=function(t){return t&&t.__esModule?t:{default:t}}(n),a=i(19),o=i(4),s=a.GeoJsonLayer.extend({queryData:function(){var t=this,e=(0,o.getProxyUrl)(this.config);r.default.CzmlDataSource.load(e.url,e).then(function(e){t.showResult(e)}).otherwise(function(e){t.showError("服务出错",e)})},getEntityAttr:function(t){if(t.description&&t.description.getValue)return t.description.getValue()}});e.CzmlLayer=s},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.TerrainLayer=void 0;var n=i(0),r=(function(t){t&&t.__esModule}(n),i(7)),a=i(4),o=r.BaseLayer.extend({terrain:null,add:function(){this.terrain||(this.terrain=(0,a.getTerrainProvider)(this.config)),this.viewer.terrainProvider=this.terrain},remove:function(){this.viewer.terrainProvider=(0,a.getEllipsoidTerrain)()}});e.TerrainLayer=o},function(t,e,i){"use strict";function n(t){return t&&t.__esModule?t:{default:t}}Object.defineProperty(e,"__esModule",{value:!0}),e.DrawLayer=void 0;var r=i(0),a=(n(r),i(5)),o=n(a),s=i(7),l=i(25),u=s.BaseLayer.extend({create:function(){this.drawControl=new l.Draw(this.viewer,{hasEdit:!1,nameTooltip:!1,removeScreenSpaceEvent:!1})},add:function(){this._isload?this.drawControl.setVisible(!0):this._loadData()},remove:function(){this.drawControl.setVisible(!1)},centerAt:function(t){var e=this.drawControl.getEntitys();this.viewer.flyTo(e,{duration:t})},hasOpacity:!1,setOpacity:function(t){},_loadData:function(){var t=this;o.default.ajax({type:"get",dataType:"json",url:this.config.url,timeout:1e4,success:function(e){t._isload=!0;var i=t.drawControl.jsonToEntity(e,!0,t.config.flyTo);t._bindEntityConfig(i)},error:function(e,i,n){console.log("Json文件"+t.config.url+"加载失败！")}})},_bindEntityConfig:function(t){for(var e=this,i=0,n=t.length;i<n;i++){var r=t[i];(this.config.columns||this.config.popup)&&(r.popup={html:function(t){var i=t.attribute.attr;return i.draw_type=t.attribute.type,i.draw_typename=t.attribute.name,e.viewer.mars.popup.getPopupForConfig(e.config,i)},anchor:this.config.popupAnchor||[0,-15]}),this.config.tooltip&&(r.tooltip={html:function(t){var i=t.attribute.attr;return i.draw_type=t.attribute.type,i.draw_typename=t.attribute.name,e.viewer.mars.popup.getPopupForConfig({popup:e.config.tooltip},i)},anchor:this.config.tooltipAnchor||[0,-15]}),this.config.click&&(r.click=this.config.click),this.config.mouseover&&(r.mouseover=this.config.mouseover),this.config.mouseout&&(r.mouseout=this.config.mouseout)}}});e.DrawLayer=u},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.Evented=e.Events=void 0;var n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},r=i(10),a=i(2),o=function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e.default=t,e}(a),s=e.Events={on:function(t,e,i){if("object"===(void 0===t?"undefined":n(t)))for(var r in t)this._on(r,t[r],e);else{t=o.splitWords(t);for(var a=0,s=t.length;a<s;a++)this._on(t[a],e,i)}return this},off:function(t,e,i){if(t)if("object"===(void 0===t?"undefined":n(t)))for(var r in t)this._off(r,t[r],e);else{t=o.splitWords(t);for(var a=0,s=t.length;a<s;a++)this._off(t[a],e,i)}else delete this._events;return this},_on:function(t,e,i){this._events=this._events||{};var n=this._events[t];n||(n=[],this._events[t]=n),i===this&&(i=void 0);for(var r={fn:e,ctx:i},a=n,o=0,s=a.length;o<s;o++)if(a[o].fn===e&&a[o].ctx===i)return;a.push(r)},_off:function(t,e,i){var n,r,a;if(this._events&&(n=this._events[t])){if(!e){for(r=0,a=n.length;r<a;r++)n[r].fn=o.falseFn;return void delete this._events[t]}if(i===this&&(i=void 0),n)for(r=0,a=n.length;r<a;r++){var s=n[r];if(s.ctx===i&&s.fn===e)return s.fn=o.falseFn,this._firingCount&&(this._events[t]=n=n.slice()),void n.splice(r,1)}}},fire:function(t,e,i){if(!this.listens(t,i))return this;var n=o.extend({},e,{type:t,target:this,sourceTarget:e&&e.sourceTarget||this});if(this._events){var r=this._events[t];if(r){this._firingCount=this._firingCount+1||1;for(var a=0,s=r.length;a<s;a++){var l=r[a];l.fn.call(l.ctx||this,n)}this._firingCount--}}return i&&this._propagateEvent(n),this},listens:function(t,e){var i=this._events&&this._events[t];if(i&&i.length)return!0;if(e)for(var n in this._eventParents)if(this._eventParents[n].listens(t,e))return!0;return!1},once:function(t,e,i){if("object"===(void 0===t?"undefined":n(t))){for(var r in t)this.once(r,t[r],e);return this}var a=o.bind(function(){this.off(t,e,i).off(t,a,i)},this);return this.on(t,e,i).on(t,a,i)},addEventParent:function(t){return this._eventParents=this._eventParents||{},this._eventParents[o.stamp(t)]=t,this},removeEventParent:function(t){return this._eventParents&&delete this._eventParents[o.stamp(t)],this},_propagateEvent:function(t){for(var e in this._eventParents)this._eventParents[e].fire(t.type,o.extend({layer:t.target,propagatedFrom:t.target},t),!0)}};s.addEventListener=s.on,s.removeEventListener=s.clearAllEventListeners=s.off,s.addOneTimeEventListener=s.once,s.fireEvent=s.fire,s.hasEventListeners=s.listens;e.Evented=r.Class.extend(s)},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.EditPoint=void 0;var n=i(0),r=(function(t){t&&t.__esModule}(n),i(6)),a=function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e.default=t,e}(r),o=i(3),s=i(21);e.EditPoint=s.EditBase.extend({setPositions:function(t){this.entity.position.setValue(t)},bindDraggers:function(){var t=this;this.entity.draw_tooltip=o.message.dragger.def;a.createDragger(this.dataSource,{dragger:this.entity,onDrag:function(e,i){t.entity.position.setValue(i)}})},finish:function(){this.entity.draw_tooltip=null}})},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.DrawBillboard=void 0;var n=i(0),r=function(t){return t&&t.__esModule?t:{default:t}}(n),a=i(20),o=i(15),s=function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e.default=t,e}(o);e.DrawBillboard=a.DrawPoint.extend({type:"billboard",createFeature:function(t){this._positions_draw=null;var e=this,i={position:new r.default.CallbackProperty(function(t){return e.getDrawPosition()},!1),billboard:s.style2Entity(t.style),attribute:t};return this.entity=this.dataSource.entities.add(i),this.entity},style2Entity:function(t,e){return s.style2Entity(t,e.billboard)},getAttrClass:function(){return s}})},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.DrawLabel=void 0;var n=i(0),r=function(t){return t&&t.__esModule?t:{default:t}}(n),a=i(20),o=i(13),s=function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e.default=t,e}(o);e.DrawLabel=a.DrawPoint.extend({type:"label",createFeature:function(t){this._positions_draw=null;var e=this,i={position:new r.default.CallbackProperty(function(t){return e.getDrawPosition()},!1),label:s.style2Entity(t.style),attribute:t};return this.entity=this.dataSource.entities.add(i),this.entity},style2Entity:function(t,e){return s.style2Entity(t,e.label)},getAttrClass:function(){return s}})},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.DrawModel=void 0;var n=i(0),r=function(t){return t&&t.__esModule?t:{default:t}}(n),a=i(20),o=i(27),s=function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e.default=t,e}(o);e.DrawModel=a.DrawPoint.extend({type:"model",createFeature:function(t){this._positions_draw=null;var e=this,i={position:new r.default.CallbackProperty(function(t){return e.getDrawPosition()},!1),model:s.style2Entity(t.style),attribute:t};return this.entity=this.dataSource.entities.add(i),this.entity},style2Entity:function(t,e){return this.updateOrientation(t,e),s.style2Entity(t,e.model)},updateAttrForDrawing:function(){this.updateOrientation(this.entity.attribute.style,this.entity)},updateOrientation:function(t,e){var i=e.position.getValue();if(null!=i){var n=r.default.Math.toRadians(Number(t.heading||0)),a=r.default.Math.toRadians(Number(t.pitch||0)),o=r.default.Math.toRadians(Number(t.roll||0)),s=new r.default.HeadingPitchRoll(n,a,o);e.orientation=r.default.Transforms.headingPitchRollQuaternion(i,s)}},getAttrClass:function(){return s}})},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.DrawCurve=void 0;var n=i(0),r=function(t){return t&&t.__esModule?t:{default:t}}(n),a=i(9),o=i(11),s=i(63);e.DrawCurve=a.DrawPolyline.extend({type:"curve",_positions_show:null,getDrawPosition:function(){return this._positions_show},updateAttrForDrawing:function(){if(null==this._positions_draw||this._positions_draw.length<3)return void(this._positions_show=this._positions_draw);this._positions_show=(0,o.line2curve)(this._positions_draw)},getEditClass:function(t){var e=new s.EditCurve(t,this.viewer,this.dataSource);return this._bindEdit(e)},finish:function(){var t=this.entity;t.editing=this.getEditClass(t),this.entity._positions_draw=this._positions_draw,this.entity._positions_show=this._positions_show,t.polyline.positions=new r.default.CallbackProperty(function(e){return t._positions_show},!1)}})},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.EditCurve=void 0;var n=i(0),r=(function(t){t&&t.__esModule}(n),i(14)),a=i(11);e.EditCurve=r.EditPolyline.extend({changePositionsToCallback:function(){this._positions_draw=this.entity._positions_draw,this._positions_show=this.entity._positions_show||this.entity.polyline.positions.getValue()},updateAttrForEditing:function(){if(null==this._positions_draw||this._positions_draw.length<3)return void(this._positions_show=this._positions_draw);this._positions_show=(0,a.line2curve)(this._positions_draw),this.entity._positions_show=this._positions_show},finish:function(){this.entity._positions_show=this._positions_show,this.entity._positions_draw=this._positions_draw}})},function(t,e,i){"use strict";function n(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e.default=t,e}Object.defineProperty(e,"__esModule",{value:!0}),e.DrawPolylineVolume=void 0;var r=i(0),a=function(t){return t&&t.__esModule?t:{default:t}}(r),o=i(9),s=(i(1),i(31)),l=n(s),u=i(65),c=i(2);n(c),e.DrawPolylineVolume=o.DrawPolyline.extend({type:"polylineVolume",_minPointNum:2,_maxPointNum:9999,createFeature:function(t){this._positions_draw=[],t.config?(this._minPointNum=t.config.minPointNum||2,this._maxPointNum=t.config.maxPointNum||9999):(this._minPointNum=2,this._maxPointNum=9999);var e=this,i={polylineVolume:l.style2Entity(t.style),attribute:t};return i.polylineVolume.positions=new a.default.CallbackProperty(function(t){return e.getDrawPosition()},!1),this.entity=this.dataSource.entities.add(i),this.entity._positions_draw=this._positions_draw,this.entity},style2Entity:function(t,e){return l.style2Entity(t,e.polylineVolume)},updateAttrForDrawing:function(){},getEditClass:function(t){var e=new u.EditPolylineVolume(t,this.viewer,this.dataSource);return e._minPointNum=this._minPointNum,e._maxPointNum=this._maxPointNum,this._bindEdit(e)},getAttrClass:function(){return l},finish:function(){this.entity.editing=this.getEditClass(this.entity),this.entity.polylineVolume.positions=this.getDrawPosition()}})},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.EditPolylineVolume=void 0;var n=i(0),r=function(t){return t&&t.__esModule?t:{default:t}}(n),a=i(14);i(11),e.EditPolylineVolume=a.EditPolyline.extend({changePositionsToCallback:function(){var t=this;this._positions_draw=this.entity.polylineVolume.positions.getValue(),this.entity.polylineVolume.positions=new r.default.CallbackProperty(function(e){return t.getPosition()},!1)},finish:function(){this.entity.polylineVolume.positions=this.getPosition()}})},function(t,e,i){"use strict";function n(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e.default=t,e}Object.defineProperty(e,"__esModule",{value:!0}),e.DrawCorridor=void 0;var r=i(0),a=function(t){return t&&t.__esModule?t:{default:t}}(r),o=i(9),s=(i(1),i(67)),l=n(s),u=i(68),c=i(2);n(c),e.DrawCorridor=o.DrawPolyline.extend({type:"corridor",_minPointNum:2,_maxPointNum:9999,createFeature:function(t){this._positions_draw=[],t.config?(this._minPointNum=t.config.minPointNum||2,this._maxPointNum=t.config.maxPointNum||9999):(this._minPointNum=2,this._maxPointNum=9999);var e=this,i={corridor:l.style2Entity(t.style),attribute:t};return i.corridor.positions=new a.default.CallbackProperty(function(t){return e.getDrawPosition()},!1),this.entity=this.dataSource.entities.add(i),this.entity._positions_draw=this._positions_draw,this.entity},style2Entity:function(t,e){return l.style2Entity(t,e.corridor)},updateAttrForDrawing:function(){},getEditClass:function(t){var e=new u.EditCorridor(t,this.viewer,this.dataSource);return e._minPointNum=this._minPointNum,e._maxPointNum=this._maxPointNum,this._bindEdit(e)},getAttrClass:function(){return l},finish:function(){var t=this.entity;t.editing=this.getEditClass(t),t._positions_draw=this.getDrawPosition(),t.corridor.positions=new a.default.CallbackProperty(function(e){return t._positions_draw},!1)}})},function(t,e,i){"use strict";function n(t,e){t=t||{},null==e&&(e={fill:!0});for(var i in t){var n=t[i];switch(i){default:e[i]=n;break;case"opacity":case"outlineOpacity":break;case"outlineColor":e.outlineColor=new l.default.Color.fromCssColorString(n||"#FFFF00").withAlpha(t.outlineOpacity||t.opacity||1);break;case"color":e.material=new l.default.Color.fromCssColorString(n||"#FFFF00").withAlpha(Number(t.opacity||1));break;case"cornerType":switch(n){case"BEVELED":e.cornerType=l.default.CornerType.BEVELED;break;case"MITERED":e.cornerType=l.default.CornerType.MITERED;break;case"ROUNDED":e.cornerType=l.default.CornerType.ROUNDED;break;default:e.cornerType=n}}}return null==e.material&&(e.material=l.default.Color.fromRandom({minimumGreen:.75,maximumBlue:.75,alpha:Number(t.opacity||1)})),e}function r(t){return t.corridor.positions.getValue()}function a(t){var e=r(t);return c.cartesians2lonlats(e)}function o(t){var e=a(t);return{type:"Feature",properties:t.attribute||{},geometry:{type:"LineString",coordinates:e}}}Object.defineProperty(e,"__esModule",{value:!0}),e.style2Entity=n,e.getPositions=r,e.getCoordinates=a,e.toGeoJSON=o;var s=i(0),l=function(t){return t&&t.__esModule?t:{default:t}}(s),u=i(2),c=function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e.default=t,e}(u)},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.EditCorridor=void 0;var n=i(0),r=(function(t){t&&t.__esModule}(n),i(14));e.EditCorridor=r.EditPolyline.extend({changePositionsToCallback:function(){this._positions_draw=this.entity._positions_draw||this.entity.corridor.positions.getValue()},finish:function(){this.entity._positions_draw=this.getPosition()}})},function(t,e,i){"use strict";function n(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e.default=t,e}Object.defineProperty(e,"__esModule",{value:!0}),e.DrawPolygon=void 0;var r=i(0),a=function(t){return t&&t.__esModule?t:{default:t}}(r),o=i(9),s=i(1),l=i(16),u=n(l),c=i(28),d=i(2);n(d),e.DrawPolygon=o.DrawPolyline.extend({type:"polygon",_minPointNum:3,_maxPointNum:9999,createFeature:function(t){this._positions_draw=[],t.config?(this._minPointNum=t.config.minPointNum||3,this._maxPointNum=t.config.maxPointNum||9999):(this._minPointNum=3,this._maxPointNum=9999);var e=this,i={polygon:u.style2Entity(t.style),attribute:t};return i.polygon.hierarchy=new a.default.CallbackProperty(function(t){return e.getDrawPosition()},!1),i.polyline={clampToGround:t.style.clampToGround,show:!1},this.entity=this.dataSource.entities.add(i),this.bindOutline(this.entity),this.entity},style2Entity:function(t,e){return u.style2Entity(t,e.polygon)},bindOutline:function(t){t.polyline.show=new a.default.CallbackProperty(function(e){return t.polygon.hierarchy.getValue().length<3||t.polygon.outline&&t.polygon.outline.getValue()&&t.polygon.outlineWidth&&t.polygon.outlineWidth.getValue()>1},!1),t.polyline.positions=new a.default.CallbackProperty(function(e){if(!t.polyline.show.getValue())return null;var i=t.polygon.hierarchy.getValue();return i.length<3?i:i.concat([i[0]])},!1),t.polyline.width=new a.default.CallbackProperty(function(e){return t.polygon.hierarchy.getValue().length<3?2:t.polygon.outlineWidth},!1),t.polyline.material=new a.default.ColorMaterialProperty(new a.default.CallbackProperty(function(e){return t.polygon.hierarchy.getValue().length<3?t.polygon.material.color.getValue():t.polygon.outlineColor.getValue()},!1))},updateAttrForDrawing:function(){var t=this.entity.attribute.style;if(t.extrudedHeight){var e=(0,s.getMaxHeight)(this.getDrawPosition());this.entity.polygon.extrudedHeight=e+Number(t.extrudedHeight)}},getEditClass:function(t){var e=new c.EditPolygon(t,this.viewer,this.dataSource);return e._minPointNum=this._minPointNum,e._maxPointNum=this._maxPointNum,this._bindEdit(e)},getAttrClass:function(){return u},finish:function(){var t=this.entity;t.editing=this.getEditClass(t),t._positions_draw=this.getDrawPosition(),t.polygon.hierarchy=new a.default.CallbackProperty(function(e){return t._positions_draw},!1)}})},function(t,e,i){"use strict";function n(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e.default=t,e}Object.defineProperty(e,"__esModule",{value:!0}),e.DrawRectangle=void 0;var r=i(0),a=function(t){return t&&t.__esModule?t:{default:t}}(r),o=i(9),s=i(1),l=i(32),u=n(l),c=i(71),d=i(2);n(d),e.DrawRectangle=o.DrawPolyline.extend({type:"rectangle",_minPointNum:2,_maxPointNum:2,getRectangle:function(){var t=this.getDrawPosition();return t.length<2?null:a.default.Rectangle.fromCartesianArray(t)},createFeature:function(t){this._positions_draw=[];var e=this,i={rectangle:u.style2Entity(t.style),attribute:t};return i.rectangle.coordinates=new a.default.CallbackProperty(function(t){return e.getRectangle()},!1),i.polyline={clampToGround:t.style.clampToGround,show:!1},this.entity=this.dataSource.entities.add(i),this.bindOutline(this.entity),this.entity},style2Entity:function(t,e){return u.style2Entity(t,e.rectangle)},bindOutline:function(t){t.polyline.show=new a.default.CallbackProperty(function(e){return t.rectangle.outline&&t.rectangle.outline.getValue()&&t.rectangle.outlineWidth&&t.rectangle.outlineWidth.getValue()>1},!1),t.polyline.positions=new a.default.CallbackProperty(function(e){if(!t.polyline.show.getValue())return null;var i=t._draw_positions,n=t.rectangle.height?t.rectangle.height.getValue():0,r=a.default.Rectangle.fromCartesianArray(i),o=a.default.Cartesian3.fromRadians(r.west,r.south,n);return[o,a.default.Cartesian3.fromRadians(r.east,r.south,n),a.default.Cartesian3.fromRadians(r.east,r.north,n),a.default.Cartesian3.fromRadians(r.west,r.north,n),o]},!1),t.polyline.width=new a.default.CallbackProperty(function(e){return t.rectangle.outlineWidth},!1),t.polyline.material=new a.default.ColorMaterialProperty(new a.default.CallbackProperty(function(e){return t.rectangle.outlineColor.getValue()},!1))},updateAttrForDrawing:function(){var t=this.entity.attribute.style;if(!t.clampToGround){var e=(0,s.getMaxHeight)(this.getDrawPosition());this.entity.rectangle.height=e,t.height=e,t.extrudedHeight&&(this.entity.rectangle.extrudedHeight=e+Number(t.extrudedHeight))}},getEditClass:function(t){var e=new c.EditRectangle(t,this.viewer,this.dataSource);return e._minPointNum=this._minPointNum,e._maxPointNum=this._maxPointNum,this._bindEdit(e)},getAttrClass:function(){return u},finish:function(){var t=this.entity;t.editing=this.getEditClass(t),t._positions_draw=this._positions_draw,t.rectangle.coordinates=new a.default.CallbackProperty(function(e){return t._positions_draw.length<2?null:a.default.Rectangle.fromCartesianArray(t._positions_draw)},!1)}})},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.EditRectangle=void 0;var n=i(0),r=(function(t){t&&t.__esModule}(n),i(6)),a=function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e.default=t,e}(r),o=(i(3),i(28)),s=i(1);e.EditRectangle=o.EditPolygon.extend({changePositionsToCallback:function(){this._positions_draw=this.entity._positions_draw},finish:function(){this.entity._positions_draw=this._positions_draw},isClampToGround:function(){return this.entity.attribute.style.clampToGround},bindDraggers:function(){for(var t=this,e=this.isClampToGround(),i=this.getPosition(),n=0,r=i.length;n<r;n++){var o=i[n];if(void 0!=this.entity.rectangle.height){var l=this.entity.rectangle.height.getValue();o=(0,s.setPositionsHeight)(o,l)}e&&(o=(0,s.updateHeightForClampToGround)(o));var u=a.createDragger(this.dataSource,{position:o,onDrag:function(e,n){if(void 0!=t.entity.rectangle.height){var r=t.entity.rectangle.height.getValue();n=(0,s.setPositionsHeight)(n,r),e.position=n}if(i[e.index]=n,t.heightDraggers&&t.heightDraggers.length>0){var a=t.entity.rectangle.extrudedHeight.getValue();t.heightDraggers[e.index].position=(0,s.setPositionsHeight)(n,a)}}});u.index=n,this.draggers.push(u)}this.entity.rectangle.extrudedHeight&&this.bindHeightDraggers(this.entity.rectangle)}})},function(t,e,i){"use strict";function n(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e.default=t,e}Object.defineProperty(e,"__esModule",{value:!0}),e.DrawCircle=void 0;var r=i(0),a=function(t){return t&&t.__esModule?t:{default:t}}(r),o=i(9),s=(i(1),i(8)),l=(n(s),i(3),i(29)),u=n(l),c=i(73);e.DrawCircle=o.DrawPolyline.extend({type:"ellipse",_minPointNum:2,_maxPointNum:2,getShowPosition:function(){return this._positions_draw&&this._positions_draw.length>1?this._positions_draw[0]:null},createFeature:function(t){this._positions_draw=[],"ellipse"==t.type?this._maxPointNum=3:this._maxPointNum=2;var e=this,i={position:new a.default.CallbackProperty(function(t){return e.getShowPosition()},!1),ellipse:u.style2Entity(t.style),attribute:t};return this.entity=this.dataSource.entities.add(i),this.entity},style2Entity:function(t,e){return u.style2Entity(t,e.ellipse)},updateAttrForDrawing:function(t){if(this._positions_draw){if(t)return void this.addPositionsForRadius(this._positions_draw);if(!(this._positions_draw.length<2)){var e=this.entity.attribute.style;if(!e.clampToGround){var i=this.formatNum(a.default.Cartographic.fromCartesian(this._positions_draw[0]).height,2);if(this.entity.ellipse.height=i,e.height=i,e.extrudedHeight){var n=i+Number(e.extrudedHeight);this.entity.ellipse.extrudedHeight=n}}var r=this.formatNum(a.default.Cartesian3.distance(this._positions_draw[0],this._positions_draw[1]),2);if(this.entity.ellipse.semiMinorAxis=r,3==this._maxPointNum){var o;o=3==this._positions_draw.length?this.formatNum(a.default.Cartesian3.distance(this._positions_draw[0],this._positions_draw[2]),2):r,this.entity.ellipse.semiMajorAxis=o,e.semiMinorAxis=r,e.semiMajorAxis=o}else this.entity.ellipse.semiMajorAxis=r,e.radius=r}}},addPositionsForRadius:function(t){this._positions_draw=[t];var e=this.entity.attribute.style,i=a.default.EllipseGeometryLibrary.computeEllipsePositions({center:t,semiMajorAxis:this.entity.ellipse.semiMajorAxis.getValue(),semiMinorAxis:this.entity.ellipse.semiMinorAxis.getValue(),rotation:a.default.Math.toRadians(Number(e.rotation||0)),granularity:2},!0,!1),n=new a.default.Cartesian3(i.positions[0],i.positions[1],i.positions[2]);if(this._positions_draw.push(n),3==this._maxPointNum){var r=new a.default.Cartesian3(i.positions[3],i.positions[4],i.positions[5]);this._positions_draw.push(r)}},getEditClass:function(t){var e=new c.EditCircle(t,this.viewer,this.dataSource);return e._minPointNum=this._minPointNum,e._maxPointNum=this._maxPointNum,this._bindEdit(e)},getAttrClass:function(){return u},finish:function(){var t=this.entity;t.editing=this.getEditClass(t),t._positions_draw=this._positions_draw,t.position=new a.default.CallbackProperty(function(e){return t._positions_draw&&t._positions_draw.length>0?t._positions_draw[0]:null},!1)}})},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.EditCircle=void 0;var n=i(0),r=function(t){return t&&t.__esModule?t:{default:t}}(n),a=i(6),o=function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e.default=t,e}(a),s=i(3),l=i(28),u=i(1);e.EditCircle=l.EditPolygon.extend({changePositionsToCallback:function(){this._positions_draw=this.entity._positions_draw},finish:function(){this.entity._positions_draw=this._positions_draw},isClampToGround:function(){return this.entity.attribute.style.clampToGround},getPosition:function(){if(void 0!=this.entity.ellipse.height)for(var t=this.entity.ellipse.height.getValue(),e=0,i=this._positions_draw.length;e<i;e++)this._positions_draw[e]=(0,u.setPositionsHeight)(this._positions_draw[e],t);return this._positions_draw},bindDraggers:function(){var t=this,e=this.isClampToGround(),i=this.getPosition(),n=new r.default.Cartesian3,a=new r.default.Cartesian3,l=this.entity.attribute.style,c=i[0];e&&(c=(0,u.updateHeightForClampToGround)(c),i[0]=c);var d=o.createDragger(this.dataSource,{position:c,onDrag:function(e,o){if(r.default.Cartesian3.subtract(o,i[e.index],n),i[e.index]=o,!l.clampToGround){var s=t.formatNum(r.default.Cartographic.fromCartesian(o).height,2);t.entity.ellipse.height=s,l.height=s}r.default.Cartesian3.add(e.majorDragger.position.getValue(),n,a),e.majorDragger.position=a,e.minorDragger&&(r.default.Cartesian3.add(e.minorDragger.position.getValue(),n,a),e.minorDragger.position=a),void 0!=t.entity.attribute.style.extrudedHeight&&t.updateDraggers()}});d.index=0,this.draggers.push(d);var h=r.default.EllipseGeometryLibrary.computeEllipsePositions({center:c,semiMajorAxis:this.entity.ellipse.semiMajorAxis.getValue(),semiMinorAxis:this.entity.ellipse.semiMinorAxis.getValue(),rotation:r.default.Math.toRadians(Number(l.rotation||0)),granularity:2},!0,!1),f=new r.default.Cartesian3(h.positions[0],h.positions[1],h.positions[2]);e&&(f=(0,u.updateHeightForClampToGround)(f)),i[1]=f;var p=o.createDragger(this.dataSource,{position:f,type:o.PointType.EditAttr,tooltip:s.message.dragger.editRadius,onDrag:function(e,n){if(void 0!=t.entity.ellipse.height){var a=t.entity.ellipse.height.getValue();n=(0,u.setPositionsHeight)(n,a),e.position=n}i[e.index]=n;var o=t.formatNum(r.default.Cartesian3.distance(i[0],n),2);t.entity.ellipse.semiMajorAxis=o,l.radius?(t.entity.ellipse.semiMinorAxis=o,l.radius=o):l.semiMajorAxis=o,void 0!=t.entity.attribute.style.extrudedHeight&&t.updateDraggers()}});if(p.index=1,d.majorDragger=p,this.draggers.push(p),3==this._maxPointNum){var g=new r.default.Cartesian3(h.positions[3],h.positions[4],h.positions[5]);e&&(g=(0,u.updateHeightForClampToGround)(g)),i[2]=g;var m=o.createDragger(this.dataSource,{position:g,type:o.PointType.EditAttr,tooltip:s.message.dragger.editRadius,onDrag:function(e,n){if(void 0!=t.entity.ellipse.height){var a=t.entity.ellipse.height.getValue();n=(0,u.setPositionsHeight)(n,a),e.position=n}i[e.index]=n;var o=t.formatNum(r.default.Cartesian3.distance(i[0],n),2);t.entity.ellipse.semiMinorAxis=o,l.radius?(t.entity.ellipse.semiMajorAxis=o,l.radius=o):l.semiMinorAxis=o,void 0!=t.entity.attribute.style.extrudedHeight&&t.updateDraggers()}});m.index=2,d.minorDragger=m,this.draggers.push(m)}if(this.entity.ellipse.extrudedHeight){var y=this.entity.ellipse.extrudedHeight.getValue(),c=(0,u.setPositionsHeight)(i[0],y),v=o.createDragger(this.dataSource,{position:c,onDrag:function(e,n){n=(0,u.setPositionsHeight)(n,t.entity.ellipse.height),i[0]=n,t.updateDraggers()}});this.draggers.push(v);var _=3==this._maxPointNum?[i[1],i[2]]:[i[1]];this.bindHeightDraggers(this.entity.ellipse,_),this.heightDraggers.push(v)}}})},function(t,e,i){"use strict";function n(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e.default=t,e}Object.defineProperty(e,"__esModule",{value:!0}),e.DrawEllipsoid=void 0;var r=i(0),a=function(t){return t&&t.__esModule?t:{default:t}}(r),o=i(9),s=(i(1),i(8)),l=(n(s),i(3),i(33)),u=n(l),c=i(75);e.DrawEllipsoid=o.DrawPolyline.extend({type:"ellipsoid",_minPointNum:2,_maxPointNum:3,getShowPosition:function(){return this._positions_draw&&this._positions_draw.length>0?this._positions_draw[0]:null},createFeature:function(t){this._positions_draw=[];var e=this,i={position:new a.default.CallbackProperty(function(t){return e.getShowPosition()},!1),ellipsoid:u.style2Entity(t.style),attribute:t};return this.entity=this.dataSource.entities.add(i),this.entity},style2Entity:function(t,e){return u.style2Entity(t,e.ellipsoid)},updateAttrForDrawing:function(t){if(this._positions_draw){if(t)return void this.addPositionsForRadius(this._positions_draw);if(!(this._positions_draw.length<2)){var e=this.entity.attribute.style,i=this.formatNum(a.default.Cartesian3.distance(this._positions_draw[0],this._positions_draw[1]),2);e.extentRadii=i,e.heightRadii=i;var n;n=3==this._positions_draw.length?this.formatNum(a.default.Cartesian3.distance(this._positions_draw[0],this._positions_draw[2]),2):i,e.widthRadii=n,this.updateRadii(e)}}},updateRadii:function(t){this.entity.ellipsoid.radii.setValue(new a.default.Cartesian3(t.extentRadii,t.widthRadii,t.heightRadii))},addPositionsForRadius:function(t){this._positions_draw=[t];var e=this.entity.attribute.style,i=a.default.EllipseGeometryLibrary.computeEllipsePositions({center:t,semiMajorAxis:Number(e.extentRadii),semiMinorAxis:Number(e.widthRadii),rotation:a.default.Math.toRadians(Number(e.rotation||0)),granularity:2},!0,!1),n=new a.default.Cartesian3(i.positions[0],i.positions[1],i.positions[2]);this._positions_draw.push(n);var r=new a.default.Cartesian3(i.positions[3],i.positions[4],i.positions[5]);this._positions_draw.push(r)},getEditClass:function(t){var e=new c.EditEllipsoid(t,this.viewer,this.dataSource);return e._minPointNum=this._minPointNum,e._maxPointNum=this._maxPointNum,this._bindEdit(e)},getAttrClass:function(){return u},finish:function(){this.entity.editing=this.getEditClass(this.entity),this.entity._positions_draw=this._positions_draw,this.entity.position=this.getShowPosition()}})},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.EditEllipsoid=void 0;var n=i(0),r=function(t){return t&&t.__esModule?t:{default:t}}(n),a=i(6),o=function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e.default=t,e}(a),s=i(3),l=i(21),u=i(1);e.EditEllipsoid=l.EditBase.extend({_positions_draw:null,changePositionsToCallback:function(){this._positions_draw=this.entity.position.getValue()},finish:function(){this._positions_draw=null},updateRadii:function(t){var e=new r.default.Cartesian3(Number(t.extentRadii),Number(t.widthRadii),Number(t.heightRadii));this.entity.ellipsoid.radii.setValue(e)},bindDraggers:function(){var t=this,e=this.entity.attribute.style,i=this.entity.position.getValue(),n=o.createDragger(this.dataSource,{position:(0,u.addPositionsHeight)(i,e.heightRadii),onDrag:function(e,i){this._positions_draw=i,t.entity.position.setValue(i),t.updateDraggers()}});this.draggers.push(n);var a=r.default.EllipseGeometryLibrary.computeEllipsePositions({center:i,semiMajorAxis:Number(e.extentRadii),semiMinorAxis:Number(e.widthRadii),rotation:r.default.Math.toRadians(Number(e.rotation||0)),granularity:2},!0,!1),l=new r.default.Cartesian3(a.positions[0],a.positions[1],a.positions[2]),c=o.createDragger(this.dataSource,{position:l,type:o.PointType.EditAttr,tooltip:s.message.dragger.editRadius,onDrag:function(i,n){var a=r.default.Cartographic.fromCartesian(t._positions_draw).height;n=(0,u.setPositionsHeight)(n,a),i.position=n;var o=t.formatNum(r.default.Cartesian3.distance(t._positions_draw,n),2);e.extentRadii=o,t.updateRadii(e),t.updateDraggers()}});n.majorDragger=c,this.draggers.push(c);var d=new r.default.Cartesian3(a.positions[3],a.positions[4],a.positions[5]),h=o.createDragger(this.dataSource,{position:d,type:o.PointType.EditAttr,tooltip:s.message.dragger.editRadius,onDrag:function(i,n){var a=r.default.Cartographic.fromCartesian(t._positions_draw).height;n=(0,u.setPositionsHeight)(n,a),i.position=n;var o=t.formatNum(r.default.Cartesian3.distance(t._positions_draw,n),2);e.widthRadii=o,t.updateRadii(e),t.updateDraggers()}});n.minorDragger=h,this.draggers.push(h)}})},function(t,e,i){"use strict";function n(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e.default=t,e}Object.defineProperty(e,"__esModule",{value:!0}),e.DrawWall=void 0;var r=i(0),a=function(t){return t&&t.__esModule?t:{default:t}}(r),o=i(9),s=(i(1),i(34)),l=n(s),u=i(77),c=i(2);n(c),e.DrawWall=o.DrawPolyline.extend({type:"wall",_minPointNum:2,_maxPointNum:9999,createFeature:function(t){this._positions_draw=[],t.config?(this._minPointNum=t.config.minPointNum||2,this._maxPointNum=t.config.maxPointNum||9999):(this._minPointNum=2,this._maxPointNum=9999),this.maximumHeights=[],this.minimumHeights=[];var e=this,i={wall:l.style2Entity(t.style),attribute:t};return i.wall.positions=new a.default.CallbackProperty(function(t){return e.getDrawPosition()},!1),i.wall.minimumHeights=new a.default.CallbackProperty(function(t){return e.getMinimumHeights()},!1),i.wall.maximumHeights=new a.default.CallbackProperty(function(t){return e.getMaximumHeights()},!1),this.entity=this.dataSource.entities.add(i),this.entity},style2Entity:function(t,e){return l.style2Entity(t,e.wall)},maximumHeights:null,getMaximumHeights:function(t){return this.maximumHeights},minimumHeights:null,getMinimumHeights:function(t){return this.minimumHeights},updateAttrForDrawing:function(){var t=this.entity.attribute.style,e=this.getDrawPosition(),i=e.length;this.maximumHeights=new Array(i),this.minimumHeights=new Array(i);for(var n=0;n<i;n++){var r=a.default.Cartographic.fromCartesian(e[n]).height;this.minimumHeights[n]=r,this.maximumHeights[n]=r+Number(t.extrudedHeight)}},getEditClass:function(t){var e=new u.EditWall(t,this.viewer,this.dataSource);return e._minPointNum=this._minPointNum,e._maxPointNum=this._maxPointNum,this._bindEdit(e)},getAttrClass:function(){return l},finish:function(){this.entity.editing=this.getEditClass(this.entity),this.entity.wall.positions=this.getDrawPosition(),this.entity.wall.minimumHeights=this.getMinimumHeights(),this.entity.wall.maximumHeights=this.getMaximumHeights()}})},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.EditWall=void 0;var n=i(0),r=function(t){return t&&t.__esModule?t:{default:t}}(n),a=i(6),o=function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e.default=t,e}(a),s=i(3),l=i(14),u=i(1);e.EditWall=l.EditPolyline.extend({changePositionsToCallback:function(){var t=this;this._positions_draw=this.entity.wall.positions.getValue(),this.entity.wall.positions=new r.default.CallbackProperty(function(e){return t.getPosition()},!1),this.minimumHeights=this.entity.wall.minimumHeights.getValue(),this.entity.wall.minimumHeights=new r.default.CallbackProperty(function(e){return t.getMinimumHeights()},!1),this.maximumHeights=this.entity.wall.maximumHeights.getValue(),this.entity.wall.maximumHeights=new r.default.CallbackProperty(function(e){return t.getMaximumHeights()},!1)},maximumHeights:null,getMaximumHeights:function(t){return this.maximumHeights},minimumHeights:null,getMinimumHeights:function(t){return this.minimumHeights},updateAttrForEditing:function(){var t=this.entity.attribute.style,e=this.getPosition(),i=e.length;this.maximumHeights=new Array(i),this.minimumHeights=new Array(i);for(var n=0;n<i;n++){var a=r.default.Cartographic.fromCartesian(e[n]).height;this.minimumHeights[n]=a,this.maximumHeights[n]=a+Number(t.extrudedHeight)}},finish:function(){this.entity.wall.positions=this.getPosition()},bindDraggers:function(){for(var t=this,e=this.isClampToGround(),i=this.getPosition(),n=this.entity.attribute.style,a=i.length<this._maxPointNum,l=0,c=i.length;l<c;l++){var d=i[l],h=o.createDragger(this.dataSource,{position:d,clampToGround:e,onDrag:function(e,o){i[e.index]=o,t.heightDraggers&&t.heightDraggers.length>0&&(t.heightDraggers[e.index].position=(0,u.addPositionsHeight)(o,n.extrudedHeight)),a&&(e.index>0&&(t.draggers[2*e.index-1].position=r.default.Cartesian3.midpoint(o,i[e.index-1],new r.default.Cartesian3)),e.index<i.length-1&&(t.draggers[2*e.index+1].position=r.default.Cartesian3.midpoint(o,i[e.index+1],new r.default.Cartesian3)))}});if(h.index=l,this.draggers.push(h),a){var f=l+1;if(f<c){var p=r.default.Cartesian3.midpoint(d,i[f],new r.default.Cartesian3),g=o.createDragger(this.dataSource,{position:p,type:o.PointType.AddMidPoint,tooltip:s.message.dragger.addMidPoint,clampToGround:e,onDragStart:function(e,n){i.splice(e.index,0,n),t.updateAttrForEditing()},onDrag:function(t,e){i[t.index]=e},onDragEnd:function(e,i){t.updateDraggers()}});g.index=f,this.draggers.push(g)}}}this.bindHeightDraggers()},heightDraggers:null,bindHeightDraggers:function(){var t=this;this.heightDraggers=[];for(var e=this.getPosition(),i=this.entity.attribute.style,n=Number(i.extrudedHeight),a=0,l=e.length;a<l;a++){var c=(0,u.addPositionsHeight)(e[a],n),d=o.createDragger(this.dataSource,{position:c,type:o.PointType.MoveHeight,tooltip:s.message.dragger.moveHeight,onDrag:function(n,a){var o=r.default.Cartographic.fromCartesian(a).height;i.extrudedHeight=t.formatNum(o-t.minimumHeights[n.index],2);for(var s=0;s<e.length;s++)s!=n.index&&(t.heightDraggers[s].position=(0,u.addPositionsHeight)(e[s],i.extrudedHeight));t.updateAttrForEditing()}});d.index=a,this.draggers.push(d),this.heightDraggers.push(d)}}})},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.DrawPModel=void 0;var n=i(0),r=function(t){return t&&t.__esModule?t:{default:t}}(n),a=i(26),o=i(1),s=i(27),l=function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e.default=t,e}(s),u=i(3),c=i(79);e.DrawPModel=a.DrawBase.extend({type:"point",createFeature:function(t){var e=this;this._positions_draw=r.default.Cartesian3.ZERO;var i=t.style,n=this.primitives.add(r.default.Model.fromGltf({url:i.modelUrl,modelMatrix:this.getModelMatrix(i),minimumPixelSize:i.minimumPixelSize||30}));return n.readyPromise.then(function(t){e.style2Entity(i,e.entity)}),n.attribute=t,this.entity=n,this.entity},getModelMatrix:function(t,e){var i=new r.default.HeadingPitchRoll(r.default.Math.toRadians(t.heading||0),r.default.Math.toRadians(t.pitch||0),r.default.Math.toRadians(t.roll||0)),n=r.default.Transforms.eastNorthUpToFixedFrame,a=r.default.Transforms.headingPitchRollToFixedFrame(e||this._positions_draw,i,this.viewer.scene.globe.ellipsoid,n);return t.scale&&r.default.Matrix4.multiplyByUniformScale(a,t.scale,a),a},style2Entity:function(t,e){return e.modelMatrix=this.getModelMatrix(t,e.position),l.style2Entity(t,e)},bindEvent:function(){var t=this;this.getHandler().setInputAction(function(e){var i=(0,o.getCurrentMousePosition)(t.viewer.scene,e.endPosition,t.entity);i&&(t._positions_draw=i,t.entity.modelMatrix=t.getModelMatrix(t.entity.attribute.style)),t.tooltip.showAt(e.endPosition,u.message.draw.point.start)},r.default.ScreenSpaceEventType.MOUSE_MOVE),this.getHandler().setInputAction(function(e){var i=(0,o.getCurrentMousePosition)(t.viewer.scene,e.position,t.entity);i&&(t._positions_draw=i,t.disable())},r.default.ScreenSpaceEventType.LEFT_CLICK)},getEditClass:function(t){var e=new c.EditPModel(t,this.viewer,this.dataSource);return this._bindEdit(e)},getAttrClass:function(){return l},finish:function(){this.entity.modelMatrix=this.getModelMatrix(this.entity.attribute.style),this.entity.editing=this.getEditClass(this.entity),this.entity.position=this.getDrawPosition()}})},function(t,e,i){"use strict";function n(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e.default=t,e}Object.defineProperty(e,"__esModule",{value:!0}),e.EditPModel=void 0;var r=i(0),a=function(t){return t&&t.__esModule?t:{default:t}}(r),o=i(6),s=n(o),l=i(3),u=i(21),c=i(29),d=n(c),h=i(1);e.EditPModel=u.EditBase.extend({setPositions:function(t){this.entity.position=t,this.entity.modelMatrix=this.getModelMatrix()},getModelMatrix:function(t){var e=this.entity.attribute.style,i=new a.default.HeadingPitchRoll(a.default.Math.toRadians(e.heading||0),a.default.Math.toRadians(e.pitch||0),a.default.Math.toRadians(e.roll||0)),n=a.default.Transforms.eastNorthUpToFixedFrame,r=a.default.Transforms.headingPitchRollToFixedFrame(t||this.entity.position,i,this.viewer.scene.globe.ellipsoid,n);return e.scale&&a.default.Matrix4.multiplyByUniformScale(r,e.scale,r),r},bindDraggers:function(){if(!this.entity.ready){var t=this;return void this.entity.readyPromise.then(function(e){t.bindDraggers()})}var t=this;this.entity.draw_tooltip=l.message.dragger.def;var e=s.createDragger(this.dataSource,{dragger:this.entity,onDrag:function(e,i){t.entity.position=i,t.entity.modelMatrix=t.getModelMatrix(i),t.updateDraggers()}}),i=this.entity.attribute.style,n=this.entity.position,r=a.default.Cartographic.fromCartesian(n).height,o=this.entity.boundingSphere.radius;this.entityAngle=this.dataSource.entities.add({name:"角度调整底部圆",position:new a.default.CallbackProperty(function(e){return t.entity.position},!1),ellipse:d.style2Entity({fill:!1,outline:!0,outlineColor:"#ffff00",outlineOpacity:.8,radius:o,height:r})});var u=this.getHeadingPosition(),c=s.createDragger(this.dataSource,{position:u,type:s.PointType.EditAttr,tooltip:l.message.dragger.editHeading,onDrag:function(e,n){var r=t.getHeading(t.entity.position,n);i.heading=t.formatNum(r,1),t.entity.modelMatrix=t.getModelMatrix(),e.position=t.getHeadingPosition()}});this.draggers.push(c);var f=(0,h.addPositionsHeight)(n,o),e=s.createDragger(this.dataSource,{position:f,type:s.PointType.MoveHeight,tooltip:l.message.dragger.editScale,onDrag:function(e,r){var o=a.default.Cartesian3.distance(r,n),s=e.radius/i.scale,l=o/s;e.radius=o,i.scale=t.formatNum(l,2),t.entity.modelMatrix=t.getModelMatrix(),t.updateDraggers()}});e.radius=o,this.draggers.push(e)},destroyDraggers:function(){u.EditBase.prototype.destroyDraggers.call(this),this.entityAngle&&(this.dataSource.entities.remove(this.entityAngle),delete this.entityAngle),this.entityBox&&(this.dataSource.entities.remove(this.entityBox),delete this.entityBox)},finish:function(){this.entity.draw_tooltip=null},getHeadingPosition:function(){var t=this.entity.position,e=this.entity.boundingSphere.radius,i=-Number(this.entity.attribute.style.heading||0),n=new a.default.Cartesian3(e,0,0),r=a.default.Transforms.eastNorthUpToFixedFrame(t),o=a.default.Matrix4.fromRotationTranslation(a.default.Matrix3.fromRotationZ(a.default.Math.toRadians(i)));return a.default.Matrix4.multiply(r,o,r),r=a.default.Matrix4.getRotation(r,new a.default.Matrix3),n=a.default.Matrix3.multiplyByVector(r,n,n),n=a.default.Cartesian3.add(t,n,n)},getHeading:function(t,e){var i=a.default.Transforms.eastNorthUpToFixedFrame(t);i=a.default.Matrix4.getRotation(i,new a.default.Matrix3);var n=a.default.Matrix3.getColumn(i,0,new a.default.Cartesian3),r=a.default.Matrix3.getColumn(i,1,new a.default.Cartesian3),o=a.default.Matrix3.getColumn(i,2,new a.default.Cartesian3),s=a.default.Cartesian3.subtract(e,t,new a.default.Cartesian3);s=a.default.Cartesian3.cross(s,o,s),s=a.default.Cartesian3.cross(o,s,s),s=a.default.Cartesian3.normalize(s,s);var l=a.default.Cartesian3.angleBetween(n,s);return a.default.Cartesian3.angleBetween(r,s)>.5*Math.PI&&(l=2*Math.PI-l),-a.default.Math.toDegrees(l)}})},function(t,e,i){"use strict";function n(t){var e;switch(t.layer){case"vec":default:e="http://online{s}.map.bdimg.com/onlinelabel/?qt=tile&x={x}&y={y}&z={z}&styles="+(t.bigfont?"ph":"pl")+"&scaler=1&p=1";break;case"img_d":e="http://shangetu{s}.map.bdimg.com/it/u=x={x};y={y};z={z};v=009;type=sate&fm=46";break;case"img_z":e="http://online{s}.map.bdimg.com/tile/?qt=tile&x={x}&y={y}&z={z}&styles="+(t.bigfont?"sh":"sl")+"&v=020";break;case"custom":t.customid=t.customid||"midnight",e="http://api{s}.map.bdimg.com/customimage/tile?&x={x}&y={y}&z={z}&scale=1&customid="+t.customid;break;case"time":e="http://its.map.baidu.com:8002/traffic/TrafficTileService?x={x}&y={y}&level={z}&time="+(new Date).getTime()+"&label=web2D&v=017"}this._url=e,this._tileWidth=256,this._tileHeight=256,this._maximumLevel=18;var i=new Cesium.Cartesian2(-a,-r),n=new Cesium.Cartesian2(a,r);this._tilingScheme=new Cesium.WebMercatorTilingScheme({rectangleSouthwestInMeters:i,rectangleNortheastInMeters:n}),this._credit=void 0,this._rectangle=this._tilingScheme.rectangle,this._ready=!0}Object.defineProperty(e,"__esModule",{value:!0});var r=33746824,a=33554054;Cesium.defineProperties(n.prototype,{url:{get:function(){return this._url}},token:{get:function(){return this._token}},proxy:{get:function(){return this._proxy}},tileWidth:{get:function(){if(!this._ready)throw new DeveloperError("tileWidth must not be called before the imagery provider is ready.");return this._tileWidth}},tileHeight:{get:function(){if(!this._ready)throw new DeveloperError("tileHeight must not be called before the imagery provider is ready.");return this._tileHeight}},maximumLevel:{get:function(){if(!this._ready)throw new DeveloperError("maximumLevel must not be called before the imagery provider is ready.");return this._maximumLevel}},minimumLevel:{get:function(){if(!this._ready)throw new DeveloperError("minimumLevel must not be called before the imagery provider is ready.");return 0}},tilingScheme:{get:function(){if(!this._ready)throw new DeveloperError("tilingScheme must not be called before the imagery provider is ready.");return this._tilingScheme}},rectangle:{get:function(){if(!this._ready)throw new DeveloperError("rectangle must not be called before the imagery provider is ready.");return this._rectangle}},tileDiscardPolicy:{get:function(){if(!this._ready)throw new DeveloperError("tileDiscardPolicy must not be called before the imagery provider is ready.");return this._tileDiscardPolicy}},errorEvent:{get:function(){return this._errorEvent}},ready:{get:function(){return this._ready}},readyPromise:{get:function(){return this._readyPromise.promise}},credit:{get:function(){return this._credit}},usingPrecachedTiles:{get:function(){return this._useTiles}},hasAlphaChannel:{get:function(){return!0}},layers:{get:function(){return this._layers}}}),n.prototype.getTileCredits=function(t,e,i){},n.prototype.requestImage=function(t,e,i){if(!this._ready)throw new DeveloperError("requestImage must not be called before the imagery provider is ready.");var n=this._tilingScheme.getNumberOfXTilesAtLevel(i),r=this._tilingScheme.getNumberOfYTilesAtLevel(i),a=this._url.replace("{x}",t-n/2).replace("{y}",r/2-e-1).replace("{z}",i).replace("{s}",Math.floor(10*Math.random()));return Cesium.ImageryProvider.loadImage(this,a)},e.BaiduImageryProvider=n},function(t,e,i){"use strict";function n(t){if(t=a.default.defaultValue(t,a.default.defaultValue.EMPTY_OBJECT),this.options=t,this._tileWidth=a.default.defaultValue(t.tileWidth,256),this._tileHeight=a.default.defaultValue(t.tileHeight,256),this._minimumLevel=a.default.defaultValue(t.minimumLevel,0),this._maximumLevel=t.maximumLevel,t.rectangle&&t.rectangle.xmin&&t.rectangle.xmax&&t.rectangle.ymin&&t.rectangle.ymax){var e=t.rectangle.xmin,i=t.rectangle.xmax,n=t.rectangle.ymin,r=t.rectangle.ymax;t.rectangle=a.default.Rectangle.fromDegrees(e,n,i,r)}this._tilingScheme=a.default.defaultValue(t.tilingScheme,new a.default.GeographicTilingScheme({ellipsoid:t.ellipsoid})),this._rectangle=a.default.defaultValue(t.rectangle,this._tilingScheme.rectangle),this._rectangle=a.default.Rectangle.intersection(this._rectangle,this._tilingScheme.rectangle),this._hasAlphaChannel=a.default.defaultValue(t.hasAlphaChannel,!0),this._errorEvent=new a.default.Event,this._readyPromise=a.default.when.resolve(!0),this._credit=void 0,this._ready=!0}Object.defineProperty(e,"__esModule",{value:!0}),e.FeatureGridImageryProvider=void 0;var r=i(0),a=function(t){return t&&t.__esModule?t:{default:t}}(r);a.default.defineProperties(n.prototype,{url:{get:function(){return this._url}},token:{get:function(){return this._token}},proxy:{get:function(){return this._proxy}},tileWidth:{get:function(){if(!this._ready)throw new DeveloperError("tileWidth must not be called before the imagery provider is ready.");return this._tileWidth}},tileHeight:{get:function(){if(!this._ready)throw new DeveloperError("tileHeight must not be called before the imagery provider is ready.");return this._tileHeight}},maximumLevel:{get:function(){if(!this._ready)throw new DeveloperError("maximumLevel must not be called before the imagery provider is ready.");return this._maximumLevel}},minimumLevel:{get:function(){if(!this._ready)throw new DeveloperError("minimumLevel must not be called before the imagery provider is ready.");return 0}},tilingScheme:{get:function(){if(!this._ready)throw new DeveloperError("tilingScheme must not be called before the imagery provider is ready.");return this._tilingScheme}},rectangle:{get:function(){if(!this._ready)throw new DeveloperError("rectangle must not be called before the imagery provider is ready.");return this._rectangle}},tileDiscardPolicy:{get:function(){if(!this._ready)throw new DeveloperError("tileDiscardPolicy must not be called before the imagery provider is ready.");return this._tileDiscardPolicy}},errorEvent:{get:function(){return this._errorEvent}},ready:{get:function(){return this._ready}},readyPromise:{get:function(){return this._readyPromise.promise}},credit:{get:function(){return this._credit}},usingPrecachedTiles:{get:function(){return this._useTiles}},hasAlphaChannel:{get:function(){return!0}},layers:{get:function(){return this._layers}}}),n.prototype.getTileCredits=function(t,e,i){},n.prototype.requestImage=function(t,e,i){var n=document.createElement("canvas");if(n.width=256,n.height=256,i<this._minimumLevel)return n;if(this.options.debuggerTileInfo){var r=n.getContext("2d");r.strokeStyle="#ffff00",r.lineWidth=2,r.strokeRect(1,1,255,255);var a="L"+i+"X"+t+"Y"+e;r.font="bold 25px Arial",r.textAlign="center",r.fillStyle="black",r.fillText(a,127,127),r.fillStyle="#ffff00",r.fillText(a,124,124)}return n},n.prototype._getGridKey=function(t){return t.level+"_x"+t.x+"_y"+t.y},n.prototype.addImageryCache=function(t){t.level<this._minimumLevel||t.level<t.maxLevel-1||this.options.addImageryCache&&(t.key=this._getGridKey(t),this.options.addImageryCache(t))},n.prototype.removeImageryCache=function(t){t.maxLevel<this._minimumLevel&&this.options.removeAllImageryCache&&this.options.removeAllImageryCache(),t.level<this._minimumLevel||this.options.removeImageryCache&&(t.key=this._getGridKey(t),this.options.removeImageryCache(t))},e.FeatureGridImageryProvider=n},function(t,e,i){"use strict";function n(t,e){return r(t,d.default.Matrix4.fromRotationTranslation(d.default.Matrix3.fromQuaternion(e,h),t,f))}function r(t,e){var i=d.default.Transforms.eastNorthUpToFixedFrame(t,d.default.Ellipsoid.WGS84,new d.default.Matrix4),n=d.default.Matrix4.multiply(d.default.Matrix4.inverse(i,new d.default.Matrix4),e,new d.default.Matrix4),r=d.default.Matrix4.getRotation(n,new d.default.Matrix3),a=d.default.Quaternion.fromRotationMatrix(r);return d.default.HeadingPitchRoll.fromQuaternion(a)}function a(t,e,i){i=i||d.default.Ellipsoid.WGS84;var n=d.default.Cartesian3.normalize(d.default.Cartesian3.subtract(e,t,p),p);d.default.Transforms.rotationMatrixFromPositionVelocity(t,n,i,g);var a=d.default.Matrix4.fromRotationTranslation(g,t,f);return d.default.Matrix4.multiplyTransformation(a,d.default.Axis.Z_UP_TO_X_UP,a),r(t,a)}function o(t,e,i){var n=d.default.Cartographic.fromCartesian(t);n.height=0;var r=d.default.Cartographic.toCartesian(n),a=d.default.Cartesian3.normalize(d.default.Cartesian3.subtract(r,t,new d.default.Cartesian3),new d.default.Cartesian3),o=d.default.Quaternion.fromAxisAngle(a,d.default.Math.toRadians(i)),s=d.default.Matrix3.fromQuaternion(o),l=d.default.Matrix4.fromRotationTranslation(s),u=d.default.Cartesian3.subtract(e,t,new d.default.Cartesian3),c=d.default.Matrix4.multiplyByPoint(l,u,new d.default.Cartesian3);return d.default.Cartesian3.add(c,t,new d.default.Cartesian3)}function s(t,e,i,n){i=i||0,n=n||"z";var r=d.default.Math.toRadians(-i);n="UNIT_"+n.toUpperCase();var a=d.default.Quaternion.fromAxisAngle(d.default.Cartesian3[n],r),o=d.default.Matrix3.fromQuaternion(a),s=new d.default.Cartesian3(e.x,e.y,e.z),l=d.default.Matrix4.fromRotationTranslation(o,d.default.Cartesian3.ZERO);d.default.Matrix4.multiplyByTranslation(l,s,l);var u=d.default.Ellipsoid.WGS84.cartographicToCartesian(d.default.Cartographic.fromCartesian(t)),c=d.default.Transforms.eastNorthUpToFixedFrame(u);d.default.Matrix4.multiplyTransformation(c,l,l);var h=new d.default.Cartesian3;return d.default.Matrix4.getTranslation(l,h),h}function l(t,e){for(var i=[],n=1;n<t.length;n++){var r=t[n-1],a=t[n],o=d.default.Cartesian3.subtract(r,a,new d.default.Cartesian3),s=d.default.Cartesian3.cross(r,o,new d.default.Cartesian3),l=u(r,s,1e3*e),c=u(a,s,1e3*e);1==n&&i.push(l),i.push(c)}return i}function u(t,e,i){var n=new d.default.Ray(t,e);return d.default.Ray.getPoint(n,i,new d.default.Cartesian3)}Object.defineProperty(e,"__esModule",{value:!0}),e.getHeadingPitchRollByOrientation=n,e.getHeadingPitchRollByMatrix=r,e.getHeadingPitchRollForLine=a,e.getRotateCenterPoint=o,e.getPositionTranslation=s,e.getOffsetLine=l;var c=i(0),d=function(t){return t&&t.__esModule?t:{default:t}}(c),h=new d.default.Matrix3,f=new d.default.Matrix4,p=new d.default.Cartesian3,f=new d.default.Matrix4,g=new d.default.Matrix3},function(t,e,i){"use strict";function n(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e.default=t,e}Object.defineProperty(e,"__esModule",{value:!0}),e.Measure=void 0;var r=i(0),a=function(t){return t&&t.__esModule?t:{default:t}}(r),o=i(25),s=i(8),l=n(s),u=i(13),c=i(16),d=n(c),h=i(4),f=i(1),p=function(t){function e(t){p(),C="length",t=t||{},t.type=C,t.hasOwnProperty("terrain")||(t.terrain=!0),M.start(t)}function i(t){p(),C="section",t=t||{},t.type=C,t.terrain=!0,M.start(t)}function n(t){p(),C="area",t=t||{},t.type=C,E.start(t)}function r(t){p(),C="volume",t=t||{},t.type=C,L.start(t)}function s(t){p(),t=t||{},t.hasOwnProperty("isSuper")&&!t.isSuper?(C="height",t.type=C,S.start(t)):(C="super_height",t.type=C,O.start(t))}function c(t){p(),C="angle",t=t||{},t.type=C,T.start(t)}function p(){M.clearLastNoEnd(),E.clearLastNoEnd(),L.clearLastNoEnd(),S.clearLastNoEnd(),O.clearLastNoEnd(),T.clearLastNoEnd(),x.stopDraw()}function g(){C="",p(),x.deleteAll()}function m(t,e){var i=P.entities.values;for(var n in i){var r=i[n];if(r.label&&r.isMarsMeasureLabel&&r.attribute&&r.attribute.value){if(r.attribute.type!=t)continue;"area"==t?r.label.text._value=(r.attribute.textEx||"")+y(r.attribute.value,e):r._label.text._value=(r.attribute.textEx||"")+v(r.attribute.value,e)}}}function y(t,e){if(null==t)return"";null!=e&&"auto"!=e||(e=t<1e6?"m":"km");var i="";switch(e){default:case"m":i=t.toFixed(2)+"平方米";break;case"km":i=(t/1e6).toFixed(2)+"平方公里";break;case"mu":i=(.0015*t).toFixed(2)+"亩";break;case"ha":i=(1e-4*t).toFixed(2)+"公顷"}return i}function v(t,e){if(null==t)return"";null!=e&&"auto"!=e||(e=t<1e3?"m":"km");var i="";switch(e){default:case"m":i=t.toFixed(2)+"米";break;case"km":i=(.001*t).toFixed(2)+"公里";break;case"mile":i=(54e-5*t).toFixed(2)+"海里";break;case"zhang":i=(.3*t).toFixed(2)+"丈"}return i}var _=t.viewer,w={color:"#ffffff",font_family:"楷体",font_size:20,border:!0,border_color:"#000000",border_width:3,background:!0,background_color:"#000000",background_opacity:.5,scaleByDistance:!0,scaleByDistance_far:8e5,scaleByDistance_farValue:.5,scaleByDistance_near:1e3,scaleByDistance_nearValue:1,pixelOffset:[0,-15],disableDepthTestDistance:Number.POSITIVE_INFINITY};if(t.label)for(var b in t.label)w[b]=t.label[b];var C="",x=new o.Draw(_,{hasEdit:!1,removeScreenSpaceEvent:!1});x.on(l.DrawAddPoint,function(t){var e=t.entity;switch(C){case"length":case"section":M.showAddPointLength(e);break;case"area":E.showAddPointLength(e);break;case"volume":L.showAddPointLength(e);break;case"height":S.showAddPointLength(e);break;case"super_height":O.showAddPointLength(e);break;case"angle":T.showAddPointLength(e)}}),x.on(l.DrawRemovePoint,function(t){switch(C){case"length":case"section":M.showRemoveLastPointLength(t);break;case"area":E.showRemoveLastPointLength(t);break;case"volume":L.showRemoveLastPointLength(t);break;case"height":S.showRemoveLastPointLength(t);break;case"super_height":O.showRemoveLastPointLength(t);break;case"angle":T.showRemoveLastPointLength(t)}}),x.on(l.DrawMouseMove,function(t){var e=t.entity;switch(C){case"length":case"section":M.showMoveDrawing(e);break;case"area":E.showMoveDrawing(e);break;case"volume":L.showMoveDrawing(e);break;case"height":S.showMoveDrawing(e);break;case"super_height":O.showMoveDrawing(e);break;case"angle":T.showMoveDrawing(e)}}),x.on(l.DrawCreated,function(t){var e=t.entity;switch(C){case"length":case"section":M.showDrawEnd(e);break;case"area":E.showDrawEnd(e);break;case"volume":L.showDrawEnd(e);break;case"height":S.showDrawEnd(e);break;case"super_height":O.showDrawEnd(e);break;case"angle":T.showDrawEnd(e)}});var P=x.getDataSource(),M={options:null,arrLables:[],totalLable:null,disTerrainScale:1.2,clearLastNoEnd:function(){if(null!=this.totalLable&&P.entities.remove(this.totalLable),this.arrLables&&this.arrLables.length>0){var t=this.arrLables;if(t&&t.length>0)for(var e in t)P.entities.remove(t[e])}this.totalLable=null,this.arrLables=[]},start:function(t){this.options=t;var e=(0,u.style2Entity)(w,{horizontalOrigin:a.default.HorizontalOrigin.LEFT,verticalOrigin:a.default.VerticalOrigin.BOTTOM,show:!1});this.totalLable=P.entities.add({label:e,isMarsMeasureLabel:!0,attribute:{unit:this.options.unit,type:this.options.type}}),this.arrLables=[],x.startDraw({type:"polyline",config:{addHeight:t.addHeight},style:t.style||{lineType:"glow",color:"#ebe12c",width:9,glowPower:.1,clampToGround:"section"==this.options.type||this.options.terrain}})},showAddPointLength:function(t){var e=x.getPositions(t),i=(0,u.style2Entity)(w,{horizontalOrigin:a.default.HorizontalOrigin.LEFT,verticalOrigin:a.default.VerticalOrigin.BOTTOM,show:!0}),n=P.entities.add({position:e[e.length-1],label:i,isMarsMeasureLabel:!0,attribute:{unit:this.options.unit,type:this.options.type}});if(1==e.length)n.label.text="起点";else{var r=this.getLength(e),o=v(r,this.options.unit);n.label.text=o,n.attribute.value=r,this.getLength([e[e.length-2],e[e.length-1]])<5&&(n.show=!1)}this.arrLables.push(n)},showRemoveLastPointLength:function(t){var e=this.arrLables.pop();P.entities.remove(e),this.showMoveDrawing(t.entity),this.totalLable.position=t.position},showMoveDrawing:function(t){var e=x.getPositions(t);if(e.length<2)return void(this.totalLable.label.show=!1);var i=this.getLength(e),n=v(i,this.options.unit);this.totalLable.position=e[e.length-1],this.totalLable.label.text="总长:"+n,this.totalLable.label.show=!0,this.totalLable.attribute.value=i,this.totalLable.attribute.textEx="总长:",this.options.calback&&this.options.calback(n,i)},showDrawEnd:function(t){var e=x.getPositions(t),i=this.arrLables.length-e.length;if(i>=0){for(var n=this.arrLables.length-1;n>=e.length-1;n--)P.entities.remove(this.arrLables[n]);this.arrLables.splice(e.length-1,i+1)}t._totalLable=this.totalLable,t._arrLables=this.arrLables,this.totalLable=null,this.arrLables=[],null!=t.polyline&&("section"==this.options.type?this.updateSectionForTerrain(t):this.options.terrain&&this.updateLengthForTerrain(t))},updateLengthForTerrain:function(t){function e(){if(++s>=n.length&&a){var t=v(l,o);return a.label.text="总长:"+t,a.attribute.value=l,void(i.options.calback&&i.options.calback(t,l))}var u=[n[s-1],n[s]];(0,h.terrainPolyline)({viewer:_,positions:u,calback:function(t,n){var a=i.getLength(t);n&&(a*=i.disTerrainScale);var u=r[s];if(u){var c=v(a,o);u.label.text=c,u.attribute.value=a}l+=a,e()}})}var i=this,n=t.polyline.positions.getValue(),r=t._arrLables,a=t._totalLable,o=a&&a.unit,s=0,l=0;e()},updateSectionForTerrain:function(t){function e(){s++;var t=[i[s-1],i[s]];(0,h.terrainPolyline)({viewer:_,positions:t,calback:function(h,y){l=y?1==s?l.concat(t):l.concat([i[s]]):l.concat(h);for(var _=a.default.Cartographic.fromCartesian(i[s-1]).height,w=a.default.Cartographic.fromCartesian(i[s]).height,b=(w-_)/h.length,C=0;C<h.length;C++){0!=C&&(u+=a.default.Cartesian3.distance(h[C],h[C-1])),c.push(Number(u.toFixed(1)));var x=(0,f.formatPositon)(h[C]);d.push(x.z),g.push(x);var P=Number((_+b*C).toFixed(1));p.push(P)}if(s>=i.length-1){if(r){var M=m.getLength(l),E=v(M,o);r.label.text="总长:"+E,r.attribute.value=M}m.options.calback&&m.options.calback({distancestr:E,distance:M,arrLen:c,arrLX:p,arrHB:d,arrPoint:g})}else{var M=m.getLength(h),E=v(M,o),L=n[s];L.label.text=E,L.attribute.value=M,e()}}})}var i=t.polyline.positions.getValue();if(!(i.length<2)){var n=t._arrLables,r=t._totalLable,o=r&&r.unit,s=0,l=[],u=0,c=[],d=[],p=[],g=[],m=this;e()}},getLength:function(t){for(var e=0,i=0,n=t.length-1;i<n;i++)e+=a.default.Cartesian3.distance(t[i],t[i+1]);return e}},E={options:null,totalLable:null,clearLastNoEnd:function(){null!=this.totalLable&&P.entities.remove(this.totalLable),this.totalLable=null},start:function(t){this.options=t;var e=(0,u.style2Entity)(w,{horizontalOrigin:a.default.HorizontalOrigin.CENTER,verticalOrigin:a.default.VerticalOrigin.BOTTOM,show:!1});this.totalLable=P.entities.add({label:e,isMarsMeasureLabel:!0,attribute:{unit:this.options.unit,type:this.options.type}}),x.startDraw({type:"polygon",style:t.style||{color:"#00fff2",outline:!0,outlineColor:"#fafa5a",outlineWidth:1,opacity:.4,clampToGround:!0}})},showAddPointLength:function(t){},showRemoveLastPointLength:function(t){x.getPositions(t.entity).length<3&&(this.totalLable.label.show=!1)},showMoveDrawing:function(t){var e=x.getPositions(t);if(e.length<3)return void(this.totalLable.label.show=!1);var i=d.toGeoJSON(t),n=turf.area(i),r=y(n,this.options.unit),o=(0,f.getMaxHeight)(e),s=turf.centerOfMass(i),l=a.default.Cartesian3.fromDegrees(s.geometry.coordinates[0],s.geometry.coordinates[1],o+1);this.totalLable.position=l,this.totalLable.label.text="面积:"+r,this.totalLable.label.show=!0,this.totalLable.attribute.value=n,this.totalLable.attribute.textEx="面积:",this.options.calback&&this.options.calback(r,n)},showDrawEnd:function(t){if(null!=t.polygon){for(var e=t.polygon.hierarchy.getValue(),i=0,n=e.length;i<n;i++)e[i].z=e[i].z+1;t._totalLable=this.totalLable,this.totalLable=null}}},L={options:null,totalLable:null,prevEntity:null,clearLastNoEnd:function(){null!=this.totalLable&&P.entities.remove(this.totalLable),this.totalLable=null,null!=this.prevEntity&&P.entities.remove(this.prevEntity),this.prevEntity=null},start:function(t){this.options=t;var e=(0,u.style2Entity)(w,{horizontalOrigin:a.default.HorizontalOrigin.CENTER,verticalOrigin:a.default.VerticalOrigin.BOTTOM,show:!1});this.totalLable=P.entities.add({label:e,isMarsMeasureLabel:!0,attribute:{unit:this.options.unit,type:this.options.type}}),x.startDraw({type:"polygon",style:t.style||{color:"#00fff2",outline:!0,outlineColor:"#fafa5a",outlineWidth:1,opacity:.4,clampToGround:!0}})},showAddPointLength:function(t){},showRemoveLastPointLength:function(t){},showMoveDrawing:function(t){},showDrawEnd:function(t){if(null!=t.polygon){var e=t.polygon.hierarchy.getValue(),i=this.computeCutVolume(e),n=i.maxHeight,r=i.totalCutVolume,o=r.toFixed(2)+"立方米",s=(0,f.centerOfMass)(e),l=a.default.Cartesian3.fromRadians(s.longitude,s.latitude,n+10);this.totalLable.position=l,this.totalLable.label.text="挖方体积:"+o,this.totalLable.label.show=!0,this.totalLable.attribute.value=r,this.totalLable.attribute.textEx="挖方体积:",this.options.calback&&this.options.calback(areastr,r),P.entities.remove(t),t=P.entities.add({polygon:{hierarchy:{positions:e},extrudedHeight:n,closeTop:!1,closeBottom:!1,material:new a.default.Color.fromCssColorString("#00fff2").withAlpha(.5),outline:!0,outlineColor:new a.default.Color.fromCssColorString("#fafa5a").withAlpha(.4),outlineWidth:1}}),t._totalLable=this.totalLable,this.totalLable=null}},computeCutVolume:function(t){for(var e=15e3,i=0;i<t.length;i++){var n=a.default.Cartographic.fromCartesian(t[i]),r=_.scene.globe.getHeight(n);e>r&&(e=r)}var o=Math.PI/Math.pow(2,11);o/=64;for(var s,l,u,c,d,h,f,p,g,m,n,y,v=new a.default.PolygonGeometry.fromPositions({positions:t,vertexFormat:a.default.PerInstanceColorAppearance.FLAT_VERTEX_FORMAT,granularity:o}),w=new a.default.PolygonGeometry.createGeometry(v),b=0,C=0,i=0;i<w.indices.length;i+=3){s=w.indices[i],l=w.indices[i+1],u=w.indices[i+2],m=new a.default.Cartesian3(w.attributes.position.values[3*s],w.attributes.position.values[3*s+1],w.attributes.position.values[3*s+2]),n=a.default.Cartographic.fromCartesian(m),c=_.scene.globe.getHeight(n),f=a.default.Cartesian3.fromRadians(n.longitude,n.latitude,0),C<c&&(C=c),m=new a.default.Cartesian3(w.attributes.position.values[3*l],w.attributes.position.values[3*l+1],w.attributes.position.values[3*l+2]),n=a.default.Cartographic.fromCartesian(m),d=_.scene.globe.getHeight(n);var p=a.default.Cartesian3.fromRadians(n.longitude,n.latitude,0);C<d&&(C=d),m=new a.default.Cartesian3(w.attributes.position.values[3*u],w.attributes.position.values[3*u+1],w.attributes.position.values[3*u+2]),n=a.default.Cartographic.fromCartesian(m),h=_.scene.globe.getHeight(n),g=a.default.Cartesian3.fromRadians(n.longitude,n.latitude,0),C<h&&(C=h),y=this.computeAreaOfTriangle(f,p,g),b+=y*(c-e+d-e+h-e)/3}return{maxHeight:C,totalCutVolume:b}},computeAreaOfTriangle:function(t,e,i){var n=a.default.Cartesian3.distance(t,e),r=a.default.Cartesian3.distance(e,i),o=a.default.Cartesian3.distance(i,t),s=(n+r+o)/2;return Math.sqrt(s*(s-n)*(s-r)*(s-o))}},S={options:null,totalLable:null,clearLastNoEnd:function(){null!=this.totalLable&&P.entities.remove(this.totalLable),this.totalLable=null},start:function(t){this.options=t;var e=(0,u.style2Entity)(w,{horizontalOrigin:a.default.HorizontalOrigin.RIGHT,verticalOrigin:a.default.VerticalOrigin.BOTTOM,show:!1});this.totalLable=P.entities.add({label:e,isMarsMeasureLabel:!0,attribute:{unit:this.options.unit,type:this.options.type}}),x.startDraw({type:"polyline",config:{maxPointNum:2},style:t.style||{lineType:"glow",color:"#ebe12c",width:9,glowPower:.1}})},showAddPointLength:function(t){},showRemoveLastPointLength:function(t){this.totalLable&&(this.totalLable.label.show=!1)},showMoveDrawing:function(t){var e=x.getPositions(t);if(e.length<2)return void(this.totalLable.label.show=!1);var i=a.default.Cartographic.fromCartesian(e[0]),n=a.default.Cartographic.fromCartesian(e[1]),r=Math.abs(n.height-i.height),o=v(r,this.options.unit);this.totalLable.position=a.default.Cartesian3.midpoint(e[0],e[1],new a.default.Cartesian3),this.totalLable.label.text="高度差:"+o,this.totalLable.label.show=!0,this.totalLable.attribute.value=r,this.totalLable.attribute.textEx="高度差:",this.options.calback&&this.options.calback(o,r)},showDrawEnd:function(t){t._totalLable=this.totalLable,this.totalLable=null}},O={options:null,totalLable:null,xLable:null,hLable:null,clearLastNoEnd:function(){null!=this.totalLable&&P.entities.remove(this.totalLable),null!=this.xLable&&P.entities.remove(this.xLable),null!=this.hLable&&P.entities.remove(this.hLable),this.totalLable=null,this.xLable=null,this.hLable=null},start:function(t){this.options=t;var e=(0,u.style2Entity)(w,{horizontalOrigin:a.default.HorizontalOrigin.RIGHT,verticalOrigin:a.default.VerticalOrigin.CENTER,show:!1});this.totalLable=P.entities.add({label:e,isMarsMeasureLabel:!0,attribute:{unit:this.options.unit,type:this.options.type}});var i=(0,u.style2Entity)(w,{horizontalOrigin:a.default.HorizontalOrigin.CENTER,verticalOrigin:a.default.VerticalOrigin.BOTTOM,show:!1});i.pixelOffset=new a.default.Cartesian2(0,0),this.xLable=P.entities.add({label:i,isMarsMeasureLabel:!0,attribute:{unit:this.options.unit,type:this.options.type}}),this.hLable=P.entities.add({label:i,isMarsMeasureLabel:!0,attribute:{unit:this.options.unit,type:this.options.type}}),x.startDraw({type:"polyline",config:{maxPointNum:2},style:t.style||{lineType:"glow",color:"#ebe12c",width:9,glowPower:.1}})},showAddPointLength:function(t){var e=x.getPositions(t);if(4==e.length){var i=e[3].clone();e.pop(),e.pop(),e.pop(),e.push(i)}if(2==e.length){var n=this.getZHeightPosition(e[0],e[1]);this.getHDistance(e[0],e[1])>3&&(e.push(n),e.push(e[0]))}this.showSuperHeight(e)},showRemoveLastPointLength:function(t){var e=x.getPositions(t.entity);2==e.length&&(e.pop(),e.pop(),this.totalLable.label.show=!1,this.hLable.label.show=!1,this.xLable.label.show=!1)},showMoveDrawing:function(t){var e=x.getPositions(t);if(4==e.length){var i=e[3].clone();e.pop(),e.pop(),e.pop(),e.push(i)}if(2==e.length){var n=this.getZHeightPosition(e[0],e[1]);this.getHDistance(e[0],e[1])>3&&(e.push(n),e.push(e[0]))}this.showSuperHeight(e)},showDrawEnd:function(t){t._arrLables=[this.totalLable,this.hLable,this.xLable],this.totalLable=null,this.hLable=null,this.xLable=null},showSuperHeight:function(t){var e,i,n,r;if(4==t.length){var o,s,l=a.default.Cartesian3.midpoint(t[0],t[1],new a.default.Cartesian3),u=a.default.Cartographic.fromCartesian(t[0]),c=a.default.Cartographic.fromCartesian(t[1]),d=a.default.Cartographic.fromCartesian(t[2]),h=c.height-d.height;r=c.height-u.height,n=a.default.Cartesian3.distance(t[0],t[1]),r>-1&&r<1?(s=t[1],this.updateSuperHeightLabel(this.totalLable,s,"高度差:",r),this.updateSuperHeightLabel(this.hLable,l,"",n)):(h>-.1&&h<.1?(o=a.default.Cartesian3.midpoint(t[2],t[1],new a.default.Cartesian3),s=a.default.Cartesian3.midpoint(t[2],t[3],new a.default.Cartesian3),i=a.default.Cartesian3.distance(t[1],t[2]),e=a.default.Cartesian3.distance(t[3],t[2])):(s=a.default.Cartesian3.midpoint(t[2],t[1],new a.default.Cartesian3),o=a.default.Cartesian3.midpoint(t[2],t[3],new a.default.Cartesian3),i=a.default.Cartesian3.distance(t[3],t[2]),e=a.default.Cartesian3.distance(t[1],t[2])),this.updateSuperHeightLabel(this.totalLable,s,"高度差:",e),this.updateSuperHeightLabel(this.xLable,o,"",i),this.updateSuperHeightLabel(this.hLable,l,"",n))}else if(2==t.length){e=a.default.Cartesian3.distance(t[1],t[0]);var s=a.default.Cartesian3.midpoint(t[0],t[1],new a.default.Cartesian3);xLable.label.show&&(xLable.label.show=!1,hLable.label.show=!1),this.updateSuperHeightLabel(this.totalLable,s,"高度差:",e)}var f=v(e,this.options.unit);this.options.calback&&this.options.calback(f,e)},updateSuperHeightLabel:function(t,e,i,n){null!=t&&(t.position=e,t.label.text=i+v(n,this.options.unit),t.label.show=!0,t.attribute.value=n,t.attribute.textEx=i)},getZHeightPosition:function(t,e){var i=a.default.Cartographic.fromCartesian(t),n=Number(a.default.Math.toDegrees(i.longitude)),r=Number(a.default.Math.toDegrees(i.latitude)),o=Number(i.height.toFixed(2)),s=a.default.Cartographic.fromCartesian(e),l=Number(a.default.Math.toDegrees(s.longitude)),u=Number(a.default.Math.toDegrees(s.latitude)),c=Number(s.height.toFixed(2));return o>c?a.default.Cartesian3.fromDegrees(l,u,o):a.default.Cartesian3.fromDegrees(n,r,c)},getHDistance:function(t,e){var i=this.getZHeightPosition(t,e),n=a.default.Cartographic.fromCartesian(e),r=a.default.Cartographic.fromCartesian(i),o=a.default.Cartesian3.distance(t,i);return Math.abs(Number(r.height)-Number(n.height))<.01&&(o=a.default.Cartesian3.distance(e,i)),o}},T={options:null,totalLable:null,exLine:null,clearLastNoEnd:function(){null!=this.totalLable&&P.entities.remove(this.totalLable),this.totalLable=null,null!=this.exLine&&P.entities.remove(this.exLine),this.exLine=null},start:function(t){this.options=t;var e=(0,u.style2Entity)(w,{horizontalOrigin:a.default.HorizontalOrigin.LEFT,verticalOrigin:a.default.VerticalOrigin.BOTTOM,show:!1});this.totalLable=P.entities.add({label:e,isMarsMeasureLabel:!0,attribute:{unit:this.options.unit,type:this.options.type}}),x.startDraw({type:"polyline",config:{maxPointNum:2},style:t.style||{lineType:"arrow",color:"#ebe967",width:9,clampToGround:!0}})},showAddPointLength:function(t){},showRemoveLastPointLength:function(t){this.exLine&&(this.exLine.polyline.show=!1),this.totalLable&&(this.totalLable.label.show=!1)},showMoveDrawing:function(t){var e=x.getPositions(t);if(e.length<2)return void(this.totalLable.label.show=!1);var i=a.default.Cartesian3.distance(e[0],e[1]),n=(0,f.formatPositon)(e[0]),r=(0,f.formatPositon)(e[1]),o=turf.point([n.x,n.y,n.z]),s=turf.point([r.x,r.y,r.z]),l=Math.round(turf.rhumbBearing(o,s)),u=turf.destination(o,i/3e3,0,{units:"kilometers"});u={x:u.geometry.coordinates[0],y:u.geometry.coordinates[1],z:n.z};var c=a.default.Cartesian3.fromDegrees(u.x,u.y,u.z);this.updateExLine([e[0],c]),this.totalLable.position=e[1],this.totalLable.label.text="角度:"+l+"°\n距离:"+v(i),this.totalLable.label.show=!0,this.totalLable.attribute.value=l,this.totalLable.attribute.textEx="角度:",this.options.calback&&this.options.calback(l+"°",l)},updateExLine:function(t){this.exLine?(this.exLine.polyline.show=!0,this.exLine.polyline.positions.setValue(t)):this.exLine=P.entities.add({polyline:{positions:t,width:3,clampToGround:!0,material:new a.default.PolylineDashMaterialProperty({color:a.default.Color.RED})}})},showDrawEnd:function(t){t._totalLable=this.totalLable,this.totalLable=null,this.exLine=null}};return{measuerLength:e,measureHeight:s,measureArea:n,measureAngle:c,measureVolume:r,measureSection:i,updateUnit:m,clearMeasure:g,formatArea:y,formatLength:v}};e.Measure=p},function(t,e,i){"use strict";function n(t,e){this._GLMap=t,this.dimensions=["lng","lat"],this._mapOffset=[0,0],this._api=e}function r(t,e){this._mapContainer=t,this._overlay=this._createChartOverlay(),this._overlay.setOption(e)}Object.defineProperty(e,"__esModule",{value:!0}),e.FlowEcharts=void 0;var a=i(0),o=function(t){return t&&t.__esModule?t:{default:t}}(a);n.prototype.dimensions=["lng","lat"],n.prototype.setMapOffset=function(t){this._mapOffset=t},n.prototype.getBMap=function(){return this._GLMap};var s=o.default.Math.toRadians(80);n.prototype.dataToPoint=function(t){var e=[99999,99999],i=o.default.Cartesian3.fromDegrees(t[0],t[1]);if(!i)return e;var n=this._GLMap.cartesianToCanvasCoordinates(i);if(!n)return e;var r=this._GLMap;if(r.mode===o.default.SceneMode.SCENE3D){if(o.default.Cartesian3.angleBetween(r.camera.position,i)>s)return!1}return[n.x-this._mapOffset[0],n.y-this._mapOffset[1]]},n.prototype.pointToData=function(t){var e=this._mapOffset,t=this._bmap.project([t[0]+e[0],t[1]+e[1]]);return[t.lng,t.lat]},n.prototype.getViewRect=function(){var t=this._api;return new echarts.graphic.BoundingRect(0,0,t.getWidth(),t.getHeight())},n.prototype.getRoamTransform=function(){return echarts.matrix.create()},n.dimensions=n.prototype.dimensions,n.create=function(t,e){var i;t.eachComponent("GLMap",function(t){var r=e.getZr().painter;if(r){var a=(r.getViewportRoot(),echarts.glMap);i=new n(a,e),i.setMapOffset(t.__mapOffset||[0,0]),t.coordinateSystem=i}}),t.eachSeries(function(t){"GLMap"===t.get("coordinateSystem")&&(t.coordinateSystem=i)})},window.echarts&&(echarts.registerCoordinateSystem("GLMap",n),echarts.registerAction({type:"GLMapRoam",event:"GLMapRoam",update:"updateLayout"},function(t,e){}),echarts.extendComponentModel({type:"GLMap",getBMap:function(){return this.__GLMap},defaultOption:{roam:!1}}),echarts.extendComponentView({type:"GLMap",init:function(t,e){this.api=e,echarts.glMap.postRender.addEventListener(this.moveHandler,this)},moveHandler:function(t,e){this.api.dispatchAction({type:"GLMapRoam"})},render:function(t,e,i){},dispose:function(t){echarts.glMap.postRender.removeEventListener(this.moveHandler,this)}})),r.prototype._createChartOverlay=function(){var t=this._mapContainer.scene;t.canvas.setAttribute("tabIndex",0);var e=document.createElement("div");return e.style.position="absolute",e.style.top="0px",e.style.left="0px",e.style.width=t.canvas.width+"px",e.style.height=t.canvas.height+"px",e.style.pointerEvents="none",e.setAttribute("id","echarts"),e.setAttribute("class","echartMap"),this._mapContainer.container.appendChild(e),this._echartsContainer=e,echarts.glMap=t,echarts.init(e)},r.prototype.dispose=function(){this._echartsContainer&&(this._mapContainer.container.removeChild(this._echartsContainer),this._echartsContainer=null),this._overlay&&(this._overlay.dispose(),this._overlay=null)},r.prototype.updateOverlay=function(t){this._overlay&&this._overlay.setOption(t)},r.prototype.getMap=function(){return this._mapContainer},r.prototype.getOverlay=function(){return this._overlay},r.prototype.show=function(){document.getElementById(this._id).style.visibility="visible"},r.prototype.hide=function(){document.getElementById(this._id).style.visibility="hidden"},e.FlowEcharts=r},function(t,e,i){"use strict";function n(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(e,"__esModule",{value:!0}),e.MapVLayer=void 0;var r=function(){function t(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,i,n){return i&&t(e.prototype,i),n&&t(e,n),e}}(),a=i(0),o=function(t){return t&&t.__esModule?t:{default:t}}(a),s=i(86),l=0,u=function(){function t(e,i,r,a){n(this,t),this.map=e,this.scene=e.scene,this.mapvBaseLayer=new s.MapVRenderer(e,i,r,this),this.mapVOptions=r,this.initDevicePixelRatio(),this.canvas=this._createCanvas(),this.render=this.render.bind(this),void 0!=a?(this.container=a,a.appendChild(this.canvas)):(this.container=e.container,this.addInnerContainer()),this.bindEvent(),this._reset()}return r(t,[{key:"initDevicePixelRatio",value:function(){this.devicePixelRatio=window.devicePixelRatio||1}},{key:"addInnerContainer",value:function(){this.container.appendChild(this.canvas)}},{key:"bindEvent",value:function(){var t=this;this.innerMoveStart=this.moveStartEvent.bind(this),this.innerMoveEnd=this.moveEndEvent.bind(this),this.scene.camera.moveStart.addEventListener(this.innerMoveStart,this),this.scene.camera.moveEnd.addEventListener(this.innerMoveEnd,this);var e=new o.default.ScreenSpaceEventHandler(this.canvas);e.setInputAction(function(e){t.innerMoveEnd()},o.default.ScreenSpaceEventType.LEFT_UP),e.setInputAction(function(e){t.innerMoveEnd()},o.default.ScreenSpaceEventType.MIDDLE_UP),this.handler=e}},{key:"unbindEvent",value:function(){this.scene.camera.moveStart.removeEventListener(this.innerMoveStart,this),this.scene.camera.moveEnd.removeEventListener(this.innerMoveEnd,this),this.scene.postRender.removeEventListener(this._reset,this),this.handler&&(this.handler.destroy(),this.handler=null)}},{key:"moveStartEvent",value:function(){this.mapvBaseLayer&&this.mapvBaseLayer.animatorMovestartEvent(),this.scene.postRender.addEventListener(this._reset,this),console.log("mapv moveStartEvent")}},{key:"moveEndEvent",value:function(){this.scene.postRender.removeEventListener(this._reset,this),this.mapvBaseLayer&&this.mapvBaseLayer.animatorMoveendEvent(),this._reset(),console.log("mapv moveEndEvent")}},{key:"zoomStartEvent",value:function(){this._unvisiable()}},{key:"zoomEndEvent",value:function(){this._unvisiable()}},{key:"addData",value:function(t,e){void 0!=this.mapvBaseLayer&&this.mapvBaseLayer.addData(t,e)}},{key:"updateData",value:function(t,e){void 0!=this.mapvBaseLayer&&this.mapvBaseLayer.updateData(t,e)}},{key:"getData",value:function(){return this.mapvBaseLayer&&(this.dataSet=this.mapvBaseLayer.getData()),this.dataSet}},{key:"removeData",value:function(t){void 0!=this.mapvBaseLayer&&this.mapvBaseLayer&&this.mapvBaseLayer.removeData(t)}},{key:"removeAllData",value:function(){void 0!=this.mapvBaseLayer&&this.mapvBaseLayer.clearData()}},{key:"_visiable",value:function(){return this.canvas.style.display="block"}},{key:"_unvisiable",value:function(){return this.canvas.style.display="none"}},{key:"_createCanvas",value:function(){var t=document.createElement("canvas");t.id=this.mapVOptions.layerid||"mapv"+l++,t.style.position="absolute",t.style.top="0px",t.style.left="0px",t.style.pointerEvents="none",t.style.zIndex=this.mapVOptions.zIndex||100,t.width=parseInt(this.map.canvas.width),t.height=parseInt(this.map.canvas.height),t.style.width=this.map.canvas.style.width,t.style.height=this.map.canvas.style.height;var e=this.devicePixelRatio;return"2d"==this.mapVOptions.context&&t.getContext(this.mapVOptions.context).scale(e,e),t}},{key:"_reset",value:function(){this.resizeCanvas(),this.fixPosition(),this.onResize(),this.render()}},{key:"draw",value:function(){this._reset()}},{key:"show",value:function(){this._visiable()}},{key:"hide",value:function(){this._unvisiable()}},{key:"destroy",value:function(){this.unbindEvent(),this.remove()}},{key:"remove",value:function(){void 0!=this.mapvBaseLayer&&(this.removeAllData(),this.mapvBaseLayer.destroy(),this.mapvBaseLayer=void 0,this.canvas.parentElement.removeChild(this.canvas))}},{key:"update",value:function(t){void 0!=t&&this.updateData(t.data,t.options)}},{key:"resizeCanvas",value:function(){if(void 0!=this.canvas&&null!=this.canvas){var t=this.canvas;t.style.position="absolute",t.style.top="0px",t.style.left="0px",t.width=parseInt(this.map.canvas.width),t.height=parseInt(this.map.canvas.height),t.style.width=this.map.canvas.style.width,t.style.height=this.map.canvas.style.height}}},{key:"fixPosition",value:function(){}},{key:"onResize",value:function(){}},{key:"render",value:function(){void 0!=this.mapvBaseLayer&&this.mapvBaseLayer._canvasUpdate()}}]),t}();e.MapVLayer=u},function(t,e,i){"use strict";function n(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function r(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function a(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}Object.defineProperty(e,"__esModule",{value:!0}),e.MapVRenderer=void 0;var o=function(){function t(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,i,n){return i&&t(e.prototype,i),n&&t(e,n),e}}(),s=function t(e,i,n){null===e&&(e=Function.prototype);var r=Object.getOwnPropertyDescriptor(e,i);if(void 0===r){var a=Object.getPrototypeOf(e);return null===a?void 0:t(a,i,n)}if("value"in r)return r.value;var o=r.get;if(void 0!==o)return o.call(n)},l=i(0),u=function(t){return t&&t.__esModule?t:{default:t}}(l),c=i(87),d=c?c.baiduMapLayer:null,h=d?d.__proto__:Function,f=u.default.Math.toRadians(80);e.MapVRenderer=function(t){function e(t,i,a,o){n(this,e);var s=r(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t,i,a));return h?(s.map=t,s.scene=t.scene,s.dataSet=i,a=a||{},s.init(a),s.argCheck(a),s.initDevicePixelRatio(),s.canvasLayer=o,s.stopAniamation=!1,s.animation=a.animation,s.clickEvent=s.clickEvent.bind(s),s.mousemoveEvent=s.mousemoveEvent.bind(s),s.bindEvent(),s):r(s)}return a(e,t),o(e,[{key:"initDevicePixelRatio",value:function(){this.devicePixelRatio=window.devicePixelRatio||1}},{key:"clickEvent",value:function(t){var i=t.point;s(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"clickEvent",this).call(this,i,t)}},{key:"mousemoveEvent",value:function(t){var i=t.point;s(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"mousemoveEvent",this).call(this,i,t)}},{key:"addAnimatorEvent",value:function(){}},{key:"animatorMovestartEvent",value:function(){var t=this.options.animation;this.isEnabledTime()&&this.animator&&(this.steps.step=t.stepsRange.start)}},{key:"animatorMoveendEvent",value:function(){this.isEnabledTime()&&this.animator}},{key:"bindEvent",value:function(){this.map,this.options.methods&&(this.options.methods.click,this.options.methods.mousemove)}},{key:"unbindEvent",value:function(){var t=this.map;this.options.methods&&(this.options.methods.click&&t.off("click",this.clickEvent),this.options.methods.mousemove&&t.off("mousemove",this.mousemoveEvent))}},{key:"getContext",value:function(){return this.canvasLayer.canvas.getContext(this.context)}},{key:"init",value:function(t){this.options=t,this.initDataRange(t),this.context=this.options.context||"2d",this.options.zIndex&&this.canvasLayer&&this.canvasLayer.setZIndex&&this.canvasLayer.setZIndex(this.options.zIndex),this.initAnimator()}},{key:"_canvasUpdate",value:function(t){this.map;var e=this.scene;if(this.canvasLayer&&!this.stopAniamation){var i=this.options.animation,n=this.getContext();if(this.isEnabledTime()){if(void 0===t)return void this.clear(n);"2d"===this.context&&(n.save(),n.globalCompositeOperation="destination-out",n.fillStyle="rgba(0, 0, 0, .1)",n.fillRect(0,0,n.canvas.width,n.canvas.height),n.restore())}else this.clear(n);if("2d"===this.context)for(var r in this.options)n[r]=this.options[r];else n.clear(n.COLOR_BUFFER_BIT);var a={transferCoordinate:function(t){var i=[99999,99999],n=u.default.Cartesian3.fromDegrees(t[0],t[1]);if(!n)return i;var r=e.cartesianToCanvasCoordinates(n);if(!r)return i;if(e.mode===u.default.SceneMode.SCENE3D){if(u.default.Cartesian3.angleBetween(e.camera.position,n)>f)return!1}return[r.x,r.y]}};void 0!==t&&(a.filter=function(e){var n=i.trails||10;return!!(t&&e.time>t-n&&e.time<t)});var o=this.dataSet.get(a);this.processData(o),"m"==this.options.unit&&this.options.size,this.options._size=this.options.size;var s=u.default.SceneTransforms.wgs84ToWindowCoordinates(e,u.default.Cartesian3.fromDegrees(0,0));this.drawContext(n,new c.DataSet(o),this.options,s),this.options.updateCallback&&this.options.updateCallback(t)}}},{key:"updateData",value:function(t,i){var n=t;n&&n.get&&(n=n.get()),void 0!=n&&this.dataSet.set(n),s(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"update",this).call(this,{options:i})}},{key:"addData",value:function(t,e){var i=t;t&&t.get&&(i=t.get()),this.dataSet.add(i),this.update({options:e})}},{key:"getData",value:function(){return this.dataSet}},{key:"removeData",value:function(t){if(this.dataSet){var e=this.dataSet.get({filter:function(e){return null==t||"function"!=typeof t||!t(e)}});this.dataSet.set(e),this.update({options:null})}}},{key:"clearData",value:function(){this.dataSet&&this.dataSet.clear(),this.update({options:null})}},{key:"draw",value:function(){this.canvasLayer.draw()}},{key:"clear",value:function(t){t&&t.clearRect&&t.clearRect(0,0,t.canvas.width,t.canvas.height)}},{key:"destroy",value:function(){this.unbindEvent(),this.clear(this.getContext()),this.clearData(),this.animator&&this.animator.stop(),this.animator=null,this.canvasLayer=null}}]),e}(h)},function(t,e){t.exports=__WEBPACK_EXTERNAL_MODULE_87__},function(t,e,i){"use strict";function n(t){t=s(t,s.EMPTY_OBJECT),this._definitionChanged=new c,this._color=void 0,this._colorSubscription=void 0,this.color=t.color||p,this._duration=t.duration||1e3;var e=n.getImageMaterial(t.url,t.repeat);this._materialType=e.type,this._materialImage=e.image,this._time=void 0}Object.defineProperty(e,"__esModule",{value:!0}),e.AnimationLineMaterialProperty=void 0;var r=i(0),a=function(t){return t&&t.__esModule?t:{default:t}}(r),o=a.default.Color,s=a.default.defaultValue,l=a.default.defined,u=a.default.defineProperties,c=a.default.Event,d=a.default.createPropertyDescriptor,h=a.default.Property,f=a.default.Material,p=new a.default.Color(0,0,0,0);u(n.prototype,{isConstant:{get:function(){return!1}},definitionChanged:{get:function(){return this._definitionChanged}},color:d("color")}),n.prototype.getType=function(t){return this._materialType},n.prototype.getValue=function(t,e){return l(e)||(e={}),e.color=h.getValueOrClonedDefault(this._color,t,p,e.color),e.image=this._materialImage,void 0===this._time&&(this._time=t.secondsOfDay),e.time=1e3*(t.secondsOfDay-this._time)/this._duration,e},n.prototype.equals=function(t){return this===t||t instanceof n&&h.equals(this._color,t._color)};var g=0;n.getImageMaterial=function(t,e){g++;var i="AnimationLine"+g+"Type",n="AnimationLine"+g+"Image";return f[i]=i,f[n]=t,f._materialCache.addMaterial(f[i],{fabric:{type:f.PolylineArrowLinkType,uniforms:{color:new o(1,0,0,1),image:f[n],time:0,repeat:e||new a.default.Cartesian2(1,1)},source:"czm_material czm_getMaterial(czm_materialInput materialInput)\n                        {\n                            czm_material material = czm_getDefaultMaterial(materialInput);\n                            vec2 st = repeat * materialInput.st;\n                            vec4 colorImage = texture2D(image, vec2(fract(st.s - time), st.t));\n                            if(color.a == 0.0)\n                            {\n                                material.alpha = colorImage.a;\n                                material.diffuse = colorImage.rgb; \n                            }\n                            else\n                            {\n                                material.alpha = colorImage.a * color.a;\n                                material.diffuse = max(color.rgb * material.alpha * 3.0, color.rgb); \n                            }\n                            return material;\n                        }"},translucent:function(){return!0}}),{type:f[i],image:f[n]}},e.AnimationLineMaterialProperty=n},function(t,e,i){"use strict";function n(t){t=s(t,s.EMPTY_OBJECT),this._definitionChanged=new c,this._color=void 0,this._colorSubscription=void 0,this.color=t.color,this._time=void 0}Object.defineProperty(e,"__esModule",{value:!0}),e.ElliposidFadeMaterialProperty=void 0;var r=i(0),a=function(t){return t&&t.__esModule?t:{default:t}}(r),o=a.default.Color,s=a.default.defaultValue,l=a.default.defined,u=a.default.defineProperties,c=a.default.Event,d=a.default.createPropertyDescriptor,h=a.default.Property,f=a.default.Material,p=o.WHITE;u(n.prototype,{isConstant:{get:function(){return!1}},definitionChanged:{get:function(){return this._definitionChanged}},color:d("color")}),n.prototype.getType=function(t){return f.EllipsoidFadeType},n.prototype.getValue=function(t,e){return l(e)||(e={}),e.color=h.getValueOrClonedDefault(this._color,t,p,e.color),void 0===this._time&&(this._time=t.secondsOfDay),e.time=t.secondsOfDay-this._time,e},n.prototype.equals=function(t){return this===t||t instanceof n&&h.equals(this._color,t._color)};var f=a.default.Material;f.EllipsoidFadeType="EllipsoidFade",f._materialCache.addMaterial(f.EllipsoidFadeType,{fabric:{type:f.EllipsoidFadeType,uniforms:{color:new o(1,0,0,1),time:1},source:"czm_material czm_getMaterial(czm_materialInput materialInput)\n                {\n                    czm_material material = czm_getDefaultMaterial(materialInput);\n                    material.diffuse = 1.5 * color.rgb;\n                    vec2 st = materialInput.st;\n                    float dis = distance(st, vec2(0.5, 0.5));\n                    float per = fract(time);\n                    if(dis > per * 0.5){\n                        //material.alpha = 0.0;\n                        discard;\n                    }else {\n                            material.alpha = color.a  * dis / per / 2.0;\n                    }\n                    return material;\n                }"},translucent:function(){return!0}}),e.ElliposidFadeMaterialProperty=n},function(t,e,i){"use strict";function n(t){return t&&t.__esModule?t:{default:t}}Object.defineProperty(e,"__esModule",{value:!0}),e.DivPoint=void 0;var r=i(0),a=n(r),o=i(5),s=n(o),l=i(10);e.DivPoint=l.Class.extend({position:null,anchor:null,initialize:function(t,e){this.viewer=t,this.position=e.position,this.anchor=e.anchor,this.$view=(0,s.default)(e.html),this.$view.css({position:"absolute",left:"0",top:"0"}),this.$view.appendTo("#"+t._container.id);var i=this;(e.click||e.popup)&&this.$view.click(function(n){e.popup&&t.mars.popup.show(e,i.position),e.click&&e.click(e,i,n)}),e.tooltip&&this.$view.hover(function(){t.mars.tooltip.show(e,i.position)},function(){t.mars.tooltip.close()}),this.$view.on("mousewheel",function(t){}),t.scene.postRender.addEventListener(this.updateViewPoint,this)},backAngle:a.default.Math.toRadians(75),updateViewPoint:function(){if(this._visible){var t=this.viewer.scene,e=a.default.SceneTransforms.wgs84ToWindowCoordinates(t,this.position);if(null!=e){if(t.mode===a.default.SceneMode.SCENE3D){var i,t=viewer.scene;if(t.mode===a.default.SceneMode.SCENE3D){var n=t.camera.getPickRay(e);i=t.globe.pick(n,t)}else i=t.camera.pickEllipsoid(e,t.globe.ellipsoid);if(i){if(a.default.Cartesian3.distance(this.position,i)>1e6)return!1}}var r=e.x,o=e.y-this.$view.height();this.anchor?(r+=this.anchor[0],o+=this.anchor[1]):r-=this.$view.width()/2,this.$view.css("transform","translate3d("+r+"px,"+o+"px, 0)")}}},_visible:!0,setVisible:function(t){this._visible=t,t?this.$view.show():this.$view.hide()},destroy:function(){this.viewer.scene.postRender.removeEventListener(this.updateViewPoint,this),this.$view.remove(),this.$view=null,this.position=null,this.anchor=null,this.viewer=null}})},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.TilesEditor=void 0;var n=i(10);e.TilesEditor=n.Class.extend({viewer:null,options:null,initialize:function(t,e){this.viewer=t,this.scene=this.viewer.scene,this.options=e,this.position=e.position,this.heading=e.heading||0,this.range=e.range||100,this.dragging=!1,this.rotating=!1,this.enable=!1,this.billboards=this.viewer.scene.primitives.add(new Cesium.BillboardCollection),this.handler=new Cesium.ScreenSpaceEventHandler(this.viewer.canvas),this.movep=this.billboards.add({position:this.position,color:new Cesium.Color.fromCssColorString("#FFFF00"),image:e.moveImg,show:!1,disableDepthTestDistance:Number.POSITIVE_INFINITY}),this.rotatep=this.billboards.add({position:this.position?this.rotationPos():null,color:new Cesium.Color.fromCssColorString("#FFFF00"),image:e.rotateImg,show:!1,disableDepthTestDistance:Number.POSITIVE_INFINITY})},update:function(t){for(var e in t)this[e]=t[e];this.movep.position=this.position,this.rotatep.position=this.rotationPos()},modelMatrix:function(){var t=Cesium.Transforms.eastNorthUpToFixedFrame(this.position),e=Cesium.Matrix4.fromRotationTranslation(Cesium.Matrix3.fromRotationZ(this.heading));if(Cesium.Matrix4.multiply(t,e,t),this.scale>0&&1!=this.scale&&Cesium.Matrix4.multiplyByUniformScale(t,this.scale,t),this.axis&&""!=this.axis){var i;switch(this.axis.toUpperCase()){case"Y_UP_TO_Z_UP":i=Cesium.Axis.Y_UP_TO_Z_UP;break;case"Z_UP_TO_Y_UP":i=Cesium.Axis.Z_UP_TO_Y_UP;break;case"X_UP_TO_Z_UP":i=Cesium.Axis.X_UP_TO_Z_UP;break;case"Z_UP_TO_X_UP":i=Cesium.Axis.Z_UP_TO_X_UP;break;case"X_UP_TO_Y_UP":i=Cesium.Axis.X_UP_TO_Y_UP;break;case"Y_UP_TO_X_UP":i=Cesium.Axis.Y_UP_TO_X_UP}i&&(t=Cesium.Matrix4.multiplyTransformation(t,i,t))}return t},rotationPos:function(){var t=new Cesium.Cartesian3(this.range,0,0),e=Cesium.Matrix4.getRotation(this.modelMatrix(),new Cesium.Matrix3);return t=Cesium.Matrix3.multiplyByVector(e,t,t),t=Cesium.Cartesian3.add(this.position,t,t)},pickTerrain:function(t){var e=this.viewer.camera.getPickRay(t);return this.viewer.scene.globe.pick(e,this.viewer.scene)},setEnable:function(t){if(t){var e=this;this.handler.setInputAction(function(t){e.handler_onLeafDown(t)},Cesium.ScreenSpaceEventType.LEFT_DOWN),this.handler.setInputAction(function(t){e.handler_onMouseMove(t)},Cesium.ScreenSpaceEventType.MOUSE_MOVE),this.handler.setInputAction(function(t){e.handler_onLeftUp(t)},Cesium.ScreenSpaceEventType.LEFT_UP),this.rotatep.show=!0,this.movep.show=!0}else this.handler.removeInputAction(Cesium.ScreenSpaceEventType.LEFT_DOWN),this.handler.removeInputAction(Cesium.ScreenSpaceEventType.MOUSE_MOVE),this.handler.removeInputAction(Cesium.ScreenSpaceEventType.LEFT_UP),this.rotatep.show=!1,this.movep.show=!1;this._enable=!1},handler_onLeafDown:function(t){for(var e=this.scene.drillPick(t.position,2),i=0;i<e.length;i++){var n=e[i];if(Cesium.defined(n)&&n.primitive===this.movep){this.dragging=!0,this.scene.screenSpaceCameraController.enableRotate=!1;break}if(Cesium.defined(n)&&n.primitive===this.rotatep){this.rotating=!0,this.scene.screenSpaceCameraController.enableRotate=!1;break}}},handler_onMouseMove:function(t){var e=this.pickTerrain(t.endPosition);if(e)if(this.dragging)this.position=e,this.movep.position=this.position,this.rotatep.position=this.rotationPos(),this.options.onPosition&&this.options.onPosition(this.position);else if(this.rotating){this.rotatep.position=e,this.range=Cesium.Cartesian3.distance(this.position,e);var i=Cesium.Transforms.eastNorthUpToFixedFrame(this.position);i=Cesium.Matrix4.getRotation(i,new Cesium.Matrix3);var n=Cesium.Matrix3.getColumn(i,0,new Cesium.Cartesian3),r=Cesium.Matrix3.getColumn(i,1,new Cesium.Cartesian3),a=Cesium.Matrix3.getColumn(i,2,new Cesium.Cartesian3),o=Cesium.Cartesian3.subtract(e,this.position,new Cesium.Cartesian3);o=Cesium.Cartesian3.cross(o,a,o),o=Cesium.Cartesian3.cross(a,o,o),o=Cesium.Cartesian3.normalize(o,o),this.heading=Cesium.Cartesian3.angleBetween(n,o);var s=Cesium.Cartesian3.angleBetween(r,o);s>.5*Math.PI&&(this.heading=2*Math.PI-this.heading),this.options.onHeading&&this.options.onHeading(this.heading)}},handler_onLeftUp:function(t){(this.dragging||this.rotating)&&(this.rotating=this.dragging=!1,this.scene.screenSpaceCameraController.enableRotate=!0,this.billboards._createVertexArray=!0)},remove:function(){this.billboards&&(this.scene.primitives.remove(this.billboards),this.billboards=void 0),this.enable=!1},destroy:function(){this.remove(),this.handler.destroy(),this.handler=null,this.viewer=null}})},function(t,e,i){"use strict";function n(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e.default=t,e}Object.defineProperty(e,"__esModule",{value:!0}),e.ellipsoid=e.rectangle=e.circle=e.polygon=e.wall=e.polylineVolume=e.polyline=e.model=e.point=e.label=e.billboard=void 0;var r=i(15),a=n(r),o=i(13),s=n(o),l=i(24),u=n(l),c=i(27),d=n(c),h=i(11),f=n(h),p=i(31),g=n(p),m=i(34),y=n(m),v=i(16),_=n(v),w=i(29),b=n(w),C=i(32),x=n(C),P=i(33),M=n(P);e.billboard=a,e.label=s,e.point=u,e.model=d,e.polyline=f,e.polylineVolume=g,e.wall=y,e.polygon=_,e.circle=b,e.rectangle=x,e.ellipsoid=M},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.BaseWidget=void 0;var n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},r=i(5),a=function(t){return t&&t.__esModule?t:{default:t}}(r),o=i(10),s=i(2),l=function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e.default=t,e}(s),u=i(36),c=i(35),d=[],h=o.Class.extend({viewer:null,options:{},config:{},path:"",isActivate:!1,isCreate:!1,initialize:function(t,e){this.viewer=e,this.config=t,this.path=t.path||"",this.init()},addCacheVersion:function(t){if(null==t)return t;var e=(0,c.getCacheVersion)();return e&&(-1==t.indexOf("?")?t+="?time="+e:-1==t.indexOf("time="+e)&&(t+="&time="+e)),t},activateBase:function(){var t=this;if(this.isActivate)return void this.changeWidgetView(function(t){t._dom&&((0,a.default)(".layui-layer").each(function(){(0,a.default)(this).css("z-index",19891e3)}),(0,a.default)(t._dom).css("z-index",19891014))});if(this.beforeActivate(),this.isActivate=!0,!this.isCreate){if(this.options.resources&&this.options.resources.length>0){for(var e=[],i=0;i<this.options.resources.length;i++){var n=this.options.resources[i];n=this._getUrl(n),-1==d.indexOf(n)&&e.push(n)}return d=d.concat(e),void u.Loader.async(e,function(){if(!t.create(function(){t._createWidgetView(),t.isCreate=!0})){if(t.config.createAtStart)return t.config.createAtStart=!1,t.isActivate=!1,void(t.isCreate=!0);t._createWidgetView(),t.isCreate=!0}})}if(this.create(function(){t._createWidgetView(),this.isCreate=!0}))return;if(t.config.createAtStart)return t.config.createAtStart=!1,t.isActivate=!1,void(t.isCreate=!0);this.isCreate=!0}return this._createWidgetView(),this},_createWidgetView:function(){var t=this.options.view;if(void 0===t||null===t)this._startActivate();else if(l.isArray(t)){this._viewcreate_allcount=t.length,this._viewcreate_okcount=0;for(var e=0;e<t.length;e++)this.createItemView(t[e])}else this._viewcreate_allcount=1,this._viewcreate_okcount=0,this.createItemView(t)},changeWidgetView:function(t){var e=this.options.view;if(void 0===e||null===e)return!1;if(l.isArray(e)){for(var i=!1,n=0;n<e.length;n++)i=i||t(e[n]);return i}return t(e)},createItemView:function(t){switch(t.type){default:case"window":this._openWindow(t);break;case"divwindow":this._openDivWindow(t);break;case"append":this._appendView(t);break;case"custom":var e=this._getUrl(t.url),i=this;t.open(e,function(e){i.winCreateOK(t,e),++i._viewcreate_okcount>=i._viewcreate_allcount&&i._startActivate(e)},this)}},_viewcreate_allcount:0,_viewcreate_okcount:0,_openWindow:function(t){var e=this,i=this._getUrl(t.url),n={type:2,content:[i,"no"],success:function(n){t._layerOpening=!1,t._dom=n;var r=window[n.find("iframe")[0].name];e.config.hasOwnProperty("visible")&&!e.config.visible&&(0,a.default)(n).hide(),layer.setTop(n),e.winCreateOK(t,r),e._viewcreate_okcount++,e._viewcreate_okcount>=e._viewcreate_allcount&&e._startActivate(n),r&&r.initWidgetView?r.initWidgetView(e):console.error(i+"页面没有定义function initWidgetView(widget)方法，无法初始化widget页面!")}};t._layerIdx,t._layerOpening=!0,t._layerIdx=layer.open(this._getWinOpt(t,n))},_openDivWindow:function(t){var e=this._getUrl(t.url),i=this;this.getHtml(e,function(e){var n={type:1,content:e,success:function(e){t._layerOpening=!1,t._dom=e,i.config.hasOwnProperty("visible")&&!i.config.visible&&(0,a.default)(e).hide(),layer.setTop(e),i.winCreateOK(t,e),++i._viewcreate_okcount>=i._viewcreate_allcount&&i._startActivate(e)}};t._layerOpening=!0,t._layerIdx=layer.open(i._getWinOpt(t,n))})},_getUrl:function(t){return t=this.addCacheVersion(t),t.startsWith("/")||t.startsWith(".")||t.startsWith("http")?t:this.path+t},_getWinOpt:function(t,e){var i=(0,c.getDefWindowOptions)(),n=a.default.extend(i,t.windowOptions);n=a.default.extend(n,this.config.windowOptions),t.windowOptions=n;var r=this,o=this._getWinSize(n),s={title:!n.noTitle&&(this.config.name||" "),area:o.area,offset:o.offset,shade:0,maxmin:!1,zIndex:layer.zIndex,end:function(){t._layerIdx=-1,t._dom=null,r.disableBase()},full:function(t){r.winFull(t)},min:function(t){r.winMin(t)},restore:function(t){r.winRestore(t)}},l=a.default.extend(s,n);return a.default.extend(l,e||{})},_getWinSize:function(t){var e=this.bfb2Number(t.width,document.documentElement.clientWidth,t),i=this.bfb2Number(t.height,document.documentElement.clientHeight,t),r="",a=t.position;if(a)if("string"==typeof a)r=a;else if("object"==(void 0===a?"undefined":n(a))){var o,s;if(a.hasOwnProperty("top")&&null!=a.top&&(o=this.bfb2Number(a.top,document.documentElement.clientHeight,t)),a.hasOwnProperty("bottom")&&null!=a.bottom){t._hasresize=!0;var l=this.bfb2Number(a.bottom,document.documentElement.clientHeight,t);null!=o?i=document.documentElement.clientHeight-o-l:o=document.documentElement.clientHeight-i-l}if(a.hasOwnProperty("left")&&null!=a.left&&(s=this.bfb2Number(a.left,document.documentElement.clientWidth,t)),a.hasOwnProperty("right")&&null!=a.right){t._hasresize=!0;var u=this.bfb2Number(a.right,document.documentElement.clientWidth,t);null!=s?e=document.documentElement.clientWidth-s-u:s=document.documentElement.clientWidth-e-u}null==o&&(o=(document.documentElement.clientHeight-i)/2),null==s&&(s=(document.documentElement.clientWidth-e)/2),r=[o+"px",s+"px"]}t.hasOwnProperty("minHeight")&&i<t.minHeight&&(t._hasresize=!0,i=t.minHeight),t.hasOwnProperty("maxHeight")&&i>t.maxHeight&&(t._hasresize=!0,i=t.maxHeight),t.hasOwnProperty("minHeight")&&e<t.minWidth&&(t._hasresize=!0,e=t.minWidth),t.hasOwnProperty("maxWidth")&&e>t.maxWidth&&(t._hasresize=!0,e=t.maxWidth);var c;return c=e&&i?[e+"px",i+"px"]:e+"px",{area:c,offset:r}},bfb2Number:function(t,e,i){return"string"==typeof t&&-1!=t.indexOf("%")?(i._hasresize=!0,e*Number(t.replace("%",""))/100):t},_appendView:function(t){if(this.isCreate&&t._dom)(0,a.default)(t._dom).show({duration:500}),this._startActivate(t._dom);else{var e=this._getUrl(t.url),i=this;i.getHtml(e,function(e){t._dom=(0,a.default)(e).appendTo(t.parent||"body"),i.winCreateOK(t,e),++i._viewcreate_okcount>=i._viewcreate_allcount&&i._startActivate(e)})}},disableBase:function(){if(this.isActivate){this.beforeDisable();this.changeWidgetView(function(t){return null!=t._layerIdx&&-1!=t._layerIdx?(t._layerOpening,layer.close(t._layerIdx),!0):("append"==t.type&&t._dom&&(0,a.default)(t._dom).hide({duration:1e3}),"custom"==t.type&&t.close&&t.close(),!1)})||(this.disable(),this.isActivate=!1)}},setViewVisible:function(t){this.changeWidgetView(function(e){null!=e._layerIdx&&-1!=e._layerIdx?t?(0,a.default)("#layui-layer"+e._layerIdx).show():(0,a.default)("#layui-layer"+e._layerIdx).hide():"append"==e.type&&e._dom&&(t?(0,a.default)(e._dom).show():(0,a.default)(e._dom).hide())})},setViewCss:function(t){this.changeWidgetView(function(e){null!=e._layerIdx&&-1!=e._layerIdx?(0,a.default)("#layui-layer"+e._layerIdx).css(t):"append"==e.type&&e._dom&&(0,a.default)(e._dom).css(t)})},indexResize:function(){if(this.isActivate){var t=this;this.changeWidgetView(function(e){if(null!=e._layerIdx&&-1!=e._layerIdx&&null!=e.windowOptions&&e.windowOptions._hasresize){var i=t._getWinSize(e.windowOptions),n={width:i.area[0],height:i.area[1],top:i.offset[0],left:i.offset[1]};(0,a.default)(e._dom).attr("myTopLeft",!0),layer.style(e._layerIdx,n),"divwindow"==e.type&&layer.iframeAuto(e._layerIdx)}})}},_startActivate:function(t){this.activate(t),this.config.success&&this.config.success(this),this.isActivate||this.disableBase()},init:function(){},create:function(t){},beforeActivate:function(){},activate:function(t){},beforeDisable:function(){},disable:function(){},winCreateOK:function(t,e){},winFull:function(){},winMin:function(){},winRestore:function(){},getHtml:function(t,e){a.default.ajax({url:t,type:"GET",dataType:"html",timeout:0,success:function(t){e(t)}})}});e.BaseWidget=h}])});